Unobtrusive Sensing Incremental Social Contexts using Fuzzy Class Incremental Learning
Zhenyu Chen1,2,∗ , Yiqiang Chen1 , Xingyu Gao1,∗ , Shuangquan Wang1 , Lisha Hu1 , Chenggang Clarence Yan3 , Nicholas D . Lane4 , Chunyan Miao5
1Beijing Key Laboratory of Mobile Computing and Pervasive Device ,
Institute of Computing Technology , Chinese Academy of Sciences , Beijing , China
2China Electric Power Research Institute , Beijing , China
3Department of Automation , Tsinghua University , Beijing , China 4Bell Labs
5School of Computer Engineering , Nanyang Technological University , Singapore
Abstract—By utilizing captured characteristics of surrounding contexts through widely used Bluetooth sensor , user centric social contexts can be effectively sensed and discovered by dynamic Bluetooth information . At present , state of the art approaches for building classifiers can basically recognize limited classes trained in the learning phase ; however , due to the complex diversity of social contextual behavior , the built classifier seldom deals with newly appeared contexts , which results in degrading the recognition performance greatly . To address this problem , we propose , an OSELM ( online sequential extreme learning machine ) based class incremental learning method for continuous and unobtrusive sensing new classes of social contexts from dynamic Bluetooth data alone . We integrate fuzzy clustering technique and OSELM to discover and recognize social contextual behaviors by real world Bluetooth sensor data . Experimental results show that our method can automatically cope with incremental classes of social contexts that appear unpredictably in the real world . Further , our proposed method have the effective recognition capability for both original known classes and newly appeared unknown classes , respectively .
Keywords—Context aware , Bluetooth , Social Contextual behavior , Online Sequential Extreme Learning Machine ( OSELM ) , Class incremental learning .
I .
INTRODUCTION
With the popularity of mobile phones and context aware computing , recent years have witnessed various mobile applications and services which widely utilize social context information . In the field of ubiquitous computing , some people define a context as what surrounds [ 1 ] . According to previous studies [ 2 ] , [ 3 ] , context may generally be described by four attributes : places ( rooms , buildings , etc. ) , people ( individuals , groups ) , things ( physical objects ) and statuses ( activity , behavior ) . According to the changing circumstances , applications and services can react specifically to the current user centric surrounding context and adjust their behavior adaptively , such as automatically switching to mute mode for user ’s mobile phone when meeting . Regarding these four attributes among context based services , dynamic behavior of surrounding context is the most crucial component in contextaware applications . Consequently , social context ’s dynamic behavior information has attracted attention in location based services , healthcare , gaming and social networks , etc . For example , the definition of meeting context depends on behavior
∗Corresponding authors : E mail : {chenzhenyu , gaoxingyu}@ictaccn of people attendance together , but not on a special place of meeting .
Most existing studies on context aware computing have paid attention to discovering significant locations or recognizing important mobility modes . A couple of machine learning based approaches have been presented for detecting specific places , which aim to find a key locale for the user ’s daily life [ 4 ] , [ 5 ] . Such approaches exploit static radio signals to mainly extract meaningful locations , and these static radio signals generally include GPS coordinates and radio beacon fingerprints from WiFi access points or GSM cell towers . Other previous work based on radio logs focuses on mobility detection using different sensor components , including individual statuses of dwelling , walking or driving [ 6 ] , [ 7 ] . These users’ statuses can also be viewed as a type of context information . However , place detection by static radio signals ( GPS , GSM and WiFi ) can only obtain the location information of the surrounding context . It cannot uncover the real semantic meaning of surrounding contexts . For example , some people are having a meeting in the official conference room , but they can also have this meeting in another non official room . At this time , the useful semantic meaning is people ’s behavior of having a meeting but not the determined place . Furthermore , due to lack of behavior information , the location information just can be used for the current place , while such learned knowledge cannot be applied for other similar contexts and also cannot reuse the knowledge to infer user ’s surrounding context . In addition , by detecting the location ’s change through radio signal strength , static radio signals can detect that the user is moving from one place to another , but even so , we cannot determine social contextual behavior of the user in the new place easily .
Another problem is that even with the same mobility status , there are numerous differences in the surrounding context , for instance , being in private car and public transportation are both in high speed motion states but distinct contexts . In order to solve the abovementioned issues , some researches are based on fingerprints from visual and sound sensors which utilize camera and microphone embedded in mobile phones [ 8 ] , [ 9 ] . Such work has obtained primary results in clustering semantically similar locations and discovering significant events , while their approaches have some limitations to particular and obtrusive ways , such as displacement and orientation of mobile phones . Further , these approaches can only use smartphone embedded sensors to recognize social contextual behavior for the individual user , but cannot recognize the entire surrounding context from dynamic group ’s behavior . Consequently , detecting the behavior status for the individual user is not adequate to recognize the surrounding context . Moreover , newly unpredicted contexts will continuously appear in the daily life , such newly appeared contexts cannot be discovered , in that the trained classifier can generally detect the contexts learned in the training phase , but has no capability to recognize incremental contexts which have not trained and are totally new classes of contexts .
In this paper , we aim to solve the problem of context classification and incremental context inference by exploiting features extracted from Bluetooth data logs . We define “ context ” as the activity that the user is performing with or without other persons , and we focus on recognizing some kinds of representative contexts in people ’s daily life , such as working , meeting , taking subway , going shopping , dining , watching movies . In real world scenarios , even if one ’s context remains unchanged , the number of people joining this context may change frequently . For example , one individual may initiate a group meeting and makes his mobile phone automatically switched to the mute mode . After the meeting is over , one or several persons may remain in the meeting room to continue chatting with him . Under this situation , the mobile phone will be automatically switched to the normal mode . The user ’s context remains unchanged as “ meeting ” . However , there has been some changes in the fine grain , since the people with whom he meets has changed . Accordingly , we define the case where the new classes of contexts have appeared and the people joining the newly incremental contexts continuously named as “ incremental context ” . It could be valuable for realworld applications if one can not only classify the underlying context of an individual but also accurately infer new classes at which some kinds of incremental contexts have gradually appeared . To tackle above challenges , we present a novel sensing scheme for both the context classification problem and the incremental context inference problem by only observing surrounding Bluetooth dynamic information [ 10 ] , [ 11 ] , [ 12 ] .
As shown in Figure 1 , Bluetooth signal levels vary significantly with the current surrounding context . Several researchers have done some preliminary exploration to determine context related information via Bluetooth [ 13 ] , yet they didn’t make full use of Bluetooth information to sense dynamic behavior information from social contexts . Thus , the most natural question is : what kinds of “ dynamic behavior ” of the surrounding context can be inferred from the Bluetooth information in the user centric environment ? Here , we attempt to extract distinct new features from Bluetooth logs and design classification models for recognizing different kinds of contextual behaviors . To the best of our knowledge , this is the cuttingedge work to infer incremental social contexts using dynamic Bluetooth information “ alone ” . The encouraging experimental results show the efficiency and importance of our defined new features , which contribute to incremental context inference .
To summarize , the goal of our work is to directly distinguish a variety of contexts in terms of the dynamic behavior of people , which is obtained through ambient Bluetooth information “ alone ” . Our main contributions of this paper include : ( 1 ) We extract unique new features for dynamic Bluetooth
Fig 1 . Bluetooth logs in different contexts , which show the duration of each unique Bluetooth device inquired by mobile phones . information and build a context classification model of dynamic environment . Several representative contexts can be distinguished by utilizing extracted distinct features in exploiting the quantity and dynamic changes of inquired Bluetooth devices . ( 2 ) We propose fuzzy class incremental learning method to continuously and automatically discover newly incremental classes of contexts through real life Bluetooth data logs , the method keeps the advantages of fast learning speed , good generalization ability and having no requirement of previous training data . Specifically , our proposed method can not only keep the comparable accuracy for recognizing original known classes , but also significantly improve recognition accuracy for newly appeared classes . ( 3 ) We analyze experimental results carefully and compare the differences between batch learning method and our proposed class incremental learning method , which further validates the valuable inference ability using ambient Bluetooth data alone , making it more practical for realworld large scale mobile sensing applications . For example , we can analyze the elderly ’s activity level , social range , and frequency , etc . through inferring newly incremental classes of contexts , with application to elderly oriented healthcare .
II . RELATED WORK
Context aware computing on mobile phones is a wellknown research topic . In this section , we briefly review related work on Bluetooth sensors and other embedded sensors .
A . Bluetooth As Sensors
Bluetooth technology is designed for short range communications . However , researchers have paid attention to the characteristics of Bluetooth for learning users’ interactions and surroundings , which includes recognizing behavior patterns in daily user activities , identifying significant locations , and so on . inferring relationships ,
One of well known researches using Bluetooth to infer surrounding context is Reality Mining project by MIT [ 11 ] .
The project demonstrates the ability to use standard Bluetoothenabled mobile phones to measure context patterns . Their work is quite valuable but the original model can only discriminate “ home ” , “ office ” , and “ elsewhere ” , which is mainly by utilizing the amount of inquired Bluetooth devices . Subsequently , several work follows Reality Mining data , which adopts Bluetooth as proximity sensors , to represent proximate group size that is one element of daily life patterns [ 10 ] . Nevertheless , only the quantity of inquired Bluetooth devices is used , without any other features that may be useful .
Some other work focuses on measuring the interactive relationship of discovered Bluetooth devices . The Wireless Rope [ 12 ] distinguishes between familiar and unfamiliar persons according to the number of meetings . They also draw the observation that high dynamics in the movement of familiars and strangers have great relevance to their activities . The MMM2 project [ 14 ] associates environmental information with images and uses Bluetooth data logs to suggest users with whom to share an image . Identification models can also determine the owner of Bluetooth logs after training , and further group the users by exploring their mutual interactions [ 15 ] . Unlike these studies , we focus on inferring the surrounding context through the dynamic Bluetooth information .
Another similar line of research is followed by BlueSense [ 13 ] and Ryo et al . [ 16 ] . BlueSense detects locations of independent pieces of context by exploiting the change of neighboring Bluetooth devices using clustering or sliding window algorithms , but it didn’t indicate the dynamic information of every piece of context . Besides , their work recognizes clusters based on exactly the same Bluetooth address , which implies the cluster is just a specific place instead of a actual context . Therefore , this method can only be applied in stable places like offices , but is hardly feasible for other dynamic contexts , especially including dynamic behavior information of different surrounding contexts . Ryo et al . [ 16 ] explore the daily detection log of ambient Bluetooth devices , and they present the possibility to recognize a variety of social contexts and changes of surrounding environments through continuously examining the quantity of devices . The authors show the possibilities to determine various contexts and their changes of surrounding environments by analyzing the quantity of devices continuously . However , it hasn’t classified specifically the particular surrounding by employing the categories of typical Bluetooth features .
B . Other Embedded Sensors
Besides Bluetooth , other sensors embedded in mobile devices have been investigated , such as location driven sensor , accelerometer , camera , etc . Below we briefly discuss these techniques that are closely associated with our work .
As location has been paid more attention in contextaware computing than other types of contexts , many learning algorithms have been proposed for discovering meaningful places from raw sensor data . These state of the arts algorithms can be categorized into these two main paradigms : geometrybased and fingerprint based approaches [ 5 ] . Geometry based algorithms identify places as a set of physical coordinates location eswithin certain areas . These techniques collect timation periodically based on GPS coordinates , to detect an individual ’s stay in a certain region and infer significant places [ 17 ] , [ 18 ] . They are found to be fairly effective at discovering outdoor places but suffers from working indoors , and the energy is heavily consumed by continuously estimating positions as well . Fingerprint based algorithms provide more robust and finer grained information for significant places based on WiFi APs . For example , PlaceSense [ 4 ] relies on new beacons to infer place visits by using separate mechanisms to detect entrances and departures . Besides , recognizing everyday activity is also one of hot topics in context aware computing . For example , detecting mobility modes by employing the change of radio signal or base station , such as GSM , WiFi , or GPS [ 19 ] , [ 6 ] , [ 7 ] . Although they can well discriminate meaningful differences in mobility states , the techniques are limited to the motions like walking , running , and stationary [ 20 ] , [ 21 ] . Differently , our work is only based on Bluetooth technology , and we focus on inferring dynamic behavior information directly through the surrounding context instead of respectively detecting the specific place or the mobility mode .
III . METHODOLOGY
We periodically collect surrounding Bluetooth devices by a mobile phone . The Bluetooth devices within about 10 meters configured to answer inquiries would respond automatically , including the unique Bluetooth MAC address , device name , and device type . Given the raw Bluetooth data logs collected by mobile phones , our goal is to identify dynamic behaviors of surrounding social contexts via machine learning algorithms . Next , we use fuzzy clustering method combining with online learning method [ 22 ] , [ 23 ] , [ 24 ] , [ 25 ] , ie online sequential extreme learning machine ( OSELM ) based class incremental learning method [ 26 ] , to continuously infer newly appeared incremental classes of social contexts based on the real life Bluetooth data .
A . Feature Extraction
We define a training timeslot t consisting of w samples as the smallest time unit , where the algorithm determines the behavior of the surrounding context based on this timeslot .
The number of Bluetooth devices inquired in one sample is expressed by N . We extract the following features for a specific timeslot ti :
Quantity of devices : The number of overall unique devices inquired in ti , Nall , indicates the density of existing devices . Generally speaking , the quantity is related to the number of people nearby , or the density of current human crowd of surrounding contexts .
Ratio of static devices : According to collected Bluetooth logs , the Bluetooth devices can be classified as static devices ( laptop , desktop , printer , etc . ) and mobile devices ( mobile phone , headset , etc ) Assuming the number of all unique static devices inquired in ti is Ns , the ratio of static device Rs is Ns/Nall , which is one of the most distinct features to discriminate indoor working state ( office ) and outdoor state . Change rate between adjacent samples : Suppose that the number of new devices appearing in a scan period compared to the previous sample is Nnew , and change rate between adjacent samples C is defined as Nnew/Nall . We calculate the average and deviation of C in the ti as the change rate feature of the timeslot . This feature could indicate ambient dynamic flow of existing devices .
Duration of devices in view : In one timeslot , the number of occurrences of a device is defined as the duration of one device D ( 0≤D≤w ) . If we define the duration threshold as Dmin ( Dmin ≤w ) , a specific device j can be defined as a durative device if Dj ≥ Dmin . We count the ratio of durative devices and the average durative time of all the devices in the timeslot as the devices’ duration feature of the timeslot . We found this feature mainly implies the user ’s condition is relatively static or moving . The duration as well as change rate features jointly reflect the dynamic changes of surrounding contexts .
Here , we add a sidenote that before feature extraction and model training , all timeslots of Nall = 0 where the collected Bluetooth data is empty have been removed .
B . ELM Classifier
Extreme learning machine ( ELM ) is originally proposed for single hidden layer feedforward network ( SLFN ) with the purpose of solving both classification and regression problems [ 27 ] , [ 28 ] . In the optimization problem of ELM , the input parameters ( weights and hidden layer bias ) are randomly assigned and the output weights can be analytically determined . Therefore , its learning speed is extremely fast compared with the traditional SLFN . Besides , ELM can approximate any continuous functions by utilizing a widespread type of feature mappings as long as the dimensionality of the feature mapping is large enough . Therefore , the generalization ability of it is assured for prediction .
C . Fuzzy ISODATA Clustering
Fuzzy Iterative Self organizing Data Analysis Techniques Algorithm ( F ISODATA ) is an extension of Fuzzy C Means ( FCM ) clustering algorithm in fuzzy clustering [ 29 ] , which updates the number of clusters during the clustering process . It first initializes the number of clusters , then merges the similar clusters and splits the dissimilar clusters in iterative way . Thus , we utilize Fuzzy ISODATA technique to automatically learn the most appropriate number of clusters for clustering the samples .
D . OSELM
Regarding the newly incremental data stream increasingly arrives in real world applications , an ELM based incremental learning method called OSELM is proposed as online sequential way , which only stores the parameters of existing model but not the training dataset . The method can incrementally update the model through the newly coming samples [ 30 ] .
E . OSELM based Class Incremental Classifier
We propose an OSELM based class incremental learning method as shown in Figure 2 , which has the automatic discovery and recognition ability of learning incremental classes , and aims to unobtrusive sensing incremental social contexts in the daily life . The learning process of our method mainly has the following stages : 1 ) based on collected and labeled samples , then extract the abovementioned features , an ELM model is built on these extracted features and corresponding labels ; 2 ) as newly coming samples without corresponding labels for the OSELM model , this model structure leverages an unknown output node for fuzzy clustering ; 3 ) this model can be updated to build and form a new model , according to iterative merging and splitting to get the number of new classes ; 4 ) our proposed incremental learning method can consequently recognize both original trained classes and new unknown classes . After the update stage , the generated model is updated with extra output neutrons added in the network structure .
Suppose that we have a given labeled dataset S = {(x(i ) s )|i = 1 , 2,··· , N0} and a new dataset D = s ) , ( y(i ) {(x(i ) d )|i = 1 , 2,··· , N1} . The labels of the samples d ) , ( y(i ) in D can be represented by a multi dimensional vector of dimension m + n , where m is the column number of T0 , and n is the new column number of T1 .
 0
0
T1 =

··· ···
0
0
1
1
··· ···
1
1
( 1 )
N1×(m+n )
If we combine datasets S and D to train the ELM model ,
β1 can be calculated as :
,
( 2 ) where
H1
H0 H0
T0 · M
T1
1 H1 ;
= K0 + H ··· ···

0
0
H1
0
1
0
0
. m×(m+n )
β1 = K−1
1
H0  1
H1 ··· ···
0
K1 =
M =
M is a transform matrix that adds n columns of zeroes on the right part of matrix T0 . Therefore , T0 · M and T1 have the same number of columns .
Therefore , we can derive the solution of β1 as follows :
β1 = β0M + K−1
1 H
1 ( T1 − H1β0M )
( 3 )
Similar to the OSELM algorithm , with the increase of the model incremental samples , after k + 1 times update , parameter can be expressed by :
β(k+1 ) = β(k)M + K−1 where Kk+1 = Kk + H k+1H k+1Hk+1 . k+1(Tk+1 − Hk+1β(k)M )
( 4 )
Accordingly , we can see that β(k+1 ) can be calculated without the labeled dataset S , and obtained through incremental training samples .
Fig 2 . The illustration of our proposed class incremental learning method .
IV . EXPERIMENTS
The experiment is designed not only for evaluating the proposed approach , but also for exploring the value and characteristic of dynamic Bluetooth information in context aware applications . Then , we’ve designed an evaluation metric to analyze the performance of the proposed approach thoroughly and comprehensively .
A . Data Collection
We developed a program to collect Bluetooth data logs running on Android platform . To evaluate our classification , we gathered Bluetooth signals from the entire chosen context , and their Bluetooth contexts are illustrated as Figure 3 , whose trajectory looks like ranging from a to g and going back to a finally . Specifically , working is from several workplaces of our building , walking is walking or strolling outside , taking subway is from subway or bus , dining is from normal restaurants ( not including individual room ) , going shopping is from supermarkets or department stores , watching movies is from cinemas and theaters . We started collecting data after that the current surrounding context is steady , eg after the movies have began for watching movies context . We also paid special attention to some contexts that may appear multiple conditions , eg the taking subway dataset includes peak hour as well as off peak . Our participants have different genders , age and daily lives to collect Bluetooth radio logs for 3 4 weeks as they went about their normal lives [ 31 ] , [ 32 ] , [ 33 ] . One group contains three participants for context classification , including the following chosen contexts : working , walking , taking subway , going shopping , dining and watching movies , and the sampling rate of Bluetooth data collection is 15 seconds . The other group has thirteen participants for incremental context inference , including chosen contexts as follows : working , meeting , taking subway , going shopping and watching movies , and the sampling rate of Bluetooth data collection is 30 seconds . Usually they open the data acquisition program every morning and close it before sleeping , while sometimes they collect chosen contexts with relevant records . Each collector keeps a diary
Fig 3 . The demonstration for Bluetooth data collection .
Fig 4 . Recorded contexts and recognized contexts . record of the main behavior and its time period as specific as possible . They are recommended to describe their daily activity by chosen contexts with priority , but not limited to these . In most cases , we received the data and relevant records next day , then we need to check it immediately to ensure the correctness of records .
1di1L1mInput LayerHidden LayerOutput LayerInput VectorOutput VectorG(a1 , b1 , x)G(ai , bi , x)G(aL , bL , x)biβiβ1βLai?1di1L1mInput VectorG(a1 , b1 , x)G(ai , bi , x)G(aL , bL , x)biβiβ1βLaim+1m+nOutput VectorSplitUnknown ClassIncremental Classes Fig 5 . represent different contexts .
Three types of erroneous contexts classification . Different colors
B . Evaluation Metrics
To measure context classification accuracy , we define the following precision and recall as evaluation metrics .
Precision =
T P ( true positive )
T P ( true positive ) + F P ( f alse positive )
Recall =
T P ( true positive )
T P ( true positive ) + F N ( f alse negative )
( 5 )
( 6 )
For analyzing context classification performance , if simply using right or wrong recognition as evaluation metrics , it may neither present and include comprehensively actual problems appeared in experiments , nor completely reflect the characteristics of dynamic Bluetooth information . Thus , we define a set of erroneous contexts like PlaceSense [ 4 ] . Figure 4 shows that , behaviors recorded in a user ’s diary are called recorded contexts and contexts classified based on Bluetooth logs are called recognized contexts . If the meaning of recognized contexts coincide with recorded contexts , they are classified as Correct . One complete recorded context can only be counted as Correct no more than once . Other cases are further categorized as False , Missed , Divided , Unclassified and NoBlue .
Moreover , as illustrated in Figure 5 , if one context change is detected but identified as error context , it is labeled as false . When the recorded context is changed but isn’t recognized , it will be called as Missed . Likewise , if a single context recorded by the user is recognized as two or more contexts , namely the incorrect change detection , it is labeled as divided . Of the remaining recorded contexts , some ones may not belong to the trained contexts . While if their semantically meaning is very similar to the trained context like afternoon tea and restaurant , they will be transformed into the relevant trained context and evaluated . Otherwise , these contexts are labeled as Unclassified .
Besides , as mentioned above , NoBlue will also be separated . More correct contexts indicate better performance of classification algorithm , while the distribution of erroneous contexts allows us to understand the strength and weakness of Bluetooth data based recognition approach . We further define precision and recall as follows :
P resioncontext =
Correct
Correct + False + Divided
( 7 )
Fig 6 . The classification accuracy with different methods , t = 5 min .
Fig 7 . The recall performance with different timeslots for classification .
Recallcontext =
Correct
Correct + Missed + False
( 8 )
V . RESULT AND DISCUSSION
In this section , we show the experiment result and discuss the related characteristics and performance . We present the details in four parts : ( 1 ) evaluation of the context classification accuracy ; ( 2 ) evaluation of the incremental context inference performance ; ( 3 ) discussion between Bluetooth and accelerometer , WiFi , GPS ; and ( 4 ) summary of Bluetooth value and characteristic .
A . Context Classification Accuracy
Experiment result of context classification is tested by tenfold cross validation . To fully analyze the model we study the sensitivity of some model parameters like the length of the timeslot t . We examine the performance of our classification model , and analyze the detailed results for classifying different social contexts .
NBSVMDT00102030405060708091The classification methodAccuracy The length of timeslot is the most important parameter in training the classifier . It not only impacts the classification accuracy but also the real time performance in the practical application . Figure 7 shows the recall with different timeslots using DT algorithm , which achieves the best performance as shown in Figure 6 . When the timeslot is set as 90 seconds ( w=3 ) , 3 minutes ( w=6 ) , 5 minutes ( w=10 ) and 10 minutes ( w=20 ) meanwhile the Dmin is defined as 2 , 4 , 7 and 15 , the total recall rate is 74.2 % , 84.3 % , 86.5 % and 87.1 % respectively , which can prove that the longer timeslot results in the higher accuracy in general . The experiment also indicates that various dynamic contexts require different time length to obtain satisfactory classification results . Some contexts that are relatively stable ( like watching movies ) can be recognized within a shorter time period . For other contexts that appear to be more dynamic , we need a longer time period to identify them . For example , when the timeslot is extended from 90s to 3min , the accuracy of taking subway ( TS ) , going shopping ( GS ) , dining are all improved significantly . However , after the timeslot achieves a certain length , the classification accuracy would keep steady finally . As shown in Figure 7 , when the is extended from 5min to 10min , most contexts’ timeslot taking subway ( TS ) accuracies can hardly change except which also only has a slight performance improvement .
Table I shows the precision and recall confusion matrices , which could present the discrimination of classification results between different contexts . We can draw several observations from the results as follows .
First of all , working and watching movies ( WM ) have the best classification performance , which indicates that such kind of stable contexts can be more accurate to be recognized and distinguished . In particular , there are many static devices like laptop computers in the office , hence the value of “ ratio of static devices ” can be very high in the context of working . Some office context are misclassified as going shopping ( GS ) or dining because people around users or user himself move back and forth sometimes in the office . For watching movies ( WM ) context , the representative property is that the environment is very quiet which enables the classifier to recognize it easily , thus the recall can reach 100 % . However , other contexts may also appear to be very stable at some time thus possibly are misclassified as watching movies ( WM ) context . In fact , the precision of watching movies ( WM ) can also be 100 % of accuracy if the timeslot is long enough .
Furthermore , the recognition rate of walking is also relatively high , just below those stable contexts like watching movies ( WM ) and working . That is primarily because under this context , the user usually keeps moving and the proximity always changes , thus the surrounding context changes rapidly . Taking Bluetooth features into account , we can observe that the quantity is sparse , the change rate is high and the ratio of duration devices is low . The most likely to be confused with walking outdoors is going shopping ( GS ) , which also reflects the characteristic in the real world : users often wander stopand go when they go shopping in the mall , therefore sometimes their expressed features may be very similar .
Finally , the classification performance of Taking subway ( TS ) context is the worst one among all contexts . A large amount of TS data are misclassified as other contexts , which degrades the overall results greatly , because based on our ex
TABLE I . PRECISION AND RECALL CONFUSION MATRICES . TS DENOTES taking subway , WAL . DENOTES walking , GS DENOTES going shopping , DIN . DENOTES dining , WM DENOTES watching movies , WOR .
DENOTES working , AND t = 5 MIN .
( a ) Precision confusion matrix of predicted contexts
Predicted Context
Din . WM Wor . 16.2
Precision( % ) h t u r T d n u o r G
TS Wal . GS Din . WM Wor .
TS Wal . 3.1 84.1 87.1 9.8 0 0 0
0 7.6 8.3 0 0
GS 11.2 4.0 77.6
0 2.3 4.9
1.2 0 0 6.2 92.6
0
1.3 0 0 4.4 100 0
0 0
79.5
0 4.3
0 0
86.8
0 4.7
0 0 0 0 0 100
0 0 0 0 0 90
( b ) Recall confusion matrix of predicted contexts
Predicted Context
Din . WM Wor . 17.7
Recall( % ) h t u r T d n u o r G
TS Wal . GS Din . WM Wor .
TS Wal . 5.7 63.3 95.7 11 0 0 0
0 5.7 6.3 0 0
GS 12 4.3 83.3 2.5 0 5.3 tracted features , the separability of TS against other contexts is not perfect . As shown in Figure 8 , based on the quantity , change rate and duration , we cannot find a clear hyperplane that differentiates TS and other contexts . When there are not so many passengers in the subway and the number of devices is changing fast , it may be misclassified as GS or walking . When there are many passengers and the number of devices is not changing , it may be misclassified as dining or MW
B . Analysis of Incremental contexts
In the experiments of incremental learning for new classes of social contexts , we divide the entire dataset A into two
Fig 8 . The feature distribution of three contexts . Blue points denote TS , red crosses denote dining and green stars denotes GS
Fig 9 . The threshold change of fuzzy ISODATA clustering approach .
Fig 10 . Comparison for batch mode ELM and our method ( from unknown classes to known classes ) . subsets , ie the training dataset as A1 and the testing dataset as A2 . A1 is used to train the classification model and A2 is employed to evaluate the model performance . Then , A1 is also separated into two parts A11 and A12 , where A11 is set as the initial sample set and belongs to N1 class , and A12 is set as the incremental sample set and contains N1 + N2 classes , where N1 denotes the known classes and N2 denotes the unknown classes .
Firstly , we use Fuzzy ISODATA ( F ISODATA ) clustering algorithm to mine the number of clusters . Figure 9 shows the relation between the division threshold and the final number of clusters . According to F ISODATA , when the fuzzy standard deviation of one cluster is larger than the division threshold , this cluster will be divided into two clusters . As shown in Figure 9 , when the division threshold is ranging from 0.001 to 0.8 , we can see that the number of clusters decrease when the threshold increases . We get the correct cluster number as ground truth when the threshold is 01
Secondly , we define Class 1 , 2 , and 3 as known classes and Class 4 and 5 as unknown classes . Figure 10 demonstrates the comparison results in different phases between batch mode ELM and our method for known classes , which implies our proposed method keeps the comparable accuracy for recognizing original known classes . In the phase of initial classes
Fig 11 . Comparison for batch mode ELM and our method ( from known classes to unknown classes ) . for known three class , we employ labeled samples of known classes to train an initial model by ELM classifier for class incremental learning . In this way , the context inference ability of batch mode ELM and our method keeps the same since they have the same structure , while the accuracy of batch mode ELM and our method are both 55.77 % ( relatively low ) because Class 4 and Class 5 ( unknown classes ) are incorrectly regarded as the known classes . Then , in other two phases of one new class and two new classes , our proposed method achieves the comparable accuracy of context inference in comparison to batch mode ELM . Nevertheless , batch mode ELM cannot cope with newly appeared classes , but requires to re train the new classification model with a significant amount of time and storage cost .
Thirdly , Figure 11 illustrates the comparison results in different phases between batch mode ELM and our method for unknown classes , which indicates our proposed method outperforms batch mode ELM and significantly improve the accuracy for recognizing newly appeared incremental classes . Specially , for two new unknown classes , our proposed method almost keeps the comparable recognition accuracy ( 84.8% ) , while the recognition accuracy of batch mode ELM declines to 61.9 % for one new class and 53.9 % for two new classes , respectively .
C . Comparison with Accelerometer/WiFi/GPS
In order to further reveal the Bluetooth value , the comparison between Bluetooth and other RF signals are listed in Table II . As mentioned above , accelerometer , WiFi and GPS are chosen as they are also widely used .
A couple of existing approaches [ 34 ] , [ 35 ] , [ 36 ] have been presented based on accelerometer , WiFi and GPS to discover specific places or recognize mobility modes . For such previous proposed algorithms , [ 34 ] can detect some important places like working context very well , also [ 35 ] can recognize several kinds of mobility modes such as walking context and reach good recognition accuracy ; however , they lacks the capability to build the mechanism for the discovery and transition of various kinds of dynamic contexts , the surrounding user centric environment cannot be intuitively identified and sensed due to dynamic behavior information . Accordingly , compared with accelerometer/WiFi/GPS , the most critical technique is that
000100101030608123456Division ThresholdNumber of ClassesInitial ClassesOne New ClassTwo New Classes00102030405060708091TestingAccuracyBatch−mode ELMOur methodInitial ClassesOne New ClassTwo New Classes00102030405060708091Testing AccuracyBatch−mode ELMOur method TABLE II . THE COMPARISON FOR THE FINE CONTEXT INFERENCE . FRI/SEP MEANS THE FINE CONTEXTS TRANSITION , WHICH IS THAT THE USER IS GOING SHOPPING WITH FRIENDS TOGETHER , THEN THEY DEPART
SEPARATELY .
Context
Meeting
Walking
Dining
Taking Subway
Going Shopping
Watching Movies
Fine Context
Meeting Talking Alone Group Alone Group Alone Group Alone Fri/sep Alone Group
Acc/WiFi/GPS
√ × √ × √ × √ × √ × √ ×
Bluetooth
√ √ √ √ √ √ √ √ √ √ √ √ then after the formal meeting ,
Bluetooth has the good ability to discover a large number of people around the individual user , which can obtain better performance in recognizing surrounding contexts , especially for different sorts of dynamic contexts such as taking subway , going shopping and so on . On the other hand , seen from Table II , such value in turn could act as an indicator of finecontext transition in context . For example , when the user is stationary and having a meeting with many people in the conference room , this user doesn’t leave and begins to talk with one or several persons for continuous discussion . Thus , the current context has not changed but the user ’s fine context transforms dynamically over time , which can be inferred via Bluetooth while accelerometer/WiFi/GPS cannot . The fine context transition of Fri/sep in Table II can be also correctly detected via Bluetooth . Therefore , Bluetooth based fine grained surroundingcontext awareness can get more accurate effect to enhance LBS ( location based service ) related application . Also , for other fine context inference with group or alone , Bluetooth based surrounding context awareness can detect , if one person acts alone in long term life , we may decide whether this user is inclined to autism , whose personalized data is useful to reality mining [ 11 ] , especially for predictive models of human dynamics .
D . Summary of Bluetooth Value and Characteristic
From the experimental results , we can summarize the value and the characteristic of dynamic Bluetooth information in context aware environment as follows :
Firstly , various context information can be obtained based on distinct new Bluetooth features , including the density and movement of people around as well as the context ’s interactions with surroundings . These information dramatically reflect the surrounding dynamics , which can hardly be provided by other sensors .
Secondly , dynamic Bluetooth information is characterized by fine grained as well as high sensitivity . The coverage range of Bluetooth is very short , meanwhile it can scan all the discoverable devices simultaneously . Therefore , it could sense the subtle changes of surrounding environment within a small area , especially detect the transition between the stable context and the dynamic context .
Thirdly , the weakness of the approach based on Bluetooth is that it ’s susceptible to the impact of objective element . When the quantity of ambient inquired Bluetooth devices is scarce , the recognition accuracy would decline probably or even unavailable . Then , in this case the Bluetooth based approach is not robust enough .
VI . CONCLUSION AND FUTURE WORK
We present a novel Bluetooth feature based context awareness approach in a dynamic environment to detect the users’ contexts , and propose an OSELM based fuzzy class incremental learning method for continuous and unobtrusive discovering new classes of social contexts using dynamic Bluetooth data . We use the fuzzy clustering algorithm to continuously and automatically discover newly incremental classes of contexts through real life Bluetooth logs , and analyze experimental results carefully and compare the differences between batchmode learning method and our proposed fuzzy class incremental learning method , which aims at further revealing valuable inference ability using ambient Bluetooth data alone , and contributes to the field of large scale mobile sensing like the elderly oriented healthcare application . We also compare Bluetooth with accelerometer , WiFi and GPS , to investigate the different effects for their respective utilization . Finally , we highlight the value and the characteristic of dynamic Bluetooth information in context aware computing , especially for dynamic behavior information in surrounding social contexts . The research shows that sensing user centric contexts via surrounding dynamic Bluetooth information is feasible .
Our future research might be focused on two aspects . On one hand , a Bluetooth database of an individual user ’s longterm daily life could be acquired to address familiar Bluetooth device into context aware computing . Familiar Bluetooth mobile devices indicate some kinds of relationship such as colleague , friend or family members , which are useful to social relationship mining for user ’s group members . Such knowledge could make the classification result more accurate , particularly when the number of detected Bluetooth devices are sparse . On the other hand , we propose to study automatic class recognition with crowdsourcing based user self labeling in the cloud , so that we can bring more labels into helping distinguish more and more incremental contexts and achieve better results gradually . Therefore , our ultimate motivation is to provide most abundant and credible context information based on crowdsourcing effort . Furthermore , this work can also serve other human needs and high level applications and researches , such as intelligent LBS , social network , reality mining , human dynamics research and so on .
VII . ACKNOWLEDGEMENTS
This work was supported in part by Natural Science Foundation of China under Grants No.61472399 , No.61173066 and No.61472203 , Beijing Natural Science Foundation under Grant No.4144085 , National High Tech Research and Development 863 Plan of China under Grant No.2014AA051901 , and Science and Technology Program of State Grid Corporation of China under Grant NoDZB17201400108
REFERENCES
[ 1 ] Gellersen , Hans W . , Albercht Schmidt , and Michael Beigl , “ Multisensor context awareness in mobile devices and smart artifacts , ” Mobile Networks and Applications , vol . 7 , no . 5 , pp . 341–351 , 2002 .
[ 2 ] Dey , Anind K . , Gregory D . Abowd , and Daniel Salber , “ A conceptual framework and a toolkit for supporting the rapid prototyping of contextaware applications , ” Human Computer Interaction , vol . 16 , no . 2 , pp . 97–166 , 2001 .
[ 3 ] Baldauf , Matthias , Schahram Dustdar , and Florian Rosenberg , “ A survey on context aware systems , ” International Journal of Ad Hoc and Ubiquitous Computing , vol . 2 , no . 4 , pp . 97–166 , 2007 .
[ 4 ] Kim , Donnie H . , Jeffrey Hightower , Ramesh Govindan , and Deborah Estrin , “ Discovering semantically meaningful places from pervasive RF beacons , ” in Proceedings of the 11th international conference on Ubiquitous computing . ACM , 2009 , pp . 21–30 .
[ 5 ] Kim , Donnie H . , Younghun Kim , Deborah Estrin , and Mani B . Srivastava , “ SensLoc:Sensing Everyday Places and Paths using Less Energy , ” in Proceedings of the 8th ACM Conference on Embedded Networked Sensor Systems . ACM , 2010 , pp . 43–56 .
[ 6 ] Mun , M . , Deborah Estrin , Jeff Burke , and Mark Hansen , “ Parsimonious Mobility Classification using GSM and WiFi Traces , ” in Proceedings of the Fifth Workshop on Embedded Networked Sensors ( HotEmNets ) . ACM , 2008 .
[ 7 ] Sasank Reddy , Min Mun , J.Burke , D . Estrin , etc . , “ Using mobile phones to determine transportation modes , ” ACM Transactions on Sensor Networks , vol . 6 , no . 2 , pp . 13–27 , 2010 .
[ 8 ] Lu , Hong , Wei Pan , Nicholas D . Lane , Tanzeem Choudhury , and Andrew T . Campbell , “ Soundsense : scalable sound sensing for peoplecentric applications on mobile phones , ” in Proceedings of the 7th international conference on Mobile systems , applications , and services . ACM , 2009 , pp . 165–178 .
[ 9 ] Azizyan , Martin , Ionut Constandache , and Romit Roy Choudhury , “ SurroundSense : Mobile Phone Localization via Ambience Fingerprinting , ” in Proceedings of the 15th annual international conference on Mobile computing and networking . ACM , 2009 , pp . 261–272 .
[ 10 ] Farrahi , Katayoun , and Daniel Gatica Perez , “ Learning and predicting multimodal daily life patterns from cell phones , ” in Proceedings of the 2009 international conference on Multimodal interfaces . ACM , 2009 , pp . 277–280 .
[ 11 ] Nathan Eagle , Alex ( Sandy ) Pentland . , “ Reality mining : sensing complex social systems , ” Personal and Ubiquitous Computing , vol . 10 , no . 4 , pp . 255–268 , 2006 .
[ 12 ] Nicolai , Tom , Eiko Yoneki , Nils Behrens , and Holger Kenn , “ Exploring social context with the wireless rope , ” in On the Move to Meaningful Internet Systems 2006 : OTM 2006 Workshops , LNCS 4277 . Springer , 2006 , pp . 874–883 .
[ 13 ] Donnie H . Kim , Dae Ki Cho . , “ BlueSense : Detect individuals , signals , ” location http://urbancensuclaedu/cs219/images/0/0b/BlueSensepdf from bluetooth and regular activities
[ 14 ] Rahul Nair , Marc Davis . , “ Bluetooth pooling to enrich co presence information , ” in Adjunct Proceedings of the 7th International Conference on Ubiquitous Computing . ACM , 2005 .
[ 15 ] Perkio , Jukka , Ville Tuulos , Marion Hermersdorf , Heli Nyholm , Jukka Salminen , and Henry Tirri , “ Utilizing Rich Bluetooth Environments for Identity Prediction and Exploring Social Networks as Techniques for Ubiquitous Computing , ” in IEEE/WIC/ACM International Conference on Web Intelligence , 2006 , pp . 137–144 .
[ 16 ] Nishide , Ryo , and Tatsuya Ushikoshi , “ Extracting Social Contexts from Bluetooth Device Logs , ” in Proceedings of the 11th international conference on Ubiquitous computing Adjunct Publication . ACM , 2009 . [ 17 ] Lin Liao , Dieter Fox , Henry Kautz . , “ Extracting places and activities from gps traces using hierarchical conditional random fields , ” International Journal of Robotics Research , vol . 26 , no . 1 , pp . 119–134 , 2007 . [ 18 ] Toyama , Norio , Takashi Ota , Fumihiro Kato , Youichi Toyota , Takashi Hattori , and Tatsuya Hagino , “ Exploiting Multiple Radii to Learn Significant Locations , ” in Proceedings of Location and Context Awareness . Springer , 2005 , pp . 24–26 .
[ 19 ] Sohn , Timothy , Alex Varshavsky , Anthony LaMarca , Mike Y . Chen , Tanzeem Choudhury , Ian Smith , Sunny Consolvo , Jeffrey Hightower ,
William G . Griswold , and Eyal De Lara , “ Mobility Detection Using Everyday GSM Traces , ” in Proceedings of the 8th international conference on Ubiquitous computing . ACM , 2006 , pp . 212–224 .
[ 20 ] Y . Chen , Z . Zhao , S . Wang , and Z . Chen , “ Extreme learning machinebased device displacement free activity recognition model , ” Soft Computing , vol . 16 , no . 9 , pp . 1617–1625 , 2012 .
[ 21 ] S . Wang , Y . Chen , and Z . Chen , “ Recognizing transportation mode on mobile phone using probability fusion of extreme learning machines , ” International Journal of Uncertainty , Fuzziness and Knowledge Based Systems , vol . 21 , no . supp02 , pp . 13–22 , 2013 .
[ 22 ] Z . Chen , S . Wang , Z . Shen , Y . Chen , and Z . Zhao , “ Online sequential elm based transfer learning for transportation mode recognition , ” in Cybernetics and Intelligent Systems ( CIS ) , IEEE Conference on . IEEE , 2013 , pp . 78–83 .
[ 23 ] L . Hu , Y . Chen , S . Wang , and Z . Chen , “ b COELM : A fast , lightweight and accurate activity recognition model for mini wearable devices , ” Pervasive and Mobile Computing , vol . 15 , pp . 200–214 , 2014 .
[ 24 ] X . Gao , S . C . Hoi , Y . Zhang , J . Wan , and J . Li , “ SOML : sparse online metric learning with application to image retrieval , ” in Proceedings of the Twenty Eighth AAAI Conference on Artificial Intelligence , 2014 , pp . 1206–1212 . J . Wan , P . Wu , S . C . Hoi , P . Zhao , X . Gao , D . Wang , Y . Zhang , and J . Li , “ Online learning to rank for content based image retrieval , ” in Proceedings of the Twenty Fourth International Joint Conference on Artificial Intelligence , IJCAI , 2015 , pp . 2284–2290 .
[ 25 ]
[ 26 ] Zhongtang Zhao , Zhenyu Chen , Yiqiang Chen , Shuangquan Wang , and Hongan Wang , “ A Class Incremental Extreme Learning Machine for Activity Recognition , ” Cognitive Computation , vol . 6 , no . 3 , pp . 423– 431 , 2014 .
[ 27 ] G B Huang , Q Y Zhu , and C K Siew , “ Extreme learning machine : Theory and applications , ” Neurocomputing , vol . 70 , pp . 489–501 , 2006 . [ 28 ] G B Huang , L . Chen , and C K Siew , “ Universal approximation using incremental constructive feedforward networks with random hidden nodes , ” IEEE Transactions on Neural Networks , vol . 17 , no . 4 , pp . 879–892 , 2006 .
[ 29 ] M . B . B . Fergani , MK Kholladi , “ Comparison of fcm and fisodata , ” International Journal of Computer Applications , vol . 56 , no . 8 , pp . 35– 39 , 2012 .
[ 30 ] N Y Liang , G B Huang , P . Saratchandran , and N . Sundararajan , “ A fast and accurate online sequential learning algorithm for feedforward networks , ” Neural Networks , IEEE Transactions on , vol . 17 , no . 6 , pp . 1411 –1423 , nov . 2006 .
[ 31 ] Yiqiang Chen , Zhenyu Chen , Junfa Liu , Derek Hao Hu , and Qiang Yang , “ Surrounding context and episode awareness using dynamic Bluetooth data , ” in Proceedings of the 2012 ACM Conference on Ubiquitous Computing . ACM , 2012 , pp . 629–630 .
[ 32 ] Zhenyu Chen , Yiqiang Chen , Shuangquan Wang , Junfa Liu , Xingyu Gao , and Andrew T . Campbell , “ Inferring social contextual behavior from bluetooth traces , ” in Proceedings of the 2013 ACM conference on Pervasive and ubiquitous computing adjunct publication . ACM , 2013 , pp . 267–270 .
[ 33 ] Zhenyu Chen , Yiqiang Chen , Lisha Hu , Shuangquan Wang , Xinlong Jiang , Xiaojuan Ma , Nicholas D Lane , Andrew T Campbell , “ ContextSense : unobtrusive discovery of incremental social context using dynamic bluetooth data , ” in Proceedings of the 2014 ACM International Joint Conference on Pervasive and Ubiquitous Computing : Adjunct Publication . ACM , 2014 , pp . 23–26 .
[ 34 ] Srinivasan , Raghavendiran , Chao Chen , and Diane Cook , “ Activity Recognition using Actigraph Sensor , ” in Proceedings of the Fourth Int . Workshop on Knowledge Discovery form Sensor Data ( ACM SensorKDD10 ) . ACM , 2010 , pp . 29–34 .
[ 35 ] Zheng , Yu , Quannan Li , Yukun Chen , Xing Xie , and Wei Ying Ma , “ Understanding Mobility Based on GPS Data , ” in Proceedings of the 10th international conference on Ubiquitous computing . ACM , 2008 , pp . 312–321 .
[ 36 ] L . Liao , D . Fox , and H . Kautz . , “ Location Based Activity Recognition using Relational Markov Networks , ” in Proceedings of the Nineteenth International Joint Conference on Artificial Intelligence , IJCAI , 2005 , pp . 773–778 .
