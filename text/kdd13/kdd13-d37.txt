Collaborative Matrix Factorization with Multiple Similarities for Predicting Drug Target Interactions
Xiaodong Zheng† , Hao Ding† , Hiroshi Mamitsuka‡and Shanfeng Zhu†
†Shanghai Key Lab of Intelligent Information Processing and School of Computer Science , ‡Bioinformatics Center , Institute for Chemical Research , Kyoto University , Uji 611 0011 , Japan
Fudan University , Shanghai 200433 , China
ABSTRACT We address the problem of predicting new drug target interactions from three inputs : known interactions , similarities over drugs and those over targets . This setting has been considered by many methods , which however have a common problem of allowing to have only one similarity matrix over drugs and that over targets . The key idea of our approach is to use more than one similarity matrices over drugs as well as those over targets , where weights over the multiple similarity matrices are estimated from data to automatically select similarities , which are effective for improving the performance of predicting drug target interactions . We propose a factor model , named Multiple Similarities Collaborative Matrix Factorization ( MSCMF ) , which projects drugs and targets into a common low rank feature space , which is further consistent with weighted similarity matrices over drugs and those over targets . These two low rank matrices and weights over similarity matrices are estimated by an alternating least squares algorithm . Our approach allows to predict drug target interactions by the two low rank matrices collaboratively and to detect similarities which are important for predicting drug target interactions . This approach is general and applicable to any binary relations with similarities over elements , being found in many applications , such as recommender systems . In fact , MSCMF is an extension of weighted low rank approximation for one class collaborative filtering . We extensively evaluated the performance of MSCMF by using both synthetic and real datasets . Experimental results showed nice properties of MSCMF on selecting similarities useful in improving the predictive performance and the performance advantage of MSCMF over six stateof the art methods for predicting drug target interactions .
Categories and Subject Descriptors G12 [ Numerical Analysis ] : Approximation—least squares approximation ; I26 [ Artificial Intelligence ] : Learning—knowledge acquisition , parameter learning
General Terms Algorithm , Experimentation , Performance
Keywords Chemoinformatics ; Drug target interaction ; Weighted low rank approximation ; Multiple types of similarities over drugs and targets
1 .
INTRODUCTION
Pharmaceutical sciences are an interdisciplinary research field of fundamental sciences , including biology , chemistry and physics , and a successfully developed engineering field , which has created a major industry of our society . The objective of pharmaceutical sciences is drug discovery , which starts with finding effective interactions between drugs and targets , where drugs are chemical compounds and targets are proteins ( amino acid sequences ) . Known drug target interactions are however limited to a small number [ 8 ] , say only less than 7,000 compounds in fact having target protein information in PubChem [ 22 ] , one of the largest chemical compound databases with currently around 35 million entries . Furthermore nowadays drug discovery , ie finding new drug target interactions , needs much more cost and time , because relatively similar drugs ( or targets ) to those in known interactions have been already examined thoroughly . In this light efficient computational methods for predicting potential drug target interactions are useful and longawaited [ 11 ] .
Two major computational approaches are docking simulation and data mining ( or machine learning ) . Docking simulation is biologically well accepted but has two serious problems : 1 ) simulation always needs three dimensional ( 3D ) structures of targets which are often unavailable [ 4 ] and 2 ) simulation is heavily time consuming . On the other hand , machine learning is much more efficient , by which a large number of candidates can be tested within a very short period of time . A straight forward approach in machine learning is to set up a standard classification problem over a table of instances and their features , where instances are drug target pairs , and features are chemical descriptors ( for drugs ) and amino acid subsequences ( for targets ) . Any classification methods , such as support vector machine ( SVM ) , can be applied to this table [ 18 ] . Drug target interactions can be represented by a binary labeled matrix Y of drugs and targets , where an element is 1 if the corresponding drug and target interact ; and 0 if they do not interact . The problem of predicting drug target interactions is to estimate labels of unknown elements from known elements in Y . For this problem , similarities between drugs and those between targets are helpful to predict drug target interactions , assuming that similar drugs tend to share similar targets and vice versa [ 14 ] . A relatively simple idea of using the similarities is the pairwise kernel method ( PKM ) [ 13 ] , which generates similarities ( or kernels ) between drug target pairs from those between drugs and those between targets . PKM has to generate a huge matrix of all possible combinations of drug target pairs , causing a serious drawback in computational efficiency . In
1025 stead , a typical procedure of similarity based approaches is to use drug and target similarities to generate kernels over drugs and those over targets , respectively , from which drug target interactions are estimated by kernel methods , such as SVM [ 2 ] and kernel regression [ 28 , 26 ] . These approaches however have a common shortcoming that the kernel from drugs is generated independently from that from targets , meaning that predictions are done twice separately and the final result is obtained by averaging over the two predictions ( See Section 323 for detail ) . This indicates that drugtarget “ interactions ” are not captured well enough by the current similarity based approaches . Furthermore so far similarity based methods have used only one type of similarity for drugs and that for targets . In fact , chemical structure similarity and genomic sequence similarity are the most major metrics for drugs and targets , respectively . However , both drugs and targets have different types of similarity measures , and considering different types of similarities might enhance the predictive performance of drug target interactions . We thus need to develop a method , which can incorporate multiple types of similarities from drugs and those from targets at once , to predict drug target interactions .
Our proposed approach is to approximate the input drug target interaction matrix Y by two low rank matrices A and B , which share the same feature space , so that A and B should be the space to be generated by the weighted similarity matrices of drugs and those of targets , respectively . In other words , Y is collaboratively approximated by the inner products of the feature vectors of drugs , ie A , and those of targets , ie B , where the weighted drug ( target ) similarity matrices are also approximated by the inner products of drug ( target ) feature vectors themselves . We name this formulation multiple similarities collaborative matrix factorization ( MSCMF ) . We further propose an alternating least squares algorithm to estimate A , B and weights over drug and target similarities , by which MSCMF can select similarities which are the most consistent with the given drug target interactions , resulting in the performance improvement for predicting drug target interactions .
Low rank approximation with respect to the Frobenius norm can be solved easily by singular value decomposition ( SVD ) , if there are no constraints on factorized matrices . In data mining , the lowrank approximation is a starting point of many different disciplines . First , under no regularization terms , several variants of SVD , such as the generalized low rank approximation model ( GLRAM ) [ 30 ] and the probabilistic matrix factorization ( PMF ) model [ 21 ] , are proposed , being applied to information retrieval , particularly recommender systems [ 17 ] . Another series of related work are “ nonnegative ” matrix factorization ( NMF ) [ 6 , 7 ] , in which factorized matrices must keep the elements nonnegative . On the other hand , MSCMF is a weighted low rank approximation ( WLRA ) with regularization terms including a L2 ( Tikhonov ) regularization term over the low rank matrices A and B , and there are no nonnegative constraints on A and B . This means that MSCMF is different from both simple low rank approximation formulation and NMF .
An EM algorithm for estimating the factorized matrices A and B under WLRA is already presented [ 24 ] . WLRA with Tikhonov regularization over A and B is also equivalent to one formalization for recommender systems , called one class collaborative filtering , where an alternating least squares algorithm was presented for estimating A and B [ 20 , 19 , 15 ] . The key difference of MSCMF from one class collaborative filtering is that MSCMF further incorporates regularization terms to consider similarity matrices over drugs and those over targets , particularly multiple similarities of drugs and targets . In fact , similarity matrices over users and those over items are also considered in recommender systems [ 15 , 10 ] . However , first , in [ 15 ] , similarities are rather preprocessed and in corporated into the weight of WLRA , by which the formulation of one class collaborative filtering is still used . Second , in [ 10 ] , similarities are processed in a rather similar way to MSCMF in terms that the formulation contains a graph regularization term for similarity matrices , while the main factorization is weighted NMF , by which factorized matrices must be nonnegative . On the other hand , our formulation is WLRA with Tikhonov regularization and regularization terms over drug and target similarities , resulting in a new , original formulation , and we present an alternating least squares algorithm for estimating parameters in this formulation . In fact , alternating least squares as well as stochastic gradient descent are currently the two major and well accepted approaches for computing matrix factorization .
We empirically evaluated the performance of MSCMF by using both synthetic and real datasets . We first examined MSCMF in terms of the performance improvement in adding similarity matrices and the selectivity of similarity matrices by using various types of synthetic data . We then evaluated the predictive performance of MSCMF under four benchmark datasets , comparing with six stateof the art similarity based drug target interaction prediction methods , in three settings of predicting 1 ) new ( unknown ) interactions ( pair prediction ) , 2 ) new drugs ( drug prediction ) and 3 ) new targets ( target prediction ) . Experimental results showed that MSCMF outperformed all competing methods , in terms of AUPR ( Area Under the Precision Recall curve ) , for all three prediction settings and four datasets . In addition , we checked the performance difference by paired t test , and the performance advantage of MSCMF was statistically significant in all 56 cases except only three cases at the significance level of 0.01 against p values of the paired t test . This result indicates a clear performance advantage over the competing methods . d d ; S2 d by sk
2 . METHOD 2.1 Notation and Problem Setting } be a given set of drugs and T = Let D = {d1 ; d2 ; : : : ; dNd {t1 ; t2 ; : : : ; tNt } be a given set of targets , where Nd and Nt are the } number of drugs and targets , respectively . Let {S1 d ; : : : ; SMd be a set of drug similarity matrices , where each is a Nd×Nd matrix , and Md is the number of drug similarity matrices . We denote the d(di ; dj ) , which is equal to the similarity ( i ; j) element of Sk score between drugs di and dj in the k th drug similarity matrix } be a set of target similarity d . Similarly let {S1 Sk matrices , where each is a Nt × Nt matrix , mt is the number of t is denoted target similarity matrices , and the ( i ; j) element of Sk t ( ti ; tj ) , being equal to the similarity score between targets ti by sk t . Let Y be a Nd × Nt binary matrix of true labels and tj in Sk of drug target interactions , where Y ij = 1 if drug di and target tj interact with each other , and Y ij = 0 if they do not interact . The input of our method is the above two sets of similarity matrices and Y . Let F be a score function matrix , where the ( i ; j) element of F , ie F ij , shows the score that drug di and target tj interact with each other . The problem is to estimate F so that F should be consistent with Y . 2.2 Multiple Similarities Collaborative Matrix t ; : : : ; SMt t ; S2 t
Factorization ( MSCMF )
The main idea of MSCMF is to project drugs and targets into two low rank matrices , corresponding to feature spaces of drugs and targets , respectively .
We thus factorize Y into two low rank feature matrices A and B so that one drug target interaction should be approximated by the
1026 ———————————————————————— Input : true drug target interaction matrix , Y ; drug similarity matrices , {S1 target similarity matrices , {S1 dimensionality of the feature space , K ; weight matrix , W ; weight parameters , l , d , t and ! ; d ; S2 t ; S2
} ; d ; : : : ; SMd } ; t ; : : : ; SMt d t
Output : predicted interaction matrix , F ;
Update each row vector of A using Eq ( 4 ) ; Update each row vector of B using Eq ( 5 ) ; Update weight vector !d using Eq ( 6 ) ; Update weight vector !t using Eq ( 7 ) ; Update F using Eq ( 8 ) ;
1 : Initialize A , B , !d and !t randomly ; 2 : repeat 3 : 4 : 5 : 6 : 7 : 8 : until Convergence ; 9 : Output F ; ———————————————————————— Figure 3 : Pseudocode of Parameter Estimation in Multiple Similarities Collaborative Matrix Factorization trices should be factorized matrices of the drug and target similarities . That is , the similarity between drugs should be approximated by the inner product of the corresponding two drug feature vectors , and this is also the case with the target similarity , as follows :
St ≈ BBT Figure 2 shows a schematic picture of Eqs . ( 3 ) .
Sd ≈ AAT ;
( 3 )
Here we have a set of similarity matrices , instead of only one similarity matrix , for drugs and also for targets . We can then replace one similarity matrix with the one which combines multiple similarity matrices linearly as follows :
Md∑
Mt∑
Sd = k=1
St =
!k t Sk d Sk !k d ; t s:t : |!d| = |!t| = 1 ; k=1 d and !k where !k drugs and targets , respectively , !d = ( !1 ( !1 t are weights over multiple similarity matrices for )T and !t = t ; : : : ; !Mt We thus minimize the squared error between Sd ( St ) and AAT ( BBT ) , resulting in the two regularization terms . Thus the entire objective function ( loss function L ) can be written as follows : d ; : : : ; !Md
)T . d t arg min A;B s:t :
∥W · ( Y − ABT )∥2 +l(∥A∥2 F + ∥B∥2 F )
F
+d∥ Md∑ +t∥ Mt∑ k=1 d − AAT∥
!k d Sk
2
F 2
F t − BBT∥ k=1 t Sk !k +!(∥!t∥2 F + ∥!d∥2 F ) |!t| = |!d| = 1 ;
Figure 1 : Schematic figure of matrix factorization .
Figure 2 : Schematic figure of similarity approximation . inner product between the two feature vectors of the corresponding drug and target as follows :
Y ≈ ABT ;
( 1 ) where A and B are Nd × K and Nt × K feature matrices of drugs and targets , respectively , and K is the dimension of the feature spaces .
Estimating A and B leads us to reconstruct Y , by which unknown interactions can have prediction scores . Figure 1 illustrates the process of Eq ( 1 ) . To estimate A and B in the matrix factorization , a reasonable approach is to minimize the squared error which can be our objective function :
∥Y − ABT∥2 F ; arg min A;B where ∥·∥2
F is the Frobenius norm .
In order to distinguish known drug target pairs from unknown pairs , we consider one formulation , weighted low rank approximation , which introduces a Nd × Nt weight matrix W , in which W ij = 1 if Y ij is a known drug target pair , ie an interacting or non interacting pair ; otherwise W ij = 0 . W is given as an input and used as follows :
∥W · ( Y − ABT )∥2 F ; arg min A;B
( 2 ) where W · Z denotes the element wise product of matrices W and Z .
Then to avoid overfitting of A and B to training data , we apply L2 ( Tikhonov ) regularization to Eq ( 2 ) by adding two terms regarding A and B .
∥W · ( Y − ABT )∥2
F + l(∥A∥2
F + ∥B∥2 F ) ; arg min A;B where l is a regularization coefficient .
Suppose that we have only one similarity matrix for drugs , Sd and that for targets , St . Our idea is that the generated low rank ma where d , t and ! are regularization coefficients . Our regularization terms are all additive , and this manner of using regularization terms is typical ( eg [ 27] ) .
1027 ( a ) True clusters
( b ) Input interaction matrix tively , ( d and ( t are given as follows :
( d(i ; j ) = tr(Si dSj d
T
) ; ( t(i ; j ) = tr(Si tSj t
T
)
Furthermore letting d(k ) and t(k ) be the k th elements of vectors d and t , d and t are given as follows :
( c ) Similarity matrix ( low noise )
( d ) Similarity matrix ( high noise )
Figure 4 : ( a ) True clusters , ( b ) the input interaction matrix , ( c ) a sample similarity matrix with low noise and ( d ) a sample similarity matrix with high noise , all for five balanced clusters
2.3 Alternating Least Squares Algorithm
We select alternating least squares to estimate A , B , !d and !t , which minimize L . Here let ai and bj be the i th and j th row vectors of A and B , respectively . We take the partial derivative of L , ie @L = 0 , @ai as follows : and obtain the updating rule of A by setting @L @ai
Nd∑
Md∑ Nd∑ k=1 p=1
Nt∑ Nt∑ j=1
( j=1
Nd∑ Nd∑ i=1
( i=1 ai = (
W ijY ijbj + d p=1
!k d sk d(di ; dp)bp )
W ijbT j bj + lI K + d aT p ap )
−1 ;
( 4 ) where I K is the K × K identity matrix . Similarly , according to @L Mt∑ Nt∑ @bj
B as follows :
= 0 , we obtain the updating rule of bj = ( t ( tj ; tq)aq )
W ijY ijai + t q=1 k=1
W ijaT i ai + lI K + t
!k t sk
Nt∑ q=1
−1 bT q bq )
( 5 )
Again , updating rules of !d and !t are given as follows :
!d = ( (d + !IMd )
−1
( d
− ( 1T Md ( (d + !I Md ) ( 1T
− 1 ) ( (d + !IMd )−11Md ) −1
−1d
Md
− ( 1T Mt ( (t + !I Mt ) ( 1T
− 1 ) ( (t + !I Mt )−11Mt )
−1t
Mt
( t
!t = ( (t + !IMt )
1Md )
( 6 )
1Mt ) ;
( 7 ) where 1K is the vector , in which all K elements are 1 , letting ( d(i ; j ) and ( t(i ; j ) be the ( i ; j) elements of ( d and ( t , respec d(k ) = tr(BT Sk dB ) ; t(k ) = tr(AT Sk t A )
Fig 3 shows a pseudocode of the alternating least squares algorithm for estimating A , B , !d and !t . In this algorithm , we first initialize A , B , !d and !t randomly and repeat updating A , B , !d and !t , according to Eqs . ( 4 ) , ( 5 ) , ( 6 ) and ( 7 ) , respectively , until convergence . Finally , the matrix of predicted drug target interactions F is given as follows :
F = ABT
( 8 )
F ij is the predicted interaction score of drug di and target tj , and the drug and target in a highly ranked pair in terms of the scores are predicted to interact with each other .
3 . EXPERIMENTS 3.1 Synthetic Clustering Data
311 Experimental Settings Drug target interactions as well as user item collaborations would have latent clusters ( or factors ) from which interactions ( or collaborations ) can be generated . Thus we first embedded true clusters into the interaction matrix and then simulated a real world situation by adding a certain amount of noise to the interaction matrix so that the true clusters should not be easily retrieved from the interaction matrix only . For simplicity , we focused on disjoint clusters ( by which it is easy to generate synthetic similarity matrices ) . Figure 4 shows an example of true clusters and the input interaction matrix generated by using the true clusters with noise , for five balanced clusters . We further generated drug similarity matrices and target similarity matrices by first incorporating the cluster information of drug target interaction matrix ( so clusters are on the diagonal of the similarity matrices ) and then adding a certain amount of noise , so that multiple similarity matrices have a different amount of noise . Figure 4 shows two samples of similarity matrices ( with low and high noise ) , again for five balanced clusters . We then checked how well the true clusters can be estimated from the interaction matrix and how much this performance can be improved by adding similarity matrices to the interaction matrix . Note that we added similarity matrices keeping the diversity in terms of noise in the similarity matrices . At the same time we examined what type of similarity matrices will be selected , where we expect that less noisy matrices will be selected and more noisy matrices will be discarded .
We here show more detailed experimental settings below : All interaction matrices we used have 200 drugs and 150 targets . We first embedded several true clusters in the interaction matrix by which the ( i ; j) element of this matrix is 1 if di and tj are in the same cluster ; otherwise this element value is 0 . We then completed the input interaction matrix by considering two types of noise : 1 ) we simply replaced 80 % of 1 of the interaction matrix with 0 randomly , and 2 ) we randomly flipped 2 % of all 0 to 1 . Then similarity matrices are generated in the following manner : We first generated a true similarity matrix Strue so that the ( i ; j) element of Strue is 1 if di and dj ( or ti and tj ) belong to the same true cluster ( note that this is easy because true clusters are disjoint ) ; otherwise this value is 0 . We then generated a random matrix Srandom , where each element of this matrix randomly takes a value between
1028 ( a ) Interaction matrix only
( b ) 1 similarity matrix added
( a ) Interaction matrix only
( b ) 1 similarity matrix added
( c ) 4 similarity matrices added
( d ) 16 similarity matrices added
( c ) 4 similarity matrices added
( d ) 16 similarity matrices added
Figure 5 : Estimated interactions ( a ) without any similarity matrices , with ( b ) one similarity matrix , ( c ) four similarity matrices and ( d ) 16 similarity matrices , when five true clusters are balanced .
Figure 6 : Estimated interactions ( a ) without any similarity matrices , with ( b ) one similarity matrix , ( c ) four similarity matrices and ( d ) 16 similarity matrices , when five true clusters are unbalanced .
0 and 1 and the diagonal elements are forced to be 1 . We finally generated similarity matrices ( for both drugs and targets ) by Strue − ( noise_level ) × Srandom , where noise_level is a value being changed from 0.15 to 0.9 by the interval of 0.05 , resulting in 16 similarity matrices , all having different noise levels totally .
312 Performance Results We started our experiments for the five balanced clusters shown in Figure 4 , in which each cluster has 40 drugs and 30 targets . Figure 5 shows the estimated drug target interactions ( clusters ) from the input interaction matrix and similarity matrices . From this figure , we can see that clusters ( interactions ) was not clearly predicted if the input was the interaction matrix only , while these clusters were made clearer by adding a larger number of similarity matrices . This indicates that clusters ( interactions ) were more clearly predicted by adding a larger number of similarity matrices , and MSCMF works well for this addition of similarity matrices to the input interaction matrix . We then made the size of clusters unbalanced , keeping the number of clusters at the same , where the sizes of five true clusters were ( 70 , 10 ) , ( 55 , 20 ) , ( 40 , 30 ) , ( 25 , 40 ) , ( 10 , 50 ) for drugs and targets , respectively . Figure 6 shows the estimated drug target interactions ( clusters ) from the input interaction matrix and similarity matrices . This figure also clearly shows the advantage of adding similarity matrices and the efficiency of MSCMF for selecting the similarity matrices useful to improve the performance .
Instead of checking the obtained interaction matrices directly , we then checked normalized mutual information ( NMI ) between the true clusters and the obtained interactions for both the balanced and unbalanced cases ( Note that NMI is a standard measure to check the performance of clustering methods ) . Figure 7 shows the NMI when we changed the number of added similarity matrices . This figure reveals that NMI was clearly bigger by adding similarity matrices for the both cases , while NMI was saturated when around six similarity matrices were added . This would be because low noise similarity matrix was already included when we added around six or so similarity matrices , keeping the diversity of noise level in the
( a ) Balanced case
( b ) Unbalanced case
Figure 7 : NMI for the ( a ) balanced 5 clusters and ( b ) unbalanced 5 clusters . matrices . We thus checked the change of weights over similarity matrices during the iteration of our alternating least squares algorithm . Figure 8 shows the resultant weight change during the iteration , when we used five similarity matrices with different noise levels : 0.15 , 0.3 , 0.5 , 0.7 and 09 From this figure , we can see that the initial weights were 0.2 ( we used an uniform distribution for this case ) , while in both cases , only two similarity matrices had high weights ( around 0.5 ) finally . These selected similarity matrices were with the noise level of 0.15 and 0.3 , indicating that lownoise similarity matrices were selected by MSCMF automatically and high noise similarity matrices were not , implying the efficiency of MSCMF for selecting better similarity matrices .
Finally we changed the number of clusters from 3 to 7 , keeping the cluster unbalancedness . In fact , the sizes of clusters we tested were , for drugs and targets , ( 110 , 20 ) , ( 60 , 50 ) and ( 30 , 80 ) for 3 clusters , ( 80 , 10 ) , ( 60 , 20 ) , ( 40 , 40 ) and ( 20 , 80 ) for 4 clusters , ( 65 , 5 ) , ( 50 , 10 ) , ( 40 , 20 ) , ( 25 , 30 ) , ( 15 , 40 ) and ( 5 , 45 ) for 6 clusters , and ( 70 , 5 ) , ( 50 , 10 ) , ( 30 , 15 ) , ( 20 , 20 ) , ( 15 , 25 ) , ( 10 , 35 ) and ( 5 , 40 ) for 7 clusters . Figures 9 and 10 show the NMI when we changed the number of added similarity matrices and the weights over five similarity matrices ( with the same noise levels as the case of five clusters ) during iterations of our algorithm , respectively . The results of these figures were totally consistent with those obtained no similarity matrix1 similarity matrix4 similarity matrix16 similarity matrixno similarity matrix1 similarity matrix4 similarity matrix16 similarity matrix05101505055060650707508085090951#similarity matrixnmi05101505055060650707508085090951#similarity matrixnmi1029 ( a ) Balanced 5 clusters
( b ) Unbalanced 5 clusters
( a ) 3 clusters
( b ) 4 clusters
Figure 8 : Change of weights over similarity matrices during iteration of our algorithm for the ( a ) balanced 5 clusters and ( b ) unbalanced 5 clusters .
( a ) 3 clusters
( b ) 4 clusters
( c ) 6 clusters
( d ) 7 clusters
Figure 10 : Variation of weights during the algorithm iteration for ( a ) 3 clusters , ( b ) 4 clusters , ( c ) 6 clusters and ( d ) 7 clusters , all being unbalanced clusters .
( c ) 6 clusters
( d ) 7 clusters
Table 1 : Statistics of the used dataset
Nuclear receptor GPCR Ion channel Enzyme
#interactions 90 635 1476 2926
#drugs 54 223 210 445
#targets 26 95 204 664
Figure 9 : Variation of NMI by adding similarity matrices for ( a ) 3 clusters , ( b ) 4 clusters , ( c ) 6 clusters and ( d ) 7 clusters , all being unbalanced clusters . when we used five clusters , and for example , only two similarity matrices were finally selected regardless of the number of clusters in Figure 10 . One additional item of note is that when we used random initial weights , the final weights were almost the same as those of uniform distributions which are shown in Figures 8 and 10 . This indicates that our optimization algorithm is stable against the change of initial values . Overall these results indicate that the efficiency of MSCMF is robust against the cluster size as well as cluster unbalancedness . 3.2 Real Drug Target Interaction Data
321 Drug Target Interaction Data We used four real benchmark datasets , called Nuclear receptor , GPCR , Ion channel and Enzyme , which were originally provided by [ 29]1 . These datasets were collected from four general databases and frequently used in predicting drug target interactions [ 2 , 28 , 26 , 9 ] . Table 1 shows the statistics of these four datasets . 1All datasets are downloadable from http://webkuicrkyotouacjp/supp/yoshi/drugtarget/
Similarity Matrices over Drugs and Targets
322 We used the following two and four types of similarities for drugs and targets , respectively , by considering the effectiveness of predicting drug target interactions [ 12 ] . Drugs : Chemical structure similarity ( CS ) is computed by the number of shared substructures in chemical structures between two drugs . ATC similarity ( ATC ) is computed by using a hierarchical drug classification system , called ATC ( Anatomical Therapeutic Chemical ) [ 23 ] . We used a general method in [ 16 ] to compute the similarity between two nodes ( drugs ) in this classification tree . Targets : Genomic sequence similarity ( GS ) is computed by a normalized Smith Waterman score [ 29 ] between two target sequences . Gene Ontology ( GO ) similarity is the overlap of GO annotations [ 1 ] of two targets for which we simply used GOSemSim [ 31 ] . We considered two options of GO : molecular functions ( MF ) and biological processes ( BP ) . Protein protein interaction ( PPI ) network similarity ( PPI ) is computed from the shortest distance between two targets in a human protein protein interaction ( PPI ) network [ 25 ] . We note that CS and GS are the most standard similarities ( which have been used for predicting drug target interactions ) and so we just downloaded the data of CS and GS along with the drug target interaction data , while we computed the other similarities by using
05101520250010203040506IterationWeights on each input matrix noise level = 0.9noise level = 0.7noise level = 0.5noise level = 0.3noise level = 01505101520250010203040506IterationWeights on each input matrix noise level = 0.9noise level = 0.7noise level = 0.5noise level = 0.3noise level = 01505101505055060650707508085090951#similarity matrixnmi05101505055060650707508085090951#similarity matrixnmi05101505055060650707508085090951#similarity matrixnmi05101505055060650707508085090951#similarity matrixnmi05101520250010203040506IterationWeights on each input matrix noise level = 0.9noise level = 0.7noise level = 0.5noise level = 0.3noise level = 01505101520250010203040506IterationWeights on each input matrix noise level = 0.9noise level = 0.7noise level = 0.5noise level = 0.3noise level = 01505101520250010203040506IterationWeights on each input matrix noise level = 0.9noise level = 0.7noise level = 0.5noise level = 0.3noise level = 01505101520250010203040506IterationWeights on each input matrix noise level = 0.9noise level = 0.7noise level = 0.5noise level = 0.3noise level = 0.151030 ) , as follows : ′ the procedure described above . We further note that these similarities are diverse . For example , GS is derived from static ( sequence ) information , while PPI is more dynamic and noisy , and GO is rather in between these two types of similarities . 323 Competing Methods We here briefly review six state of the art similarity based methods for predicting drug target interactions , all being compared with our method in this experiment .
Pairwise Kernel Method ( PKM ) [ 13 ] generates similarities ( kernels ) over drug target pairs , which can be the input instances of SVM . The similarity between two drug target pairs , say ( d ; t ) and ′ ) , is computed from given drug and target similarities , sd(d ; d ( d and st(t ; t
′ ; t
′
′
′
′ ) ) = sd(d ; d
′
)
; t
)st(t ; t
K((d ; t ) ; ( d
( 9 ) Bipartite local model ( BLM ) [ 2 ] also uses SVM . To predict a score of drug target pair ( d ; t ) , first drug d is fixed , and a SVM is trained by using known interactions of drug d as instances where the kernel over instances is the target similarity matrix . Second target t is fixed , and a SVM is trained by using interactions of target t . In [ 2 ] , the prediction is obtained by the maximum of the results of the two trained SVM , while in our experiments we used the average over them , since this is standard in other methods , such as [ 28 , 26 ] . Net Laplacian regularized least squares ( NetLapRLS ) [ 28 ] minimizes the least squared error between Y and F . Note that F is obtained twice , ie drugs and targets , separately . For drugs , we first compute a Nd × Nd matrix Od , showing how many targets are overlapped between two drugs . We then have matrix V d by a linear combination of Od with Sd : V d = tSd + ( 1− t)Od . F d is then given by F d = V dffd , where ffd is the parameter matrix to be estimated . Note that NetLapRLS uses only one similarity matrix over drugs . The entire formulation is given as follows : d V dLdV dffd)} ;
{∥Y − V dffd∥2+nTr(ffT min ffd where n is a weight and Ld is a normalized graph Laplacian of Sd . This is a convex optimization problem , which gives the following direct solution :
^F d = V d(V d + nLdV d )
−1Y
2
The same operation is done for the target side to have ^F t , and the final result is obtained by the average : ^F =
^F d+ ^F t
.
Regularized Least Squares with Gaussian Interaction Profiles ( RLSGIP ) [ 26 ] is similar to but simpler than NetLapRLS in terms of regularization . For drugs , we can first compute a Nd × Nd matrix Qd , in which the ( i ; j) element is exp(−fl∥Y i − Y j∥2 ) , where fl is a parameter and Y i is the i th row vector of Y . We then have matrix V d by a linear combination with Sd : V d = tSd + ( 1 − t)Qd . A least square classifier with simpler regularization leads to a direct and simpler solution for estimating F :
^F d = V d(V d + gI Nd )
−1Y
Again the final result is obtained by averaging over ^F d and ^F t .
RLS GIP with Kronecker product kernel ( RLS GIP K ) [ 26 ] uses the regularized least square but incorporates the idea of PKM , ie a kernel over drug target pairs , which is , in [ 26 ] , a ( Kronecker ) product kernel from V d and V t , as follows :
′ K((d ; t ) ; ( d
′ ; t
′ ) ) = V d(d ; d
′
)V t(t ; t
)
We then use the regularized least square , being the same as RLSGIP , to estimate the final F as follows :
^F = K(K + hI Nd×Nt )
−1Y ;
) where Y and F are vectors ( with NdNt elements ) , corresponding to Y and F , respectively .
Kernelized Bayesian matrix factorization ( KBMF2K ) [ 9 ] has a similar idea to our method in the sense that drug and target similarities are both projected onto low dimensional spaces with the same dimension so that they can reconstruct true drug target interactions . More concretely , Sd and St are reduced into low dimensional matrices Gd and Gt , respectively , so that Y ≈ GdGT t . The entire scheme is a graphical model that makes Gd and Gt latent variables , which are estimated by a variational estimation algorithm . Graphical models are likely to have unavoidable constraints . So drug and target similarity matrices cannot be weighted in KBMF2K .
324 Experimental Settings We compared the performance of MSCMF with six latest competing methods , BLM , PKM , NetLapRLS , RLS GIP , RLS GIP K and KBMF2K . In addition , as a reference , we checked the performance of two downgraded variations of MSCMF : 1 ) OCCF : MSCMF without any similarities , meaning weighted low rank approximation with Tikhonov regularization only , being equivalent to the formulation of one class collaborative filtering [ 20 ] and 2 ) CMF : MSCMF with only one type of similarity , ie chemical structure similarity for drugs and genomic sequence similarity for targets . The evaluation was done by 5 × 10 fold cross validation ( CV ) . That is , we repeated the following one CV five times : the entire dataset was randomly divided into ten folds , from which we repeated training by nine folds and testing for the rest , ten times , changing the test fold . The results were averaged over the total 50 ( = 5 × 10 ) runs . We considered three different types of prediction by randomly dividing 1 ) all drug target interactions ( pair prediction ) , 2 ) all drugs ( drug prediction ) and 3 ) all targets ( target prediction ) . Note that RLS GIP , RLS GIP K and OCCF cannot be applied to drug and target prediction , by which we compared four methods for drug and target prediction . We evaluated the performance by AUPR ( Area Under the Precision Recall curve ) instead of a more standard measure , AUC ( Area Under the ROC Curve ) , because AUPR punishes highly ranked false positives much more than AUC [ 5 ] , this point being important practically since only highly ranked drug target pairs in prediction will be biologically or chemically tested later in an usual drug discovery process , meaning that highly ranked false positives should be avoided .
−3 ; 2
MSCMF has five parameters , K , l ; d , t and ! . For each pair of training and test datasets in cross validation , we selected parameter values , by using an usual manner of ( 10 fold ) crossvalidation : only a part ( nine folds ) of the training dataset for estimating parameters of MSCMF and the rest ( one fold ) for evaluation . In this parameter value selection , we considered all combinations of the following values : {50 ; 100} for K , {2 −2 ; :: : ; 21} for l , {2 −2 ; : : : ; 25} for d and t , {21 ; 22 ; : : : ; 210} for ! . We implemented PKM and BLM by using LIBSVM [ 3 ] , where the regularization parameter of SVM was set at 1 , according to [ 13 ] and [ 2 ] . To train PKM , the number of negative examples ( interactions ) was set at the same number of positive interactions , due to limitations of the main memory size . We implemented NetLapRLS exactly according to [ 28 ] and set its parameter values as specified in [ 28 ] . RLS GIP and RLS GIP K were run by using the software originally developed in [ 26 ] , where the parameter setting we used was also the same as those in [ 26 ] . Similarly KBMF2K was run by the software in [ 9 ] with the same parameter setting as that in [ 9 ] .
325 Performance Results Table 2 shows resultant AUPR ( with p values of paired t test between each method and the best method in the same column ) which
1031 Table 2 : AUPR values obtained by 5×10 fold cross validation . The highest AUPR value for each column is highlighted in boldface . The p values between the best method and each method are in parentheses . ( a ) Pair prediction
Methods BLM PKM NetLapRLS RLS GIP RLS GIP K KBMF2K OCCF CMF MSCMF
0.204 ( 2:84 × 10 0.514 ( 4:27 × 10 0.563 ( 1:39 × 10 0.599 ( 1:10 × 10 0.604 ( 1:93 × 10 0.508 ( 5:16 × 10 0.387 ( 4:41 × 10 0.643 ( 3:08 × 10
Nuclear receptor −25 ) −12 ) −7 ) −5 ) −5 ) −11 ) −16 ) −2 ) 0.673
0.464 ( 1:23 × 10 0.474 ( 2:19 × 10 0.708 ( 1:17 × 10 0.733 ( 3:07 × 10 0.727 ( 7:91 × 10 0.686 ( 5:23 × 10 0.657 ( 2:47 × 10 0.746 ( 1:31 × 10
GPCR −36 ) −37 ) −17 ) −11 ) −13 ) −18 ) −22 ) −7 ) 0.773
0.592 ( 6:68 × 10 0.663 ( 1:20 × 10 0.900 ( 2:25 × 10 0.904 ( 1:21 × 10 0.898 ( 2:00 × 10 0.876 ( 3:00 × 10 0.883 ( 5:03 × 10 0.937 ( 4:76 × 10
Ion channel −42 ) −42 ) −20 ) −18 ) −20 ) −22 ) −25 ) −1 ) 0.937
0.496 ( 2:07 × 10 0.627 ( 2:86 × 10 0.874 ( 1:46 × 10 0.880 ( 7:43 × 10 0.884 ( 1:20 × 10 0.796 ( 1:34 × 10 0.775 ( 8:96 × 10 0.887 ( 2:51 × 10
Enzyme −54 ) −45 ) −18 ) −15 ) −10 ) −41 ) −42 ) −13 ) 0.894
( b ) Drug prediction
Methods BLM PKM NetLapRLS KBMF2K CMF MSCMF
0.194 ( 1:07 × 10 0.484 ( 2:47 × 10 0.481 ( 1:78 × 10 0.450 ( 1:39 × 10 0.497 ( 2:87 × 10
Nuclear receptor −19 ) −5 ) −5 ) −5 ) −4 ) 0.572
0.210 ( 3:26 × 10 0.323 ( 1:14 × 10 0.397 ( 6:64 × 10 0.357 ( 2:39 × 10 0.398 ( 6:14 × 10
GPCR −32 ) −19 ) −16 ) −17 ) −15 ) 0.474
0.167 ( 1:82 × 10 0.328 ( 3:64 × 10 0.343 ( 2:50 × 10 0.296 ( 6:19 × 10 0.342 ( 8:68 × 10
Ion channel −25 ) −8 ) −13 ) −9 ) −10 ) 0.419
0.092 ( 1:12 × 10 0.254 ( 3:18 × 10 0.298 ( 7:51 × 10 0.253 ( 4:52 × 10 0.326 ( 8:00 × 10
Enzyme −27 ) −17 ) −16 ) −17 ) −12 ) 0.432
( c ) Target prediction Methods BLM PKM NetLapRLS KBMF2K CMF MSCMF
0.325 ( 5:10 × 10 0.413 ( 4:08 × 10 0.433 ( 7:95 × 10 0.404 ( 4:62 × 10 0.431 ( 4:04 × 10
Nuclear receptor −6 ) −2 ) −2 ) −2 ) 0.435 −1 )
0.367 ( 8:85 × 10 0.400 ( 7:02 × 10 0.503 ( 3:92 × 10 0.412 ( 2:00 × 10 0.505 ( 8:04 × 10
GPCR −18 ) −15 ) −9 ) −11 ) 0.556 −8 )
0.641 ( 2:51 × 10 0.659 ( 1:30 × 10 0.762 ( 2:67 × 10 0.725 ( 2:16 × 10 0.785 ( 5:20 × 10
Ion channel −25 ) −21 ) −9 ) −12 ) 0.798 −3 )
0.611 ( 1:03 × 10 0.587 ( 9:33 × 10 0.787 ( 4:90 × 10 0.607 ( 2:90 × 10 0.795 ( 4:21 × 10
Enzyme −23 ) −29 ) −5 ) −27 ) 0.796 −1 )
Table 3 : A typical case of resultant similarity weights under pair prediction . ( a ) Similarities over drugs Similarities Nuclear receptor GPCR Ion channel Enzyme CS 0.5626 0.4374 ATC
0.5804 0.4196
0.6042 0.3958
0.68 0.32
( b ) Similarities over targets Similarities Nuclear receptor GPCR Ion channel Enzyme 0 GS 0.3827 GO ( MF ) 0.3652 GO ( BP ) PPI 0.2521
0.5297 0.1286 0 0.3417
0 0.5262 0.4738 0
0 0.4409 0.5591 0 were all obtained by 5 × 10 fold CV . For pair prediction , MSCMF outperformed all six competing methods , being statistically significant in all cases . This directly indicates the clear performance advantage of our approach over existing state of the art methods for predicting drug target interactions . In addition , MSCMF completely outperformed OCCF for all four datasets , being statistically significant , and achieved higher values than CMF , being statistically significant for two datasets ( GPCR and Enzyme ) . This result implies that adding similarity matrices is generally useful but sometimes insignificant . For drug prediction , again MSCMF outperformed all four competing methods , all being statistically sig nificant in all datasets . In addition , this case , MSCMF clearly outperformed CMF for all four datasets . This result shows that the scheme of MSCMF worked for prediction , and using more than one similarity matrices is useful for drug prediction . For target prediction , MSCMF outperformed all four competing methods , being statistically significant except three cases in the Nuclear Receptor dataset at the significant level of 001 On the other hand , CMF outperformed MSCMF in all four datasets , two cases being statistically significant . Thus we can say that the framework of CMF or MSCMF works for target prediction , while incorporating more similarity matrices might not be necessarily useful for improving the performance in this case .
Finally we checked resultant weights over similarity matrices of drugs and targets . Table 3 shows a typical set of resultant weights under pair prediction . In this table , for drugs , chemical structure similarity ( CS ) always had larger weights than ATC code similarity ( ATC ) for all four datasets , being consistent with the fact that chemical structure similarity is the most well used similarity . On the other hand , for targets , interestingly , the most popular genomic sequence similarity ( GS ) had weights of zero for three datasets ( Nuclear receptor , Ion channel and Enzyme ) , implying that this similarity might not work well for prediction . Instead , two GO based similarities both achieved high values for the three datasets , implying that GO based similarities were very useful and should be used more than genomic sequence similarity . However , genomic sequence similarity achieved the highest weight value for GPCR , which is in reality the most major target in drug discovery ( more
1032 than 50 % of all targets are GPCR ) , which might be the reason why genomic sequence similarity has been used so far .
4 . CONCLUDING REMARKS
We have presented a new formulation based on weighted lowrank approximation for predicting drug target interactions . The key feature of our approach is to use multiple types of similarity matrices for both drugs and targets . In particular we stress that multiple similarity matrices are explicitly incorporated into our optimization formulation as regularization terms , by which our method can select similarity matrices , which are the most useful for predicting drug target interactions , by which the predictive performance can be improved . We have demonstrated the advantage of our proposed method by using both synthetic and real datasets . Synthetic data experiments have revealed the favorable selectivity on similarity matrices , and real data experiments have shown the high predictive performance over the six current state of the art methods for predicting drug target interactions .
5 . ACKNOWLEDGMENTS
This work has been partially supported by MEXT KAKENHI ( 24300054 ) , ICR KU International Short term Exchange Program for Young Researchers , SRF for ROCS , SEM and National Natural Science Foundation of China ( 61170097 ) .
6 . REFERENCES [ 1 ] M . Ashburner et al . Gene ontology : tool for the unification of biology . the gene ontology consortium . Nat . Genet . , 25(1):25–29 , 2000 .
[ 2 ] K . Bleakley and Y . Yamanishi . Supervised prediction of drug target interactions using bipartite local models . Bioinformatics , 25(18):2397–2403 , 2009 .
[ 3 ] C C Chang and C J Lin . LIBSVM : A library for support vector machines . ACM Transactions on Intelligent Systems and Technology , 2:27:1–27:27 , 2011 .
[ 4 ] A . C . Cheng , R . G . Coleman , K . T . Smyth , Q . Cao ,
P . Soulard , D . R . Caffrey , A . C . Salzberg , and E . S . Huang . Structure based maximal affinity model predicts small molecule druggability . Nat . Biotechnol . , 25(1):71–75 , 2007 .
[ 5 ] J . Davis and M . Goadrich . The relationship between
Precision Recall and ROC curves . In ICML , pages 233–240 , 2006 .
[ 6 ] I . S . Dhillon and S . Sra . Generalized nonnegative matrix approximations with bregman divergences . In NIPS , pages 283–290 , 2005 .
[ 7 ] C . H . Q . Ding , T . Li , and M . I . Jordan . Convex and semi nonnegative matrix factorizations . IEEE Trans . Pattern Anal . Mach . Intell . , 32(1):45–55 , Jan . 2010 .
[ 8 ] C . M . Dobson . Chemical space and biology . Nature ,
432:824–828 , 2004 .
[ 9 ] M . Gönen . Predicting drug target interactions from chemical and genomic kernels using Bayesian matrix factorization . Bioinformatics , 28(18):2304–2310 , 2012 .
[ 10 ] Q . Gu , J . Zhou , and C . H . Q . Ding . Collaborative filtering :
Weighted nonnegative matrix factorization incorporating user and item graphs . In SDM , pages 199–210 . SIAM , 2010 .
[ 11 ] A . L . Hopkins . Drug discovery : predicting promiscuity .
Nature , 462:167–168 , 2009 .
[ 12 ] M . Iskar , G . Zeller , X . M . Zhao , V . van Noort , and P . Bork .
Drug discovery in the age of systems biology : the rise of computational approaches for data integration . Curr . Opin . Biotechnol . , 23(4):609–616 , Aug 2012 .
[ 13 ] L . Jacob and J . P . Vert . Protein ligand interaction prediction : an improved chemogenomics approach . Bioinformatics , 24(19):2149–2156 , 2008 .
[ 14 ] T . Klabunde . Chemogenomic approaches to drug discovery : similar receptors bind similar ligands . Br . J . Pharmacol . , 152(1):5–7 , 2007 .
[ 15 ] Y . Li , J . Hu , C . Zhai , and Y . Chen . Improving one class collaborative filtering by incorporating rich user information . In CIKM , pages 959–968 , New York , NY , USA , 2010 . ACM .
[ 16 ] D . Lin . An information theoretic definition of similarity . In
ICML , pages 296–304 , 1998 .
[ 17 ] H . Ma , H . Yang , M . R . Lyu , and I . King . Sorec : social recommendation using probabilistic matrix factorization . In CIKM , pages 931–940 , 2008 .
[ 18 ] N . Nagamine and Y . Sakakibara . Statistical prediction of protein chemical interactions based on chemical structure and mass spectrometry data . Bioinformatics , 23(15):2004–2012 , 2007 .
[ 19 ] R . Pan and M . Scholz . Mind the gaps : weighting the unknown in large scale one class collaborative filtering . In KDD , pages 667–676 , New York , NY , USA , 2009 . ACM . [ 20 ] R . Pan , Y . Zhou , B . Cao , N . N . Liu , R . Lukose , M . Scholz , and Q . Yang . One class collaborative filtering . In ICDM , pages 502–511 , 2008 .
[ 21 ] R . Salakhutdinov and A . Mnih . Probabilistic matrix factorization . In NIPS , 2007 .
[ 22 ] E . W . Sayers et al . Database resources of the National Center for Biotechnology Information . Nucleic Acids Res . , 40(Database issue):D13–D25 , 2012 .
[ 23 ] A . Skrbo , B . Begovic , and S . Skrbo . Classification of drugs using the ATC system ( anatomic , therapeutic , chemical classification ) and the latest changes . Med . Arh . , 58(1 Suppl 2):138–141 , 2004 .
[ 24 ] N . Srebro and T . Jaakkola . Weighted low rank approximations . In ICML , pages 720–727 , 2003 . [ 25 ] C . Stark , B . J . Breitkreutz , T . Reguly , L . Boucher ,
A . Breitkreutz , and M . Tyers . BioGRID : a general repository for interaction datasets . Nucleic Acids Res . , 34(Database issue):D535–D539 , 2006 .
[ 26 ] T . van Laarhoven , S . B . Nabuurs , and E . Marchiori . Gaussian interaction profile kernels for predicting drug target interaction . Bioinformatics , 27(21):3036–3043 , 2011 .
[ 27 ] F . Wang , X . Wang , and T . Li . Semi supervised multi task learning with task regularizations . In ICDM , pages 562–568 , 2009 .
[ 28 ] Z . Xia , L . Y . Wu , X . Zhou , and S . T . Wong . Semi supervised drug protein interaction prediction from heterogeneous biological spaces . BMC Syst . Biol . , 4(Suppl 2):S6 , 2010 .
[ 29 ] Y . Yamanishi , M . Araki , A . Gutteridge , W . Honda , and
M . Kanehisa . Prediction of drug target interaction networks from the integration of chemical and genomic spaces . Bioinformatics , 24(13):i232–i240 , 2008 .
[ 30 ] J . Ye . Generalized low rank approximations of matrices .
Machine Learning , 61(1 3):167–191 , 2005 .
[ 31 ] G . Yu , F . Li , Y . Qin , X . Bo , Y . Wu , and S . Wang .
GOSemSim : an R package for measuring semantic similarity among GO terms and gene products . Bioinformatics , 26(7):976–978 , 2010 .
1033
