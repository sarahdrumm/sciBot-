Learning Geographical Preferences for Point of Interest
Recommendation
∗ Bin Liu , Yanjie Fu , Zijun Yao , Hui Xiong Rutgers Business School , Rutgers University
{binben.liu , yanjie.fu , zijun.yao , hxiong}@rutgers.edu
ABSTRACT The problem of point of interest ( POI ) recommendation is to provide personalized recommendations of places of interests , such as restaurants , for mobile users . Due to its complexity and its connection to location based social networks ( LBSNs ) , the decision process of a user choose a POI is complex and can be influenced by various factors , such as user preferences , geographical influences , and user mobility behaviors . While there are some studies on POI recommendations , it lacks of integrated analysis of the joint effect of multiple factors . To this end , in this paper , we propose a novel geographical probabilistic factor analysis framework which strategically takes various factors into consideration . Specifically , this framework allows to capture the geographical influences on a user ’s check in behavior . Also , the user mobility behaviors can be effectively exploited in the recommendation model . Moreover , the recommendation model can effectively make use of user check in count data as implicity user feedback for modeling user preferences . Finally , experimental results on real world LBSNs data show that the proposed recommendation method outperforms stateof the art latent factor models with a significant margin . Categories and Subject Descriptors H28 [ Database Management ] : Database Applications— Data mining General Terms Algorithms , Experimentation Keywords Location based Social Networks , Point of Interest , Recommender Systems , Human Mobility , User Profiling
1 .
INTRODUCTION
Recent years have witnessed the increased development and popularity of location based social network ( LBSN ) services , such as Foursquare , Gowalla , and Facebook Places . ∗Contact Author .
LBSNs allow users to explore Point of Interest ( POIs ) , such as restaurants and shopping malls , for better services by sharing their check in experiences and opinions on the POIs which they have checked in . Indeed , the task of POI recommendation is to provide personalized recommendations of places of interests to mobile users . It plays an important role in providing better location based services in location based social networks . In fact , both LBSN users and POI owners can benefit from effective POI recommendations . For mobile users , they can identify favorite POIs and have better user experiences by the right POI recommendations . Also , for POI owners , they could exploit POI recommendation for acquiring more target customers .
There are several unique characteristics of LBSNs which distinguish POI recommendations from traditional recommendation tasks .
• Tobler ’s first law of geography . “ Everything is related to everything else , but near things are more related than distant thing ” [ 21 ] . This indicates that geographically proximate POIs are more likely to share similar characteristics . Also , the probability of a user for a POI is inversely proportional to geographic distance . • Regional popularity . Two POIs with similar or the same semantic topics can have different popularities if they are located in different regions .
• Dynamic user mobility . In LBSNs , a user may check in POIs at different regions . For example , a LBSN user may travel to different cities . Dynamic user mobility imposes huge challenges on POI recommendations .
• Implicit user feedback .
In the study of POI recommendations , the explicit user ratings are usually not available . The recommender system has to infer user preferences from implicit user feedback in terms of user check in frequency data .
Indeed , traditional recommender systems usually assume that the user and item data are independent and identically distributed . This assumption ignores the interrelationships among items . In fact , the decision process of a user choose a POI is complex and can be influenced by many factors . First , geographical distance plays an important role . According to the Tobler ’s first law of geography and the law of demand , the propensity of a user for a POI is inversely proportional to the distance between the user and the POI , which is similar to the probability of purchasing an item is inversely proportional to the cost . Second , utility matters . In economics , utility is an index of preferences over some sets of items and services when a user makes purchase decisions . In other words , a user may prefer a far away POI than a nearby one for better satisfaction . Third , popularity affects purchase behaviors . In fact , the probability of a user purchasing a product is largely affected by the wordof mouth about the product . Finally , the LBSN users have dynamic mobility behaviors , which impose the challenges on the modeling of check in decision .
Another unique characteristic of POI recommendations is that user check in count data follow a power law distribution . This is different from the rating data in traditional recommender systems . In other words , a user can visit a POI only once and another POI hundreds of times . Since we do not have explicit user rates for POIs , we can only make use of implicit user behavior data in the check in records for POI recommendations . All the above demands a reconsideration of the recommendation model .
While there are some studies on POI recommendations , it lacks of integrated analysis of the joint effect of the above factors , such as user preferences , geographical influences , and user mobility behaviors . Therefore , in this paper , we propose a geographical probabilistic factor analysis framework which can strategically takes various factors into consideration . This framework allows to capture the geographical influences on a user ’s check in behaviors , effectively model the user mobility patterns , and deal with the skewed distribution of check in count data . Specifically , a Gaussian distribution is used to represent a POI over a sampled region . This can reflect the first law of geography ; that is , similar POIs are more related than distant POIs . Also , we use a multinomial distribution over latent regions to model user mobility behaviors over different activity regions . These latent regions reflect the activity areas for all the users through a collective influence . Moreover , a latent model is developed to capture user preferences . This model takes geographical influence , regional popularity and user mobility into consideration , and can effectively handle the skewed data distribution of POI count data .
Finally , experimental results on real world LBSNs and
POI data show that the proposed POI recommendation method outperforms state of the art probabilistic latent factor models with a significant margin in terms of Top N recommendation . Also , we provide a location marketing segmentation study by comparing the latent regions identified by our model with those derived from traditional marketing segmentation methods .
2 . THE FRAMEWORK FOR POI RECOM
MENDATION
In this section , we introduce a geographical probabilistic factor analysis framework for POI recommendations .
2.1 Problem Definition
The problem of personalized POI recommendation is to recommend POIs to a user . Let U = {u1 , u2 , , uM } be a set of LBSN users , where each user has a location li and observable properties xi ( eg a user ’s profile ) . The user location li is usually unknown due to user mobility . Let V = {v1 , v2 , , vN } be a set of POIs , where each POI has a location lj = {lonj , latj} in terms of longitude and latitude , observable properties xj ( eg a textual description of a POI ) , and a popularity score ρj . Typically , a tiny proportion of check in records of users for POIs are given with yij as the number of times user ui visited POI vj . For convenience , we refer i as user and j as POI unless stated oth
Figure 1 : A graphical representation of the proposed model . The model priors have been excluded for the simplicity of description .
Table 1 : Mathematical Notations
Symbol Size
Description
1 × R latent region set , r is a region in R M × R user level region distribution 1 × N item popularity R2 R2×2
R ηηη ρρρ µµµ ΣΣΣ UUU M × K user latent factor N × K item latent factor VVV ( · ) × K user or item observable properties xxx ( · ) × K user or item topic distribution θθθ , πππ mean location of a latent region covariance matrix of a latent region erwise . Also , we use POI and item interchangeably . Some important notations used in this paper are listed in Table 1 . 2.2 The General Idea
To learn geographical user preferences , we need a model to encode the spatial influence and user mobility into the user check in decision process . By Tobler ’s first law of geography , POIs with similar services are likely to be clustered into the same geographical area . To capture this , we assume that the geographical locations have been clustered into R latent regions and denoted as R . Also , as shown in Figure 2 , LBSN users are most likely to check in a number of POIs and these POIs are usually limited to some geographical regions . We apply a multinomial distribution , r ∼ p(r|ηi ) , to model user mobility over the regions R with ηi being a user dependent distribution over latent regions for user i . Then we assume a Gaussian geographical distribution for each region r ∈ R , and the location for POI j is characterized by lj ∼ N ( µr , Σr ) with µr and Σr being the mean vector and covariance matrix of the region .
To model a user ’s propensity of a POI , we assume the following factors that will affect the user check in decision process : ( 1 ) each user i is associated with an interest α(i , j ) with respect to POI j ; ( 2 ) each POI j has popularity ρj ; and ( 3 ) the distance between the user and the POI d(i , j ) . As a result , the probability of observing a pair ( i , j ) is directly proportional to the user interest and the popularity of the entity , and monotonically decreases with the distance between them . p(i , j ) ∝ α(i , j)ρ(j)(d0 + d(i , j))−τ
( 1 ) We use a power law like parametric term ( d0 + d(i , j))−τ to model the distance factor in the decision making process .
( a ) All POIs in different regions .
( b ) A user ’s check ins in different regions .
( c ) User check ins in San Francisco .
Figure 2 : An example of a typical user check in pattern : ( a ) all the POIs ; ( b ) the user ’s check ins over different regions : San Francisco , Los Angeles , San Diego , Las Vegas , Houston , and New York City ; ( c ) the user ’s check ins in San Francisco area .
This motivated by the following observations : the probability user ui checking in at POI vj decays as the power law of the distance between them .
Because we use implicit user check in count data to model user preferences and the distribution of check in counts are usually skewed , we adapt a Bayesian probabilistic non negative latent factor model : yij ∼ P ( fij ) where fij = α(i , j ) · ρ(j ) · ( d0 + d(i , j))−τ for encoding both the spatial influence and personalized preferences . 2.3 Geographical Probabilistic Factor Model The check in decision process of user i for POI j can be viewed in a generative way . First , a user samples a region from all R regions following a multinomial distribution r ∼ Multinomial(ηi ) , and a POI is draw from the sampled region lj ∼ N ( µr , Σr ) . Then , depending on user preferences , the popularity of the selected POI in that sampled region , and the distance between the user and the POI , the user makes a check in decision following certain distribution . The user i ’s preference for POI j can be represented as a linear combination of a latent factor uuu⊤ i vvvj and a function of user and item observable properties x⊤ i W xj . As shown in Figure 1 , the geographical probabilistic generative process for a user i to choose a POI j can be expressed as follows :
1 . Draw a region r ∼ Multinomial(ηi ) .
2 . Draw a location lj ∼ N ( µr , Σr ) .
3 . Draw a user preference a Generate user latent factor uuui ∼ P ( uuui ; Ψuuui ) . b Generate item latent factor vvvj ∼ P ( vvvj ; Ψvvvj ) . c User item preference α(i , j ) = uuu⊤ i vvvj + x⊤ i W xj .
4 . yij ∼ P ( fij ) where fij = uuu⊤ i vvvj + x⊤ i W xj · ρ(j ) · ( d0 + d(i , j))−τ
In the generative model , uuu and vvv are user and item factors , xi and xj are user and item observable properties respectively , and W is a matrix that is used to transfer the observable prosperity space into the latent space to capture the affinity between the observed features and the user item pair . Note that the proposed model is general and can be extended by different factor models . The model details will be described in Section 24 2.4 Model Specification
This section introduces detailed model specifications .
241 A User Mobility Model
A user may check in POIs in different geographical areas as shown in Figure 2 . Indeed , a LBSN user may travel to different regions ( Figure 2b ) , and the recommendation problem becomes difficult when this user travels to a new place . Also , it is important to capture users’ mobility behaviors and find users’ preferences . As shown in Figure 2 , LBSN users are most likely to check in a number of POIs and these POIs are usually limited to some geographical regions . To model a user ’s propensity of a POI , we first need to choose the region where the POI is associated . We apply a multinomial model [ 10 ] to model the region r ∼ p(r|ηi ) , where ηi is a user dependent distribution over latent regions for user i . Each POI location lj is drawn from a region dependent multivariate normal distribution : lj ∼ N ( µr , Σr ) .
Also , due to the mobility pattern , the explicit location ℓ(· ) of a user is unknown . We use the region r to represent the user activity area and model the user POI distance as d(i , j ) = ||µr − lj||2 .
( 2 )
242 Popularity
Popularity can affect the user check in behaviors to a great extent . Usually , an individual ’s decision to check in a POI is largely affected by the word of mouth opinions , which can be represented as the popularity of the POI . We propose to normalize the popularity score in a region level . On the one hand , two POIs with similar or the same semantic terms can be rated differently in a region . On the other hand , as a user choose a POI from a pool of choices in a region , the popularity score represents the user satisfaction level . A POI with a higher popularity score potentially provide better user experiences according to word of mouth opinions .
For example , in Foursuare , we know the total number of people have visited a specific POI j , totalPeoj , and total times they check in there , totalCkj ( refer the example in Table 2 ) . We normalize the popularity score for a POI j in area r to ( 0 , 1 ] by the following equation [ 15 ] .
ρj =
1
2 fl totalPeoj − 1 maxj∈r{totalPeoj} − 1
+ totalCkj − 1 maxj∈r{totalCkj} − 1
( 3 ) where maxj∈r{totalPeoj} and maxj∈r{totalCkj} are the maximum total number of people and total check in number in the region respectively .
243 Geographical Topical Bayesian Non negative
Matrix Factorization
Latent factor models aim on learning latent factors to model user item interactions by associating user latent factor φi for each user and item latent factors φj for each item .
Then , the rating is modeled as p(yij|i , j ) = p,yij|φ⊤
Latent factor models , such as probabilistic matrix factorization ( PMF ) [ 18 ] , have become popular in recommendation . One drawback of latent factor models is the so called cold start problem , in which latent factor models perform poorly when there are many unseen users or items . Another i φj ; Θ . drawback of previous work on using latent factors for recommendation is that they assume a normal distribution for p,yij|φ⊤ i φj ; Θ and apply a logistic function to bound the predicted values . Therefore , it is not suitable for recommendation problems where the user item data have skewed frequency values . For POI recommendation , the user check in frequency data actually follows the power law distribution . To circumvent these two drawbacks of latent factor models for POI recommendations , we propose a GeographicalTopical Bayesian Non negative Matrix Factorization ( GTBNMF ) model by incorporating the geographical influence and textual information in terms of topic distribution .
An Aggregated LDA Model .
To better explore the observable features , we first profile users and POIs through an aggregated LDA model proposed in our earlier work [ 15 ] . The Latent Dirichlet Allocation ( LDA ) model [ 4 ] is a popular technique to identify latent topic from a large document collection . In aggregated LDA , we aggregate all the documents of the POIs , user ui have checked in , into a user document dui . The topics of dui can represent user ui ’s preferences in terms of interest topics . Each document corresponds to a LBSN user . As a result , the topic distribution of document dui represents the interests of ui . Each user u is associated with a multinomial distribution over topics , represented by θ . Each interest topic is associated with a multinomial distribution over check in textual terms , represented by φ . The generation process of the region aware user interest topic is as follows .
1 . For each topic z ∈ {1 , , K} , draw a multinomial dis tribution over terms , φz ∼ Dir(β ) .
2 . For the document dui given a user ui
( a ) Draw a topic distribution , θdui ( b ) For each word wd,n in document dui : ) i . Draw a topic zd,n ∼ M ult(θdui ii . Draw a word wd,n ∼ M ult(φzd,n )
∼ Dir(α )
Then , we have : ( 1 ) Matrix ΘM ×K , where M is the number of users and K is the number of topics . θij represents the probability that user i is interested in topic tj . ( 2 ) Matrix ΦK×V where K is the number of topics and V is the number of unique terms in the dataset . Vector φi· is the probability distribution of topic i over the V terms . We further infer the topic distribution πj of POI vj based on the learned user topic term distribution ΦK×V . In our newly proposed geographical probaComments : bilistic factor model as described in Section 2.3 , we assume both user and item observable properties xi and xj . Here , we apply an aggregated LDA model to mine the topic distribution , and replace xi and xj with topic distributions φi and πj . The aggregated LDA here does not improve the computation complexity of the proposed model .
GT BNMF .
The implicit feedback user item count matrix Y can be factorized as Y ∼ P ( UUUVVV ) , and priors P ( uuui ; Ψuuui ) and P ( vvvj ; Ψvvvj ) can be further specified . Consider the count data characteristic , we expect user factor UUU and item factor VVV to be nonnegative . Some previous work such as [ 17 , 5 ] assumed a Poisson distribution for Y ∼ P ( UUUVVV ) and further placed Gamma priors on UUU and VVV . Actually , the Poisson factor analysis can be equal to NMF in certain condition [ 14 ] . Euclidean distance based optimization leads to Gaussian NMF , and KL divergence based optimization leads to Poisson NMF . For computation efficiency purpose , we here adopt a Bayesian non negative matrix factorization ( BNMF ) method [ 19 ] ; but our framework is flexible , thus it is also suitable for Poisson factor model among others .
More specifically , we assume a rectified normal1 distribu tion on Y ∼ P ( UUUVVV ) with variance σ2I .
Y ∼ N R(Y |UUUVVV , σ2I ) , subject to UUU ≥ 0 , VVV ≥ 0
( 4 ) with non negative constrains . Further , we place an exponential distribution , which is a special case of Gamma distribution with shape equals to 1 , on UUU and VVV , and an inverse gamma distribution on σ2 with shape a and scale b .
M
K
P ( UUU |α ) =
P ( VVV |β ) =
P ( σ2 ) = ba Γ(a )
α · exp(−α · uik ) ,
Yi=1 Yj=1
N
K
Yk=1 Yk=1 ( σ2)−a−1 exp(− b σ2 )
β · exp(−β · vjk )
( 5 )
Each element uik ∈ UUU encodes the preference of user i to “ topic ” k , and each element vik ∈ VVV reflects the topical affinity of item j to topic k .
Also , we utilize the user topic distribution θi and item topic distribution πj to ease the cold start drawback of latent factor models . We add another term depends on θi and πj . Then we have the following generative process .
1 . Generate user latent factor uik ∼ Exp(αk ) . 2 . Generate item latent factor vjk ∼ Exp(βk ) . 3 . User item preference α(i , j ) = uuu⊤ i vvvj + θ⊤ i W πj .
By combining the geographical influence and latent factor , we have GT BNMF as yij ∼ N R(yij|fij , σ2 ) fij = uuu⊤ i vvvj + θ⊤ i W πj · ρ(j ) · ( d0 + d(i , j))−τ
( 6 )
Here , W is a matrix that used to transfer the topic space into the latent space to capture the affinity between the observed features and the user item pair .
2.5 Parameter Estimation
Let us denote all parameters by Ψ = ( UUU , VVV , σ2 , W , ηηη , µµµ , ΣΣΣ ) , and Ω = {α , β , a , b} be the hyperparamters . Given the observed data collection D = {yij , lj}Iij where yij is the user check in count and lj is the location of vj ; and Iij is the indicator function with Iij = 1 when user ui visited POI vj , and Iij = 0 otherwise . The posterior probability is
P ( Ψ , α , β ; D ) = YD
P ( yij , lj|Ψ , Ω )
( 7 )
To estimate the parameters Ψ , we use a mixing Expectation Maximization ( EM ) and sampling algorithm to learn all the parameters . We treat latent region r as a latent variable and introduce the hidden variable P ( r|lj , Ψ ) , which is the probability of lj ∈ r given POI location lj and Ψ . The algorithm iteratively updates the parameters by mutually enhancement between Geo clustering and GT BNMF . The Geo clustering updates the latent regions base on both location and check in behaviors ; and GT BNMF learns the graphical preference factors .
1 http://enwikipediaorg/wiki/Rectified_Gaussian_distribution
251 E step
In the E step , we iteratively draw latent region assignments for all POIs . For each POI , a latent region r is firstly drawn from the following distribution . r ∼ P r| {y·j , lj} , R(t ) , Ψ(t ) × P ( r|ηηη(t ) )
( 8 ) where
P {y·j , lj} |r , Ψ(t ) = P lj|r , Ψ(t ) × P y·j|r , Ψ(t ) ( 9 ) r r , Σ(t )
P lj|r , Ψ(t ) = N lj|µ(t ) P y·j|r , Ψ(t ) =
Yi=1
M
N R(fij , σ2 )
( 10 )
( 11 )
P ( r|ηηη(t ) ) updates region assignment in terms of user mobility , P ( lj|r , Ψ(t ) ) is the location pdf function for multivariate normal distribution with mean vector and variance matrix obtained in last iteration , and P ( y·j|r , Ψ(t ) ) updates region assignment through collaborative user effects .
252 M step
In the M step , we maximize the log likelihood of the model with respect to model parameters by fixing all regions obtained in the E step . Since we sample the regions in the E step , we can update µµµr , ΣΣΣr , ηηη directly from the samples .
µµµr =
1
#(j , r )
D
Xj=1
ΣΣΣr =
1
#(j , r ) − 1
I(rj = r)lj
D
Xj=1(lj − µr)⊤(lj − µr ) where #(j , r ) is the number of POIs assigned to region r . Through imposing a conjugate Dirichlet prior Dir(γγγ ) , we update ηηη(t+1 ) by ηηη(t+1 ) where Cir is the number
= C
+γ ir
( t+1 ) ir ( t+1 ) i·
C
+Rγ of POIs being assigned to region r for user i , and Ci· is all the the number of POIs of all the regions for user i .
After updating region R(t+1 ) , we update Ψ(t+1 ) that max imizes the expectation Q(Ψ|Ψ(t) ) . L(UUU , VVV , σ2 , W |R(t+1 ) , D )
Since the elements in each column of UUU and VVV are conditionally independent , we can update entire column of UUU and VVV simultaneously . When M × N × K ≫ ( M + N ) × K , it can save a lot of computation . A gradient based method is applied to update W : W ( t+1 ) = W ( t ) − ǫ × ∂L ∂W where ǫ is the learning rate . Comments : Note that the region R is updated in each Estep , so as the popularity and user POI distance . The model parameters are updated upon the new region information .
2.6 Recommendation
After parameters Ψ are learned , the GT BNMF model predicts the number of check ins of a user for a given POI i vvvj + θ⊤ as E(yij|ui , vj ) = ,uuu⊤ i W πj · ρ(j ) · ( d0 + d(i , j))−τ .
We make recommendations based on the predicted check in times , the larger the predicted value , the more likely the user will choose this POI . Since POI recommendation in LBSNs is highly location sensitive , the recommendation list should be within a user ’s activity region . Our GT BNMF model learn the latent region . Therefore , we make recommendations based on the learned latent region .
3 . EXPERIMENTAL RESULTS
Here , we provide an empirical evaluation of the performances of the proposed model . All the experiments were performed on a large real world LBSN dataset collected from Foursquare ( wwwfoursquarecom ) , one of the most popular LBSN communities .
The dataset is formulated as follows [ 15 , 7 ] . Foursquare users usually report their check ins of POIs via Twitter . When a LBSN user posted a Tweet , which shows a check in of a POI , we consider it as the user has checked in the POI physically . As shown in Table 2 , for POIs in Foursquare , we have geographical description information such as location information , textual information , and popularity information in terms of the total number of people and the total number of check ins . The dateset includes POIs across the Unites States ( except Hawaii and Alaska ) , and the geographical distribution of all POIs is shown in Figure 2a .
( 12 )
3.1 The Experimental Data
=
M
N
Xi=1
Xj=1
1
2 ln σ2 −
( yij − [ ρjδj · UUUVVV ij + ρjδj · θ⊤ i W πj])2
2σ2
Name:Otto Enoteca Pizzeria Address:1 5th Ave , New York , NY 10003 Tags:pizza wine bar italian olive oil cheese mario batali meat wine pasta
−
M
K
Xi=1
Xk=1
α · Uik −
N
K
Xj=1
Xk=1
β · Ujk −(a + 1 ) ln σ2 + b
σ2
( 13 ) Here δj is the distance factor of user i for POI j as described in Section 241
We apply an iterated conditional modes ( ICM ) [ 19 ] to update UUU , VVV , σ2
 
 yij − X k′6=k
X j=1
  yij − X  k′ 6=k
X i=1 uik′ vjk′ − ρj δj · θ⊤ i W πj
Pj=1(ρj δj · vjk)2 uik′ vjk′ − ρj δj · θ⊤ i W πj
  ρj δj · vjk
  − α · σ2
  ρj δj · uik
  − β · σ2
Pi=1(ρj δj · uik)2
1
2 PM i=1 PN j=1(yij − [ ρj δj · UUUVVV ij + ρj δj · θ⊤ i W πj ])2 + b
M N
2 + a + 1
( 14 ) uik = vjk =
σ2 = gelato gluten free menu zagat rated pizza
Total people : 3,127 , Total check ins : 4,770 .
Table 2 : An example POI and its associated information .
According to the Twitter reports from Foursuqre users , we finalized a dataset of 12 , 422 users for 46 , 194 POIs with 738 , 445 check in observations . The user POI check in count matrix has a sparsity of 99.87 % ; it is very sparse . Each user checked in 59.44 POIs on average , only a very small fraction of all the POIs . The number of check ins for a POI is ranged from 1 to 786 . This range is very wide as show in Figure 3 .
3.2 Evaluation Metrics
Since there is no explicit rating for validation , we evaluate the models in terms of ranking . We present each user with N POIs sorted by the predicted values and evaluate based on which of these POIs were actually visited by the user . Precision and Recall . Given a top N recommendation list SN,rec sorted in descending order of the prediction values in s e m i t i n − k c e h C
120
100
80
60
40
20
0
0
PoI Check−in times
SVD PMF NMF BNMF F BNMF GT BNMF K Pre 0.0041 0.0034 0.0125 0.0181 @1 0.0066 0.0062 0.0169 0.0197 @5 @10 0.0081 0.0080 0.0202 0.0224 0.0052 0.0029 0.0126 0.0147 @1 @5 0.0067 0.0059 0.0163 0.0160 @10 0.0088 0.0079 0.0202 0.0197
0.0192 0.0208 0.0237 0.0166 0.0177 0.0210
0.0278
0.0288
0.0347
0.0306
0.0326
0.0304
10
20
10
20
30
40
50
60
Point−of−Interest
Table 3 : Precision @N with different latent dimensions K .
Figure 3 : An example of wide range user check in count data for a randomly chosen user .
N
|Svisited|
, Recall@N = |SN,rec T Svisited| a region , precision and recall are defined as Precision@N = |SN,rec T Svisited| where Svisited are the POIs a user have visited in the test data . The precision and recall for the entire recommender system are computed by averaging all the precision and recall for all the users respectively . r Recall and r Precision . In addition to using absolute precision and recall for evaluation , we also compare the models in terms of relative precision and recall . Let C denote the candidate POIs , the precision and recall in a top N list of a random recommender system are |Svisited| and N |C| . Then , the relative precision and recall [ 24 ] are defined as
|C| rPrecision@N = rRecall@N =
Precision@N |Svisited|/|C| Recall@N
N/|C|
=
=
|SN,rec T Svisited| · |C|
|Svisited| · N
|SN,rec T Svisited| · |C|
|Svisited| · N
( 15 )
The relative precision and recall have the same value . As a result , we only need to show one of them , and we will name it as the relative performance , which measures the improvement over a random recommendation .
3.3 Baseline Algorithms
We first compare our proposed GT BNMF model with four traditional recommendation methods : singular value decomposition ( SVD ) [ 12 ] , probabilistic matrix factorization ( PMF ) [ 18 ] , Nonnegative matrix factorization ( NMF ) [ 14 ] , and Bayesian nonnegative matrix factorization ( BNMF ) [ 19 ] . SVD and PMF are the standard algorithms for rating based recommendations . As mentioned before , the check in count date have a wide range , so we also use NMF and BNMF for comparison . Moreover , we also compare our model with the fused method [ 6 ] , which fuse the geographical influence into factor models . Since BNMF also exploits the count check in characteristics , we fuse the geographical influence into BNMF and denote it as F BNMF .
3.4 The Method for Comparison
Since POI recommendation in LBSNs is highly location sensitive , the recommendation should be within the user ’s current region . Therefore , we measure the Top N performances by considering the recommendation within a region . We first cluster all the POIs into R regions . This is the initialization of the GT BNMF model . For SVD , PMF , NMF , BNMF and F BNMF methods , we make top N recommendation within the initialized R clustered regions by K means . For the proposed GT BNMF model , we recommend top N POIs within each learned latent region .
3.5 Implementation Details
We randomly divided the data into training ( 80 % ) and test(20 % ) data . We set λU = 0.01 and λC = 0.01 for PMF .
K Recall
10
20
@1 @5 @10 @1 @5 @10
SVD PMF NMF BNMF F BNMF GT BNMF 0.0008 0.0008 0.0049 0.0077 0.0038 0.0036 0.0103 0.0121 0.0060 0.0060 0.0153 0.0167 0.0011 0.0006 0.0046 0.0059 0.0037 0.0034 0.0098 0.0097 0.0065 0.0059 0.0151 0.0148
0.0081 0.0127 0.0176 0.0068 0.0107 0.0158
0.0147
0.0212
0.0061
0.0060
0.0144
0.0210
Table 4 : Recall @N with two different latent dimensions K .
We set the topic number Ktopic = 30 , α = 50/Ktopic and β = 0.1 in the aggregated LDA model to derive the user and POI profile topic distribution . For the GT BNMF model , we set α = 1 and β = 1 for latent priors , a = 1 and b = 1 for prior σ2 , 1/R for user region multinominal prior γ , and τ = 1 for the distance model . We set the number of regions R = 49 , which is the number of regions partitioned according to all the states in USA ( except HI and AK ) .
3.6 Performance Comparisons
In this subsection , we present the performance comparison on recommendation accuracies between our model and the baseline methods . We compare the results by setting two latent dimensions K = 10 and K = 20 . Precision and Recall @N . Table 3 and Table 4 show the precision and recall@N ( N = 1 , 5 , 10 ) of all the methods . It is clear that GT BNMF is significantly better than all the baseline methods . For example , for top 10 recommendation when K = 10 , SVD and PMF have precisions around 0.008 , NMF and BNMF improve SVD and PMF about 1.5 times . F BNMF can slightly improve BNMF , and GT BNMF significantly outperforms F BNMF . More clear comparisons can be observed in relative performance as described below . Relative performance @N . There are two reasons that relative performance @N serves as a better metric than the absolute precision and recall . First , please note that for baseline methods , we make top N recommendation within the initialized R clustered regions by K means ; for the proposed GT BNMF model , we recommend top N POIs within each learned latent region . So the candidate POIs can be different . We need a metric can handle such a change of candidate POIs . Second , we need to see how the models actually outperform a universal baseline , the random recommendation . The relative performance as defined in Equation ( 15 ) can satisfy these two requirements . A relative performance value equal to 1 indicates a random recommendation .
The relative performances as shown in Table 5 give a more clear comparisons between our GT BNMF and baseline methods . The relative performance values for SVD and PMF are around 1 , which means that the performances of these two methods are close to a random guess . For top1 recommendation , when latent dimension K = 10 , GTBNMF can achieve a 41.8 times improvements as compared 3.7 for NMF , 7.1 for BNMF , and 7.3 for F BNMF . For top 5
10
SVD PMF NMF BNMF F BNMF GT BNMF K @N 0.8729 0.7280 4.7736 8.1243 @1 42.8835 0.9345 0.8251 2.5871 3.0713 @5 @10 0.9829 0.8856 2.4480 2.8588 1.0148 0.7124 4.1618 5.8585 @1 @5 0.9287 0.8271 2.6095 2.6219 @10 1.0084 0.9067 2.5131 2.4717
8.3408 3.2956 2.9585 6.6864 2.8506 2.6043
16.1661
20.4742
21.0357
42.0183
16.0662
20
10
SVD PMF NMF BNMF F BNMF GT BNMF K @N 1.4271 0.6106 4.4885 6.0672 @1 48.4512 0.9628 0.8550 2.5644 2.9042 @5 @10 0.9161 0.8354 2.5335 2.3370 1.1717 0.5414 3.7472 6.1969 @1 @5 1.1172 0.7180 2.7691 2.9479 @10 0.9642 0.8181 2.5067 2.5391
6.1341 3.1243 2.5497 6.5094 3.0560 2.6679
17.4738
18.9053
17.4855
46.8855
18.8852
20
Table 5 : The relative performance @N with two different latent dimensions ( initiated by K means ) . It measures the improvement over a random recommendation . and top 10 recommendation , our proposed method can also achieve 20.0 times and 15.1 times improvements respectively , which are significantly better than all the baselines2 . The improvements can be clearly observed .
Summary . Due to the assumption of a Gaussian over the product of user and item latent factors uuu⊤vvv , SVD and PMF perform poorly as they cannot handle the skewed count data . Some previous studies , such as [ 18 ] , suggest to normalize the data through some transfer function and bound the results by a logistic function . This can work well if the data range is small . However , when the data is skewed , this method can make the normalized values indistinguishable . Thus , we call for a reconsideration of the recommendation assumption when we face the wide range count data in implicit feedback recommendation scenarios . We observe improvements by NMF and BNMF over SVD and PMF . The F BNMF method which exploits an ad hoc two steps to fuse the geographical influence into user preferences can only slightly improve BNMF . Therefore , an integrated analysis of multiple factors is needed for POI recommendations .
The GT BNMF model not only considers the geographical information of POIs , regional popularity and user mobility patterns for recommendation , but also updates the latent regions by considering these three sources of information . The learned regions reflect the collaborative user activity pattern . As a result , we can observe significant improvements over all the baseline algorithms .
3.7 Implications of Latent Regions
In addition to improving recommendation performances , our proposed model also provides an unique perspective on POI marketing segmentation in the form of the learned regions . Traditional geographic segmentation for target market is segmented according to geographic criteria such as states [ 13 ] and K means . Here , we intend to answer how the proposed method with learned latent regions improves the method based on traditional geographic segmentation according to administrative region division ( states ) ? The recommendation comparisons initialized by K means are shown in Section 36 Performance Comparisons . We first evaluate whether the GT BNMF model is robust to region initiations . We compare the relative performances initiated by K means and initiated by administrative region partition ( state ) . Instead of using K means for initial region clustering , we initialize our model with region partition according to administrative region division of states . Table 6 shows the relative performance comparisons of our proposed GT BNMF model
2
The best relative performance reported in [ 24 ] is 11 . This provides an average relative performance value even though we have a different recommendation task here .
Table 6 : The relative performance @N initialized according to administrative region partition . and baseline methods . The comparison results are similar as discussed before . For baseline methods , we make topN recommendation within the initialized regions according to administrative region division ( states ) . For the proposed GT BNMF model , we recommend top N POIs within each learned latent region by the model . We can observe similar performance improvements of our proposed method over baselines as that initiated by K means .
Figure 4 shows the relative performance initiated by two methods . We can see that GT BNMF initiated by states outperforms GT BNMF initiated by K means for top 1 and top 10 recommendation , but GT BNMF initiated by K means outperforms GT BNMF initiated by states for top 5 recommendation . In general , the GT BNMF model can achieve a relative stable performance initiated by two methods . Note that the GT BNMF model can update the latent regions towards a region segmentation that reflects geographical influence and user activity efforts . e c n a m r o f r e p e v i t l a e R
50
45
40
35
30
25
20
15
10
5
0
GT−BNMF
K−means
GT−BNMF state
@1 K=10 @5 K=10 @10 K=10 @1 K=20 @5 K=20 @10 K=20
Figure 4 : Relative performance of GT BNMF initiated by K means and initiated according to state partition .
Latent Region Analysis . We then analyze the latent regions identified by our model . Figure 6 shows the Voronoi visualization of regions identified by the proposed GT BNMF model compared with two different initiations , K means and according to state partition . Figure 6b shows the regions identified by GT BNMF vs its initiation by K means ( Figure 6a ) . Figure 6d shows the region update by GT BNMF vs its initiation according to state partition ( Figure 6c ) .
We take a representative hotspot , California , as an example to analyze the region update learned by the GT BNMF model . Figure 5 shows the zoom in visualization of latent regions ( Figure 5b ) learned from our model vs its initiation by K means ( Figure 5a ) in California . Though we have no ground truth about an optimal POI region segmentation , we can infer the user activity regions in CA through the collaborative check in behaviors of users who have visited CA and view the region clusters formulated by collaborative check in effort as ground truth ( as shown in Figure 5c ) . Through analyzing the collaborative check in frequency by those users , as shown in Figure 5c , we can see two clear clusters in north observable user features and item features , and leverage the topic distribution for the cold start problem .
Some previous studies on POI recommendations mainly relied on user trajectory data to infer user preferences . For example , previous works [ 27 , 26 , 9 , 16 ] applied collaborative filtering ( CF ) based method to recommend locations and travel packages based on user trajectory data . Actually , these works only consider one dimension factor of user POI check in decision process . More recent works , such as [ 23 , 3 ] , began to explore user preferences , social influence , and geographical influence for POI recommendations . However , it only used a simple CF algorithm to fuse these information , and thus lacking a comprehensive way to model how these information collectively influence user POI check in decision . Work [ 15 ] tried to explore side information to improve POI recommendations , but it does not explore user mobility information and does not take the skewed data characteristics of implicit user check in counts into the consideration .
More recently , Cheng et al . [ 6 ] considered the geographical influence , the multi center of user check in patterns , the skewed user check in frequency and social networks for POI recommendation . However , this work applied an ad hoc twostep method to fuse the geographical influence into user preferences . It considered the multi center pattern of user checkin behaviors , but it did not really consider the user mobility and lacked an integrated consideration of factors that can influence POI recommendation . Moreover , the greedy clustering method applied to derive the personalized multi centers would easily lead to overfitting problems in that it focuses on the regions a user has visited . Instead , our work is an integrated analysis of geographical influences , user mobility , word of mouth and skewed data for POI recommendation . In addition , our work has a connection with recent works on mobility modeling [ 10 , 8 ] . However , their tasks were different . Work [ 10 ] used similar multinomial assumption over different regions to model geographical topics in Twitter stream , paper [ 8 ] investigated human mobility for social network analysis . Also , people have used gaussian geographical distribution to model region over locations [ 20 , 25 , 10 ] . As described above , while there are some studies on POI recommendation , it lacks of an integrated analysis of the joint effects of multiple factors that influence the decision process of a user choosing a POI . These factors include user preferences , geographical influences , user mobility pattern , word of mouth , and the skewed implicit user check in counts data . The proposed method strategically takes all these factors into consideration and presents a flexible probabilistic generative model for POI recommendations .
5 . CONCLUSION
In this paper , we presented an integrated analysis of the joint effect of multiple factors which influence the decision process of a user choosing a POI and proposed a general framework to learn geographical preferences for POI recommendation in LBSNs . The proposed geographical probabilistic factor analysis framework strategically takes all these factors , which influence the user check in decision process , into consideration . There are several advantages of the proposed recommendation method . First , the model captures the geographical influence on a user ’s check in behavior by taking into consideration of geographical factors in LBSNs , such as the regional popularity and the Tobler ’s first law of geography . Second , the methods effectively modeled the user
( a ) K means .
( b ) Latent region .
( c ) Ground truth .
Figure 5 : Voronoi visualization of POI segmentation in California area . ( b ) latent regions learned from our model and ( a ) initiation by K means . ( c ) true user collaborative activity clusters . Deeper color ( red ) indicates more check ins for a POI , as contrary to light color ( green ) . Best view in color .
California area among other scattered POIs around , one in Los Angeles area , one in San Diego , and some scattered POIs between south and north California . K means only depends on POI distances to cluster POIs for region segmentation . As shown in Figure 5a , K means segments north California area into four different regions , and segments Los Angeles into two regions . However , by considering the user checkin behaviors and geographical factors , our model identified a more meaningful region partition as shown in Figure 5b , which is more coherent to real user activity as shown in Figure 5c . Similar results can also be observed in Figure 6 when GT BNMF is initiated according to administrative region partition . GT BNMF initiated by K means leads to better POI segmentation . We can see that GT BNMF models not only improves recommendation performances , but also provides an interesting perspective on POI marketing segmentation in the form of the learned regions .
4 . RELATED WORK
Recommender systems can be developed based on explicit user feedback . In other words , users rate items and the useritem preference relationship can be modeled on the basis of the user ratings . In contrast , recommender systems can also be developed based on implicit user feedback [ 11 ] , such as the search and click on a web site [ 17 , 5 ] , and the check in behaviors in LBSNs as we discussed in this paper . In this case , the recommender system has to infer user preferences from implicity user feedback . Here , latent factor models which are suitable for implicit user feedback are preferred . For instance , NMF [ 14 ] based method is used in recommendation due to its effectiveness in modeling implicity user feedback . Some studies [ 17 , 5 ] assumed a Poisson factor model with Gamma priors . Actually , the Poisson factor analysis can be equal to NMF in certain condition [ 14 ] . Euclidean distance based optimization leads to Gaussian NMF , and KLdivergence based optimization leads to Poisson NMF . For the purpose of efficiency , we adopt a Bayesian probabilistic non negative matrix factorization ( NMF ) method [ 19 ] . One drawback of latent factor models is the so called cold start problem , in which latent factor models perform poorly when there are unseen users or items . Recent works such as [ 22 , 1 , 2 ] incorporated side information into latent factor models by exploring user observable features and item observable features . In this paper , we applied a topic model to get the
( a )
( b )
( c )
( d )
Figure 6 : Voronoi visualization of POI segmentation comparisons . Latent regions ( b ) identified by our model GT BNMF vs its initiation by K means ( a ) ; Latent regions ( d ) updated by GT BNMF vs its initiation according to administrative region partition ( c ) . We exclude the POI points here , please refer to Figure 2a for geographical POI distributions . mobility patterns , which are important for location based services . Third , the proposed approach extended the latent factor in explicit rating recommendation to implicit feedback recommendation settings by considering the skewed count data characteristic of LBSN check in behaviors . Last but not least , the proposed model is flexible and could be extended to incorporate different later factor models which are suitable for both explicit and implicit feedback recommendation settings . Finally , experimental results on real world LBSNs data validated the performances of the proposed method .
6 . ACKNOWLEDGEMENT
This research was partially supported by National Science Foundation ( NSF ) via grant numbers CCF 1018151 and IIS1256016 . Also , it was supported in part by Natural Science Foundation of China ( 71028002 ) .
7 . REFERENCES
[ 1 ] D . Agarwal and B C Chen . flda : matrix factorization through latent dirichlet allocation . WSDM’10 , pages 91–100 .
[ 2 ] D . Agarwal and B C Chen . Regression based latent
[ 11 ] Y . Hu , Y . Koren , and C . Volinsky . Collaborative filtering for implicit feedback datasets . ICDM ’08 , pages 263–272 , 2008 .
[ 12 ] Y . Koren , R . Bell , and C . Volinsky . Matrix factorization techniques for recommender systems . Computer , 42(8):30–37 , Aug . 2009 .
[ 13 ] P . Kotler , K . Keller , M . Brady , M . Goodman , and
T . Hansen . Marketing Management . Pearson Prentice Hall , 2006 .
[ 14 ] D . D . Lee and H . S . Seung . Algorithms for non negative matrix factorization . In NIPS , pages 556–562 , 2000 .
[ 15 ] B . Liu and H . Xiong . Point of interest recommendation in location based social networks with topic and location awareness . SDM’13 , 2013 .
[ 16 ] Q . Liu , Y . Ge , Z . Li , E . Chen , and H . Xiong .
Personalized travel package recommendation . In ICDM , pages 407–416 , 2011 .
[ 17 ] H . Ma , C . Liu , I . King , and M . R . Lyu . Probabilistic factor models for web site recommendation . SIGIR ’11 , pages 265–274 , 2011 .
[ 18 ] R . Salakhutdinov and A . Mnih . Probabilistic matrix factorization . In NIPS , volume 20 , 2008 . factor models . KDD ’09 , pages 19–28 , 2009 .
[ 19 ] M . N . Schmidt , O . Winther , and L . K . Hansen .
[ 3 ] J . Bao , Y . Zheng , and M . F . Mokbel . Location based and preference aware recommendation using sparse geo social networking data . pages 199–208 , 2012 .
[ 4 ] D . M . Blei , A . Y . Ng , and M . I . Jordan . Latent dirichlet allocation . J . Mach . Learn . Res . , 3:993–1022 , Mar . 2003 .
[ 5 ] Y . Chen , M . Kapralov , D . Pavlov , and J . Canny .
Factor modeling for advertisement targeting . NIPS’09 , pages 324–332 . 2009 .
[ 6 ] C . Cheng , H . Yang , I . King , and M . R . Lyu . Fused
Bayesian non negative matrix factorization . ICA’09 , pages 540–547 , 2009 .
[ 20 ] S . Sizov . Geofolk : latent spatial semantics in web 2.0 social media . WSDM ’10 , pages 281–290 , 2010 . [ 21 ] W . Tobler . A computer movie simulating urban growth in the detroit region . Economic Geography , 46(2):234–240 , 1970 .
[ 22 ] C . Wang and D . M . Blei . Collaborative topic modeling for recommending scientific articles . In KDD 2011 , pages 448–456 , 2011 . matrix factorization with geographical and social influence in location based social networks . In AAAI , 2012 .
[ 23 ] M . Ye , P . Yin , W C Lee , and D L Lee . Exploiting geographical influence for collaborative point of interest recommendation . SIGIR ’11 , pages 325–334 .
[ 7 ] Z . Cheng , J . Caverlee , K . Y . Kamath , and K . Lee .
[ 24 ] P . Yin , P . Luo , W C Lee , and M . Wang . App
Toward traffic driven location based web search . CIKM’11 , pages 805–814 , 2011 . recommendation : a contest between satisfaction and temptation . WSDM ’13 , pages 395–404 , 2013 .
[ 8 ] E . Cho , S . A . Myers , and J . Leskovec . Friendship and
[ 25 ] Z . Yin , L . Cao , J . Han , C . Zhai , and T . Huang . mobility : user movement in location based social networks . KDD ’11 , pages 1082–1090 , 2011 .
Geographical topic discovery and comparison . WWW ’11 , pages 247–256 .
[ 9 ] Y . Ge , H . Xiong , A . Tuzhilin , K . Xiao , M . Gruteser ,
[ 26 ] V . W . Zheng , Y . Zheng , X . Xie , and Q . Yang . and M . Pazzani . An energy efficient mobile recommender system . In KDD , KDD ’10 , pages 899–908 , 2010 .
[ 10 ] L . Hong , A . Ahmed , S . Gurumurthy , A . J . Smola , and K . Tsioutsiouliklis . Discovering geographical topics in the twitter stream . WWW ’12 , pages 769–778 , 2012 .
Collaborative location and activity recommendations with gps history data . WWW’10 , pages 1029–1038 . [ 27 ] Y . Zheng , L . Zhang , X . Xie , and W Y Ma . Mining interesting locations and travel sequences from gps trajectories . In WWW 2009 , pages 791–800 , 2009 .
