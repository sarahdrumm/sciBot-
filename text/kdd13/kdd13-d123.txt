Multi Label Classification by Mining Label and Instance Correlations from Heterogeneous Information Networks
University of Illinois at Chicago
Renmin University of China
University of Illinois at Chicago
Bokai Cao
Philip S . Yu
Xiangnan Kong
Chicago , IL , USA xkong4@uic.edu
Beijing , China caobokai@ruceducn
Chicago , IL , USA
King Abdulaziz University
Jeddah , Saudi Arabia psyu@csuicedu
ABSTRACT Multi label classification is prevalent in many real world applications , where each example can be associated with a set of multiple labels simultaneously . The key challenge of multi label classification comes from the large space of all possible label sets , which is exponential to the number of candidate labels . Most previous work focuses on exploiting correlations among different labels to facilitate the learning process . It is usually assumed that the label correlations are given beforehand or can be derived directly from data samples by counting their label co occurrences . However , in many real world multi label classification tasks , the label correlations are not given and can be hard to learn directly from data samples within a moderate sized training set . Heterogeneous information networks can provide abundant knowledge about relationships among different types of entities including data samples and class labels . In this paper , we propose to use heterogeneous information networks to facilitate the multi label classification process . By mining the linkage structure of heterogeneous information networks , multiple types of relationships among different class labels and data samples can be extracted . Then we can use these relationships to effectively infer the correlations among different class labels in general , as well as the dependencies among the label sets of data examples inter connected in the network . Empirical studies on real world tasks demonstrate that the performance of multi label classification can be effectively boosted using heterogeneous information networks .
Categories and Subject Descriptors H28 [ Database Management ] : Database ApplicationsData Mining
General Terms Algorithm , Experimentation , Performance
Keywords Multi label Classification , Heterogeneous Information Network , Label Correlation , Data Mining 1 .
INTRODUCTION
Multi label classification has become increasingly important in recent years , where each example can be associated with multiple labels simultaneously . It has a wide range of real world applications . For example , in drug discovery , one molecular drug can bind with multiple protein targets , and researchers would like to predict which protein targets that one chemical compound can bind with in order to discover new drugs for a certain disease ; in gene disease association prediction , one gene sequence can involve in multiple diseases , and researchers are interested in predicting which diseases that each gene is related to .
The key challenge of multi label classification comes from the large space of all possible label sets , which is exponential to the number of candidate labels . To tackle this problem , conventional multi label classification approaches [ 33 , 11 , 15 ] focus on exploiting the correlations among different class labels to facilitate the learning process . It is usually assumed that the label correlations are given beforehand or can be derived directly from data samples by counting their label co occurrences .
However , in many real world multi label classification tasks , the label correlations are not given and can be hard to learn directly from data samples within a moderate sized training set . Heterogeneous information networks [ 31 ] can usually provide abundant knowledge about the relationships among different types of entities including data samples and class labels . In this paper , we propose to use heterogeneous information networks to facilitate the multi label classification process . We first introduce an example of real world multilabel classification task and show how a heterogeneous information network can facilitate the learning process of multilabel classification . Example ( Drug Target Binding Prediction ) : In drug discovery , one molecular drug can bind with a set of gene targets . The multi label classification task here is to predict which set of gene targets that one chemical compound can bind with in order to discover new drugs for a certain disease . The number of candidate labels are usually very large , involving hundreds or thousands of gene targets . The correlations among these gene targets are hard to learn directly from data samples within a moderate sized training set . However , if we already have a heterogeneous informa
614 Figure 1 : An example of heterogeneous information network ( the data schema of SLAP network ) . Each box represents one type of nodes in the network , and each dashed line represents one type of links . Each number under the node/link represents the total number of nodes/links of the same type . tion network 1 as Figure 1 that contains abundant knowledge about the relationships among different types of entities including chemical compounds and gene targets , we can make use of the domain knowledge within this network to facilitate multi label classification .
First , the heterogeneous information network can provide abundant knowledge about the relationships among different gene targets . In the network , gene targets are interconnected with many other types of nodes , such as diseases and pathways . The gene targets , that are linked with similar diseases or pathways , are more likely to appear together in the same label set than those without such connections . Second , the heterogeneous information network can also provide abundant knowledge about the relationships among different chemical compounds . In the network , chemical compounds are also connected with other types of objects , such as side effects and chemical ontologies . The chemical compounds , that are linked with similar side effects or chemical ontologies , are more likely to have similar label sets than the chemicals without such connections .
By mining the linkage structure of heterogeneous information networks , multiple types of relationships among different class labels and data samples can be extracted . Such relationships can then be used to infer the correlations among different class labels in general , and the dependencies among the label sets of different data samples . In this paper , we focus on studying the problem of multi label classification by mining label and instance correlations from heterogeneous information networks . The major research challenges are as follows :
Mining heterogeneous label correlations :
In multi label classification , the multiple label concepts can be correlated with each other through multiple types of relationships . For example , different gene targets can be correlated for various
1SLAP dataset [ 4 ] : this dataset is an information network that integrates many datasets into a single framework using Semantic Web technologies for drug discovery . It includes public datasets related to systems chemical biology : such as PubChem , DrugBank , PPI , SIDER , CTD diseases , KEGG Pathways , etc .
Figure 2 : Multi label classification by mining heterogeneous information networks . reasons : 1 ) they belong to the same gene family ; 2 ) they share similar pathways ; 3 ) they are inter connected through PPI links , etc . Heterogeneous information networks can provide complex relationships among the label concepts , involving multiple types of label correlations [ 28 ] . How to exploit the linkage semantics is a very challenging problem [ 28 ] , which has not yet been explored in this context .
Mining heterogeneous instance correlations : In multi label classification , the label sets of different instances can also be correlated with each other through multiple types of relationships . For example , different chemical compounds can be correlated for various reasons : 1 ) they have similar side effects ; 2 ) they have similar chemical ontologies ; 3 ) they have similar substructures , etc . Heterogeneous information networks can provide complex relationships among different instances , involving multiple types of correlations .
In this paper , we study how we can facilitate the multilabel classification process by mining the correlations among instances and labels from heterogeneous information networks . We propose a novel solution , called PIPL , to assign a set of candidate labels to a group of related instances in heterogeneous information networks . Different from previous work , the proposed PIPL , as shown in Figure 2 , can exploit various types of dependencies among both of instances and labels based upon different meta paths in heterogeneous information networks . By explicitly exploiting these metapath based dependencies , our PIPL method can effectively capture the diverse and complex relationships among instances and labels . Empirical studies on real world tasks show that the proposed method can significantly boost the performance of multi label classification by incorporating information from heterogeneous information networks .
2 . PROBLEM DEFINITION
In this section , we first introduce some related concepts and notations , then define the problem .
Gene20419causeDisease2676Gene Family329Disease1284Tissue507Gene Ontology9710Pathway192hasGeneOntology89691hasPathway10796hasTissue9905hasGeneFamily7181Substructure290Chemical Ontology2777Chemical Compound244233Side Effect1051hasSubstructure6127hasChemicalOntology14633causeSideEffect9004bind489392treatDisease927PPI30213615 2.1 Multi label Classification i associated with a label set , denoted as Yi =,Y 1
Suppose we have a multi label classification task with n instances and q labels . The set of all instances is denoted as VI = {I1,··· , In} , where each instance Ii has a feature vector xi in the input space . The set of all candidate labels is denoted as V = {1,··· , q} . Without loss of generality , we assume the first n instances in VI , denoted as V I = {I1,··· , In} ⊂ VI , are labeled , where each instance Ii is i ,··· , Y q ∈ {0 , 1}q . If instance Ii has the j th label j in its label set , i = 0 . The remaining instances in VI Y j i = 1 , otherwise Y j are unlabeled , ie , V u I = VI − V I . The task of multi label classification is to predict the label sets for all the unlabeled instances in V u I . In other words , for any possible label set Y ∈ {0 , 1}q and any instance Ii , we need to build a model to estimate the probability P ( Y|xi ) based upon the training dataset . The key challenge of multi label classification comes from the fact that the output space of all possible label sets {0 , 1}q is very large , which is exponential to the number of candidate labels q . In order to tackle this problem , one simplest solution is to decompose the multi label classification problem into a set of binary classification problems ( one for each label ) , eg , Bsvm [ 2 ] . This method can estimate P ( Y|xi ) for instance Ii approximately by assuming that all labels are independent :
∀i , P ( Y|xi ) ≈q
P ( Y k|xi ) k=1
However , the correlations among different labels are totally ignored in these methods .
Most previous multi label classification approaches focus on exploiting the label correlations to facilitate the learning process . For example , the Ecc method [ 27 ] captures label correlations directly from data samples by approximate the probability P ( Y|xi ) as follows : P ( Y|xi ) ≈ P ( Y 1|xi ) P ( Y 2|Y 1 It is usually assumed implicitly that the label correlations can be derived directly from the observed data samples by counting their label co occurrences . i |Y 1 , Y 2 , xi)··· i , xi ) P ( Y 3
However , in many real world multi label classification tasks , the label correlations are hard to learn directly from data samples with a moderate sized training set . Heterogeneous information networks [ 31 ] can usually provide abundant knowledge about the relationships among different types of entities including data samples and class labels . In this paper , we propose to use heterogeneous information networks to facilitate the multi label classification process . 2.2 Heterogeneous Information Network
A heterogeneous information network is a special kind of information network with multiple types of nodes and multiple types of links [ 31 , 28 ] . It can be represented as a directed graph G = ( V,E ) . V denotes the set of nodes , which involves t types of objects : V1 = {v11,··· , v1n1} ,··· ,Vt = {vt1,··· , vtnt} , where vij represents the j th object of type i . E ⊆ V × V denotes the links between the objects in V , which includes multiple types of links . First we define the type of nodes in the heterogeneous information network G corresponds to the instances of the multi label classification task as the instance type . While we define type of nodes corresponds to the label concepts for the multi label classification task as the label type . For example , in the task of drug target binding prediction , the chemical compound nodes are the instances and the gene nodes are the labels ; in the task of gene disease association prediction , the gene nodes are the instances and the disease nodes are the labels .
3 . PROPOSED METHOD
Heterogeneous information networks can provide abundant knowledge about the relationships among different types of entities including data samples and class labels . By mining the linkage structure of heterogeneous information networks , multiple types of relationships among different class labels and the data samples can be extracted . Such relationships can be used to infer the correlations among different class labels in general , and the dependencies among the label sets of different data samples .
In the following subsections , we first discuss how to extract heterogeneous relationships among different labels from heterogeneous information networks in section 32 We then discuss how to extract heterogeneous relationships among the instance from heterogeneous information networks in section 33 We then integrate these two parts into a unified model in section 34
3.1 Meta path
Before discussing in detail about the proposed method , we first introduce the concept of meta path in heterogeneous information networks . Following the works [ 28 , 20 , 18 , 30 ] , we first briefly review the concept of meta path . Then we use meta paths to describe the possible relationships among instances and labels derived from a heterogeneous information network .
Generally , meta path is defined as a sequence of relations in the network schema . The objects in heterogeneous information networks ( including the instances and labels ) are inter connected through multiple types of links . Each type of links from node type i to node type j corresponds to a binary relation R , where R(vip , vjq ) holds if object vip and vjq are linked by a link of type R . For example , in Figure 1 , the link type “ hasPathway ” is a relation between gene nodes and pathways nodes , where R(vip , vjq ) holds if the gene node vip has a link of type “ hasPathway ” to the pathway node vjq in the network . We can write the link type as “ gene
−−−−−−−−→ pathway ” or “ Vi
A meta path P corresponds a type of path within the network graph , containing a certain sequence of link types . For −−−−−−−−→ pathexample , in Figure 1 , a meta path “ gene hasP athway−1 −−−−−−−−−−→ gene ” denotes the composite relationway ship between gene nodes where the semantic meaning of this meta path is that the two gene nodes share a common pathway node . The link type “ hasPathway−1 ” represents the inverted relation of “ hasPathway ” .
R−→ Vj ” . hasP athway hasP athway
Different meta paths usually represent different relationships among the linked objects with totally different semantic meanings . For example , the meta path “ gene P P I−−−→gene ” denotes the two gene nodes are connected through “ PPI ” links ; while meta path “ gene hasGO−−−−→GO hasGO−1 −−−−−−→gene ” corresponds to the semantic meaning that the two gene nodes share common gene ontology terms .
616 Input:G : a heterogeneous information network , p max , : maximum meta path length ( default=4 ) YL : label sets for the training instances , Meta path Construction : Construct the meta path set for label correlations S = {P1 , · · · , Pc} :
A : a base learner for local model ,
X : attribute vectors for all instances .
Tmax : maximum # of iteration ( default=10 )
Breadth first search on schema graph of G starting from label type by adding short meta paths that ends with label type into S first : 1 . If the length of meta path is greater than p max , exit the BFS ; 2 . If current meta path Pj cannot be reconstructed by the paths in S , add Pj into S ; Otherwise , prune the current path from BFS .
Training Initialization : similar BFS , but starting and ending with instance type .
Construct the meta path set for instance correlations SI = {P
1 , · · · , P i = ( xi , LabelPathFeature(k , Yi ) , InstancePathFeature(i , YL ) ) xk
1 . Construct q extended training sets ∀1 ≤ k ≤ q , Dk = 2 . Let fk = A(Dk ) be the local model trained on Dk .
Learn the local model f : i , yk i )
( xk
} : cI by converting each instance xi to xk i as follows :
Bootstrap :
Estimate the label sets , for i ∈ U : produce an estimated values ˆYi for Yi as follows : ˆYi = f ( (xi , 0 ) ) using attributes only .
Repeat until convergence or #iteration> Tmax
1 . Construct the extended testing instance by converting each instance xi to xk xi , LabelPathFeature(k , ˆYi ) , InstancePathFeature(i , YL ∪ { ˆYi|i ∈ U} , S ) xk i =
2 . Update the estimated value ˆYi for Yi on each testing instance ( i ∈ U ) as follows : ∀1 ≤ k ≤ q , ˆY k i ’s ( i ∈ U ) as follows : i = fk(xk i ) .
Iterative Inference :
ˆY1 , · · · , ˆYnu
:
Output : ˆYU = the label sets of testing instances ( i ∈ U ) .
Figure 3 : The PIPL algorithm
3.2 Meta path based Label Correlations
Heterogeneous information networks can involve various existing knowledge about the candidate label concepts , where the complex correlations among label concepts are embedded within the network structures . For example , in Figure 1 , the label nodes ( ie , the gene nodes ) are linked with each other directly through “ PPI ” links .
It indicates one type of label correlation within the network structure : gene labels that are linked by “ PPI ” links can be more likely ( or less likely ) to appear together in the label set of a chemical compound than those without “ PPI ” links .
−−−−−−→gene ” .
To generalize , the label concepts can also be linked by certain meta paths , thus being correlated . For example , the gene labels are also linked with each other through the metapath “ gene hasGO−−−−→GO hasGO−1 It indicates another type of label correlations : gene labels that share similar gene ontology terms can be more likely ( or less likely ) to appear together in the label set of a chemical compound than those without such meta path links . Thus meta paths among the label nodes , ie , the meta path starting and ending with the label node type , can effectively capture different types of label correlations embedded in heterogeneous information networks .
We propose to exploit meta path based label correlations for multi label classification . Given a set of meta paths among the label nodes , S = {P1,··· ,Pc} , the meta pathbased label correlations can be used as follows :
∀i , P ( Yi|xi ) ≈ q
P ( Yk i |xi , Y
P1(k ) i
,··· , Y
Pc i
( k )
) k=1 where Pj(k ) denotes the index set of labels that are linked to the k th label through meta path Pj ∈ S . 3.3 Meta path based Instance Correlations
Existing approaches for multi label classification usually have iid assumptions , where the label set predictions on different instances are assumed to be independent :
P ( Y|X ) ≈
P ( Yi|xi ) i
However , in heterogeneous information networks , there are complex correlations not only among different labels but also among different instances . Heterogeneous information networks can involve various existing knowledge about the instances , where the complex correlations among the label sets of different instances are embedded within the network structures . causeSideEf f ect causeSideEf f ect−1 −−−−−−−−−−−−−→ chemical compounds ” .
Similar to the previous subsection , the instance nodes can also be linked by certain meta paths , thus the label sets of the linked instances can be correlated . For example , the chemical compound nodes are linked with each other through −−−−−−−−−−−→ Side Efthe meta path “ chemical compound fect It indicates the type of instance correlations : chemical drugs that share similar side effects can be more likely ( or less likely ) to have similar label sets than those without such meta path links . Thus meta paths among the instance nodes , ie , the metapath starting and ending with the instance node type , can effectively capture different types of instance correlations embedded in heterogeneous information networks .
We propose to exploit meta path based instance correlations for multi label classification . Given a set of meta paths cI} , the metaamong the instance nodes , SI = {P path based instance correlations can be used as follows :
1,··· ,P
P ( Y|X ) ≈
P ( Yi|xi , YP
1(i),··· , YP cI
( i ) ) i j(i ) denotes the index set of instances that are linked where P to the i th instance through meta path P 3.4 The Unified Model j ∈ SI .
In order to perform multi label collective classification more effectively in heterogeneous information networks , in this paper , we explicitly consider both meta path based la
617 • x = LabelPathFeature ( k , Yi ) For each meta path Pj ∈ S : 1 . Get related labels for node k through meta path Pj
2 . xj = Aggregation,{Y k ie , the related index set C = Pj ( i ) i |k ∈ C}
Return ( · · · , x j , · · · )
• xI = InstancePathFeature ( i , Y ) j ∈ SI :
For each meta path P 1 . Get related instances for node Ii through meta path P j , 2 . xj = Aggregation ( {Yi|i ∈ C} ) Return ( · · · , x ie the related index set C = P j ( i ) j , · · · )
Figure 4 : The functions of constructing relational features for meta path based label correlations and meta path based instance correlations bel correlations and meta path based intance correlations simultaneously .
P ( Y|X ) ≈ q
P ( Yk i |xi , Y
Pj ( k ) i
,··· , YkP j ( i),··· ) i k=1
In Figure 3 , we summarize the proposed multi label collective classification algorithm , called PIPL . The algorithm includes the following steps : Meta path Construction : Given a heterogeneous information network , we first extract all non redundant metapaths for label correlations and instance correlations separately . A meta path Pj in S ( or P j in SI ) is non redundant if Pj ( or P j ) cannot be reconstructed by combining any subset of the meta paths in S ( or SI ) . We only extract short meta paths with a maximum path length p max . It has been shown in [ 28 ] that long meta paths are not quite useful in capturing the linkage structure of heterogeneous information networks . Training Initialization : We construct q extended train ing sets ∀1 ≤ k ≤ q,Dk = ( (xk i ) ) by converting each i , yk instance xi to xk i using the functions in Figure 4 . We train one classifier on each label , using the extended training sets . Iterative Inference : Overall , it is an iterative classification algorithm [ 22 ] for the inference step . During the inference , we iteratively update the label set predictions of the testing instances , and the relational features corresponding to the label and instance correlations .
4 . EXPERIMENTS 4.1 Data Collections
In order to evaluate the performances of multi label collective classification in heterogeneous information networks , we had our algorithm tested on a bioinformatic dataset SLAP [ 4 ] , which is a heterogeneous network composed by over 290K nodes and 720K edges . As shown in Figure 1 , the SLAP dataset contains integrated data related to chemical compounds , genes , diseases , side effects , pathways etc . Specifically , there are two different prediction tasks studied in this section : • Gene Disease Association Prediction : The first task we studied is gene disease association prediction , where we treat genes as the instances , and diseases as the labels . In SLAP dataset , each gene can cause or be related to multiple diseases simultaneously . The label set of each gene is defined as the set of diseases that the gene can cause . The task of gene disease association prediction is that , we are given a set of training gene instances , and for each unlabeled gene instance , we want to predict which set of diseases the gene can cause . In this way , we could discover what kinds of diseases might be caused by a specific gene . In details , we extracted 3000 gene ontology terms ( GO terms ) and used them as the features of each gene instance . The top 50 diseases that are associated with the largest number of genes were used as the candidate labels . The labels of this task is highly incomplete . Thus , we kept all the genes which had at least one label , and randomly sampled additional gene instances without any direct link connection to any disease , according to 1 : 10 ratio . The final dataset contains 1943 instances , 3000 features and 50 labels in total . All the remaining nodes are kept in the network , and can be used in meta paths . • Drug Target Binding Prediction : The second task we studied is drug target binding prediction , where we treat chemical compounds as the instances and genes as the labels . We first represent the structure of each chemical compound as a graph object . Then we used the multi label subgraph mining algorithm [ 19 ] to extract 1500 subgraphs from the dataset and used them as features of the instances . Similar to the previous task , the top 50 genes that are binded with the largest number of chemical compounds were used as the candidate labels . We removed the instances with no feature . The dataset contains 5651 instances , 1500 features and 50 labels in total . All the remaining nodes are kept in the network , and can be used in meta paths . 4.2 Evaluation Metrics
Multi label classification problems require more complicated criteria for performance evaluation than conventional single label classification problems . We use some evaluation criteria in [ 10 , 14 , 21 , 37 , 8 ] to verify the multi label classification performance in heterogeneous information networks . Given a multi label dataset DU involving n instances , ie , ( xi , Yi ) . Here Yi ∈ {0 , 1}q ( i = 1,··· , n ) . Denote h(xi ) as the predicted label set for xi by a multi label classifier h . We have the following evaluation criteria : • Micro F1 [ 10 , 14 , 21 ] : is the harmonic mean of micro average of Precision and Recall . The micro average means that the score is first computed on each label separately and then averaged with equal importance . micro F1(h,DU ) = i=1 h(xi ) ∩ Yi1 i=1 Yi1
2 ×n n i=1 h(xi)1 +n n
1 n
1 q i=1
The larger the value , the better the performance . • Hamming loss [ 8 , 37 ] : evaluates the symetric difference between true labels and predicted labels .
HammingLoss(h,DU ) = h(xi ) ⊕ Yi1 where ⊕ stands for the symmetric difference of two sets . ·1 denotes the l1 norm . The smaller the value , the better the performance . • Subset 0/1 Loss [ 8 , 10 ] : evaluates 0/1 loss over the label set prediction .
SubsetLoss(h,DU ) =
1 n
I ( h(xi ) = Yi )
I(· ) denotes the indicator function , ie , I(π ) = 1 iff π holds , n i=1
618 Table 1 : Summary of compared methods .
Method
Type of Classification
Type of Correlations Exploited
Publication
Bsvm
Ecc
PIsl
Icml
PIml
PIPL
Binary Classification all independent
Multi Label Classification
Collective Classification x label correlcation from data samples y instance correlations from heterogeneous network x label correlation from data samples
Multi Label Collective Classification z instance correlation from homogeneous network Multi Label Collective Classification y instance correlations from heterogeneous network
[ 2 ]
[ 27 ]
[ 18 ]
[ 17 ]
This paper
Multi Label Collective Classification { label correlations from heterogeneous network
This paper y meta path based instance correlation
Table 2 : Classification performances “ average score ± std ( rank ) ” on gene disease association prediction task . “ ↓ ” indicates the smaller the value the better the performance ; “ ↑ ” indicates the larger the value the better the performance . criteria #label
Micro F1 ↑
Hamming Loss ↓
Subset 0/1 Loss ↓
10 20 30 40 50
10 20 30 40 50
10 20 30 40 50
Bsvm
0360±0082 ( 6 ) 0385±0046 ( 6 ) 0317±0035 ( 6 ) 0342±0045 ( 5 ) 0303±0055 ( 6 ) 0011±0002 ( 1 ) 0008±0001 ( 1 ) 0008±0000 ( 5 ) 0007±0000 ( 4 ) 0006±0001 ( 1 ) 0108±0023 ( 5 ) 0153±0008 ( 4 ) 0197±0009 ( 4 ) 0227±0018 ( 4 ) 0255±0026 ( 5 )
Ecc
0387±0073 ( 4 ) 0406±0043 ( 4 ) 0359±0027 ( 2 ) 0386±0032 ( 3 ) 0346±0059 ( 4 ) 0013±0002 ( 6 ) 0010±0000 ( 6 ) 0009±0000 ( 6 ) 0007±0000 ( 4 ) 0007±0001 ( 6 ) 0125±0020 ( 6 ) 0180±0011 ( 6 ) 0212±0006 ( 6 ) 0238±0016 ( 5 ) 0275±0029 ( 6 ) methods
Icml
0366±0079 ( 5 ) 0389±0066 ( 5 ) 0343±0039 ( 5 ) 0339±0042 ( 6 ) 0321±0063 ( 5 ) 0011±0002 ( 1 ) 0008±0000 ( 1 ) 0007±0000 ( 1 ) 0007±0000 ( 4 ) 0006±0001 ( 1 ) 0107±0020 ( 4 ) 0154±0006 ( 5 ) 0191±0010 ( 5 ) 0228±0017 ( 1 ) 0250±0030 ( 4 )
PIsl
0390±0115 ( 3 ) 0417±0055 ( 3 ) 0342±0037 ( 4 ) 0382±0034 ( 4 ) 0348±0064 ( 3 ) 0011±0003 ( 1 ) 0008±0001 ( 1 ) 0007±0001 ( 1 ) 0006±0000 ( 1 ) 0006±0001 ( 1 ) 0103±0024 ( 1 ) 0148±0005 ( 2 ) 0195±0011 ( 3 ) 0219±0018 ( 3 ) 0244±0028 ( 3 )
PIml
0399±0107 ( 2 ) 0426±0055 ( 2 ) 0355±0013 ( 3 ) 0387±0030 ( 2 ) 0360±0075 ( 2 ) 0011±0003 ( 1 ) 0008±0001 ( 1 ) 0007±0001 ( 1 ) 0006±0000 ( 1 ) 0006±0001 ( 1 ) 0103±0024 ( 1 ) 0148±0009 ( 2 ) 0192±0010 ( 2 ) 0218±0014 ( 2 ) 0243±0028 ( 2 )
PIPL
0400±0106 ( 1 ) 0433±0066 ( 1 ) 0360±0007 ( 1 ) 0391±0030 ( 1 ) 0366±0078 ( 1 ) 0011±0002 ( 1 ) 0008±0001 ( 1 ) 0007±0000 ( 1 ) 0006±0000 ( 1 ) 0006±0001 ( 1 ) 0103±0023 ( 1 ) 0147±0007 ( 1 ) 0191±0009 ( 1 ) 0216±0015 ( 1 ) 0241±0028 ( 1 ) otherwise I(π ) = 0 . The smaller the value , the better the performance . 4.3 Compared Methods
In order to demonstrate the effectiveness of our multi label classification approach , we compared the following methods ( summarized in Table 1 ) :
• Bsvm ( binary SVM ) : The first baseline method uses binary decomposition method to solve multi label classification problems , which is similar to [ 2 ] . The multilabel dataset is first divided into multiple single label datasets by one vs all binary decomposition . For each binary classification task , we use the SVM as the base classifier . Then the predictions of SVMs for all labels are combined to make the final prediction . Bsvm assumes all the labels and all instances are independent . • Ecc ( multi label classification + ensemble ) : This baseline method is an ensemble of classifier chains ( CC ) [ 27 ] . The ensemble is created by training different classifier chains using randomly sampled subset of instances with random label orders .
• PIsl ( binary decomposition + meta path based instance correlation ) : We compare with another baseline using binary decomposition . For each binary classification task , we use the meta path based collective classification method in heterogenous information networks [ 18 ] to perform the binary collective classification . This method can exploit the meta path based instance correlation within a heterogenous information network .
• Icml ( simple label correlation + instance correlation in homogeneous network ) : This method was proposed in [ 17 ] which can exploit relational features for interinstance dependencies based upon homogeneous network for multi label collective classification . Since this method requires a homogeneous network among the instances , we can only run this method on the GeneDisease association prediction task , where the PPI network is used as the homogeneous network among the gene instances .
• PIml ( simple label correlation + meta path based instance correlation ) : This method is extended from PIsl [ 18 ] by adding relational features according to interinstance cross label dependencies for multi label collective classification [ 17 ] . This method can only exploit the instance correlations from heterogeneous networks . However , the label correlations used in this method are directly derived from data samples instead of using heterogeneous networks .
• PIPL ( meta path based instance and label correla
619 Table 3 : Classification performances “ average score ± std ( rank ) ” on drug target binding prediction task . “ ↓ ” indicates the smaller the value the better the performance ; “ ↑ ” indicates the larger the value the better the performance . criteria #label
Micro F1 ↑
Hamming Loss ↓
Subset 0/1 Loss ↓
10 20 30 40 50
10 20 30 40 50
10 20 30 40 50
Bsvm
0532±0046 ( 5 ) 0553±0019 ( 5 ) 0536±0052 ( 5 ) 0523±0018 ( 5 ) 0521±0028 ( 5 ) 0024±0003 ( 5 ) 0019±0001 ( 5 ) 0018±0002 ( 5 ) 0017±0001 ( 5 ) 0016±0001 ( 5 ) 0147±0012 ( 5 ) 0222±0009 ( 5 ) 0265±0019 ( 5 ) 0305±0008 ( 5 ) 0351±0009 ( 5 )
Ecc
0576±0053 ( 4 ) 0588±0018 ( 4 ) 0585±0054 ( 4 ) 0568±0022 ( 4 ) 0571±0036 ( 4 ) 0021±0003 ( 4 ) 0017±0000 ( 4 ) 0016±0002 ( 4 ) 0015±0001 ( 4 ) 0014±0001 ( 4 ) 0128±0017 ( 4 ) 0193±0006 ( 4 ) 0223±0029 ( 4 ) 0250±0004 ( 2 ) 0288±0018 ( 2 ) methods
PIsl
0608±0046 ( 3 ) 0696±0016 ( 3 ) 0674±0032 ( 3 ) 0599±0022 ( 3 ) 0603±0031 ( 3 ) 0020±0003 ( 2 ) 0012±0001 ( 3 ) 0012±0001 ( 3 ) 0014±0001 ( 3 ) 0013±0001 ( 3 ) 0123±0011 ( 2 ) 0165±0011 ( 3 ) 0214±0007 ( 3 ) 0268±0010 ( 4 ) 0306±0013 ( 4 )
PIml
0611±0040 ( 2 ) 0714±0011 ( 2 ) 0695±0025 ( 2 ) 0618±0022 ( 2 ) 0635±0028 ( 2 ) 0020±0002 ( 3 ) 0012±0001 ( 2 ) 0011±0000 ( 2 ) 0013±0001 ( 2 ) 0012±0001 ( 2 ) 0124±0010 ( 3 ) 0163±0010 ( 2 ) 0207±0004 ( 2 ) 0257±0010 ( 3 ) 0288±0020 ( 3 )
PIPL
0625±0042 ( 1 ) 0724±0011 ( 1 ) 0706±0026 ( 1 ) 0642±0022 ( 1 ) 0653±0026 ( 1 ) 0018±0002 ( 1 ) 0011±0001 ( 1 ) 0010±0000 ( 1 ) 0012±0001 ( 1 ) 0011±0001 ( 1 ) 0113±0010 ( 1 ) 0148±0004 ( 1 ) 0182±0003 ( 1 ) 0223±0010 ( 1 ) 0261±0017 ( 1 ) tion ) : The proposed method for multi label collective classification in heterogenous information networks . The only difference between PIPL and PIml is that PIml does not consider the meta path based label correlation .
For a fair comparison , we use LibSVM [ 3 ] with linear kernel and default parameter as the base classifier for all the compared methods . The maximum number of iterations in the methods PIPL , PIml and PIsl are all set as 10 . 4.4 Performances of Multi Label Classification We first study the effectiveness of the proposed PIPL method on multi label collective classification in heterogeneous information networks . In our experiments , 5 fold cross validations are performed on each task to evaluate the performances of multi label collective classification . We show the detailed results in Table 2 and Table 3 , with the number of candidate labels varying from 10 to 50 . The average performances of the five methods with standard deviations are reported with respect to three different evaluation metrics . In both tasks , we can observe that the Bsvm method , which assumes all instances and labels are independent , is outperformed by other methods , which explicitly consider correlations among predictions from various aspects . These results demonstrate the importance of exploiting different types of correlations for multi label collective classification in heterogeneous information networks . In details , PIsl can improve performances over Bsvm because it exploits the meta path based instance correlation . These results support our first assumption that in multi label heterogenous information networks , the label sets of related instances through instance meta pahts are not independent , and should be classified collectively . Similar conclusions can also be drawn from the results that PIml outperforms Ecc . Though both methods can exploit simple label correlation , PIml can further exploit the meta path based instance correlations , while Ecc assumes that the label sets of different instances are independent , and are predicted independently . Thus it is necessary and important to exploit the meta path based correlations among the related instances .
We also observe that in gene disease association predic tion task , meta path based methods designed for heterogeous networks ( ie , PIsl , PIml , PIPL ) can achieve better performances than the Icml that only exploits the homogeneous network among instances .
We further observe that the proposed PIPL performs the best among all compared methods . Especially , PIPL outperforms PIml and PIsl , by taking meta path based label correlation into consideration . In heterogeneous information networks , both of instances and candidate labels can be correlated with each other via diverse semantic meanings . In Table 4 , we show four examples of the meta paths used by PIPL method in both tasks , which correspond to label correlations and instance correlations separately . Such complex correlations can be effectively exploited through instance and label meta paths and thus boost the classification performances of multi label collective classification in heterogeneous information networks . 4.5 Sensitivity to Number Features
In previous subsection , we extracted 3000 GO terms and used them as features for Gene Disease association prediction task . For Drug Target binding prediction task , we extracted 1500 substructures of the chemical compounds and used them as features . To test the stability of the performances of PIPL method , we show the micro F1 scores of each method under different numbers of features ( ranging from 500 to 5000 in Gene Disease association prediction task , and from 400 to 2400 in Drug Target binding prediction task ) with 50 candidate labels . Figure 5(a ) and Figure 5(b ) illustrate that PIPL performs quite well and stably , and it is not sensitive to the number of features .
5 . RELATED WORK
Multi label classification has been extensively studied in recent years [ 33 , 11 , 15 , 32 , 5 , 25 , 12 ] . Conventional methods can be roughly categorized as follows : ( 1 ) binary approaches , which converts the multi label problem into multiple independent binary classification problems ( one for each label ) [ 2 , 36 ] ( 2 ) pairwise approaches which exploit the pairwise relation between different labels [ 10 , 9 ] . ( 3 ) Highorder approaches : The third type of approaches considers
620 Task
Meta path
Table 4 : Examples of meta paths used in PIPL method
Gene Disease Disease
Prediction
Gene
Disease treated
−−−−−→Chemical compound −−−−−→Chemical compound treated treat−−−−→Disease has−−→Substructure
−−−−−→Chemical compound bind−−−→Gene in−−→Chemical compound treat−−−−→Disease
Gene
Gene binded treated cause−−−−→Disease −−−−−→Chemical compound P P I−−−→Gene has−−→pathway has−−→Gene cause−−−−→Side effect caused
−−−−−→Chemical compound bind−−−→Gene
Drug Target
Gene
Prediction
Chemical compound
Chemical compound bind−−−→Gene bind−−−→Gene
P P I−−−→Gene has−−→Tissue binded
−−−−−→Chemical compound has−−→Gene
−−−−−→Chemical compound binded
Correlation label correlation label correlation instance correlation instance correlation label correlation label correlation instance correlation instance correlation
( a ) Gene Disease Association Prediction
( b ) Drug Target Binding Prediction
Figure 5 : Micro F1 scores with different number of features .
Table 5 : Summary of related datasets used in network classification . dataset publication network type of classification
#types
( node,link ) #Nodes Node Types
[ 34 ] [ 22 ]
Gene Citeseer WebKB [ 7 ] DBLP ACM Cora IMDB NASD
[ 17 ] [ 18 ] [ 23 ] [ 1 ] [ 24 ] single label homogeneous single label homogeneous homogeneous single label homogeneous multi label single label heterogeneous heterogeneous single label single label heterogeneous heterogeneous single label
( 1,1 ) ( 1,1 ) ( 1,1 ) ( 1,1 ) ( 5,5 ) ( 5,5 ) ( 5,5 ) ( 5,6 ) gene paper
1,243 3,312 3,877 webpage author 4638 paper,author,conference,proceeding,school 12,499 paper , author , journal , publisher , editor 4,330 1,382 movie , actor , director , studio , producer
22,000 broker , branck , firm , disclosure , regulator
SLAP this paper heterogeneous multi label
( 10,11 )
280,792 drug , disease , gene , side effect , pathway tissue , GO , gene family , substructure,CO the high order correlations among different labels . Such approaches includes random subset ensemble approaches [ 26 , 27 ] , Bayesian network based approach [ 35 ] and full order approaches [ 6 , 8 ] . [ 17 ] studied the multi label collective classification using homogeneous networks .
Heterogeneous information networks have attracted much attention in recent years [ 31 , 29 , 13 ] . Sun et al . [ 31 , 28 ] studied the clustering problem and top k similarity problem in heterogeneous information networks . Ji et al . studied a specialized classification problem on heterogeneous networks , where different types of nodes share a same set of label concepts [ 13 ] . [ 18 , 16 ] studied collective classification problem in heterogeneous information networks .
In Table 5 we reviewed the datasets used in previous works on network classification . It shows that among all datasets ,
SLAP dataset is one of the best choices for studying multilabel classification in heterogeneous information networks .
6 . CONCLUSION
In this paper , we studied how to exploit heterogeneous information networks for multi label collective classification . Conventional multi label learning approaches usually assume that the label correlations are either given or can be derived directly from data samples by counting their co occurrences . We proposed to use heterogeneous information networks to facilitate the learning process of multi label classification by mining label correlations and instance correlations from the network . We propose a novel solution to multi label classification , called PIPL by exploiting complex linkage information in heterogeneous information networks . Empirical
500100015002000250030003500400045005000030034038Number of featuresMicro−F1 BSVMECCPISLPIMLPIPLICML40060080010001200140016001800200022002400045050055060065070Number of featuresMicro−F1 BSVMECCPISLPIMLPIPL621 studies on real world tasks demonstrate that the proposed multi label classification approach can effectively boost classification performances .
7 . ACKNOWLEDGEMENTS
This work is supported in part by NSF through grants IIS 0905215 , CNS 1115234 , IIS 0914934 , DBI 0960443 , and OISE 1129076 , US Department of Army through grant W911NF12 1 0066 , and Huawei grant .
8 . REFERENCES [ 1 ] http://wwwimdbcom [ 2 ] M . R . Boutell , J . Luo , X . Shen , and C . M . Brown .
Learning multi label scene classification . Pattern Recognition , 37(9):1757–1771 , 2004 .
[ 3 ] C C Chang and C J Lin . LIBSVM : a library for support vector machines , 2001 . Software available at http://wwwcsientuedutw/~cjlin/libsvm
[ 4 ] B . Chen , Y . Ding , and D . Wild . Assessing drug target association using semantic linked data . PLoS Comput Biology , 8(7 ) , 2012 .
[ 5 ] G . Chen , Y . Song , F . Wang , and C . Zhang .
Semi supervised multi label learning by solving a sylvester equation . In SDM , 2008 .
[ 6 ] W . Cheng and E . H¨ullermeier . Combining instance based learning and logistic regression for multilabel classification . Machine Learning , 76(2 3):211–225 , 2009 .
[ 7 ] M . Craven , D . DiPasquo , D . Freitag , A . McCallum , T . Mitchell , K . Nigam , and S . Slattery . Learning to extract symbolic knowledge from the world wide web . In AAAI , 1998 .
[ 8 ] K . Dembczy´nski , W . Cheng , and E . H¨ullermeier .
Bayes optimal multilabel classification via probabilistic classifier chains . In ICML , 2010 .
[ 9 ] A . Elisseeff and J . Weston . A kernel method for multi labelled classification . In NIPS . 2002 .
[ 18 ] X . Kong , P . Yu , Y . Ding , and D . Wild . Meta path based collective classification in heterogeneous information networks . In CIKM , 2012 .
[ 19 ] X . Kong and P . S . Yu . Multi label feature selection for graph classification . In ICDM , 2010 .
[ 20 ] N . Lao and W . Cohen . Relational retrieval using a combination of path constrained random walks . Machine Learning , 81(2):53–67 , 2010 .
[ 21 ] Y . Liu , R . Jin , and L . Yang . Semi supervised multi label learning by constrained non negative matrix factorization . In AAAI , 2006 .
[ 22 ] Q . Lu and L . Getoor . Link based classification . In
ICML , 2003 .
[ 23 ] A . McCallum , K . Nigam , J . Rennie , and K . Seymore . Building domain specific search engines with machine learning techniques . In AAAI Spring Symposium on Intelligent Agents in Cyberspace 1999 , 1999 .
[ 24 ] J . Neville , O . Simsek , D . Jensen , J . Komoroske ,
K . Palmer , and H . Goldberg . Using relational knowledge discovery to prevent securities fraud . In KDD , 2005 .
[ 25 ] S . Peters , Y . Jacob , L . Denoyer , and P . Gallinari . Iterative multi label multi relational classification algorithm for complex social networks . Social Network Analysis and Mining , 2:17–29 , 2012 .
[ 26 ] J . Read , B . Pfahringer , and G . Holmes . Multi label classification using ensembles of pruned sets . In ICDM , 2008 .
[ 27 ] J . Read , B . Pfahringer , G . Holmes , and E . Frank .
Classifier chains for multi label classification . In ECML PKDD , 2009 .
[ 28 ] Y . Sun , J . Han , X . Yan , P . Yu , and T . Wu . PathSim :
Meta path based top k similarity search in heterogeneous information networks . In VLDB , 2011 .
[ 29 ] Y . Sun , J . Han , P . Zhao , Z . Yin , H . Cheng , and
T . Wu . Rankclus : Integrating clustering with ranking for heterogeneous information network analysis . In EDBT , 2009 .
[ 10 ] N . Ghamrawi and A . McCallum . Collective multi label
[ 30 ] Y . Sun , B . Norick , J . Han , X . Yan , P . Yu , and X . Yu . classification . In CIKM , 2005 .
[ 11 ] S . Godbole and S . Sarawagi . Discriminative methods for multi labeled classification . In PAKDD , 2004 .
[ 12 ] W . Indyk , T . Kajdanowicz , and P . Kazienko .
Relational large scale multi label classification method for video categorization . Multimedia Tools and Applications , 2012 .
[ 13 ] M . Ji , J . Han , and M . Danilevsky . Ranking based classification of heterogeneous information networks . In KDD , 2011 .
[ 14 ] F . Kang , R . Jin , and R . Sukthankar . Correlated label propagation with application to multi label learning . In CVPR , 2006 .
[ 15 ] H . Kazawa , T . Izumitani , H . Taira , and E . Maeda .
Maximal margin labeling for multi topic text categorization . In NIPS . 2005 .
[ 16 ] X . Kong , B . Cao , P . Yu , Y . Ding , and D . Wild . Meta path based collective classification in heterogeneous information networks . CoRR , 2013 .
[ 17 ] X . Kong , X . Shi , and P . Yu . Multi label collective classification . In SDM , 2011 .
Integrating meta path selection with user guided object clustering in heterogeneous information networks . In KDD , 2012 .
[ 31 ] Y . Sun , Y . S . Yu , and J . Han . Ranking based clustering of heterogeneous information networks with star network schema . In KDD , pages 797–806 , 2009 . [ 32 ] G . Tsoumakas and I . Vlahavas . Random k labelsets : An ensemble method for multilabel classification . In ECML PKDD , 2007 .
[ 33 ] N . Ueda and K . Saito . Parametric mixture models for multi labeled text . In NIPS . 2003 .
[ 34 ] X . Xiang and J . Neville . Pseudolikelihood em for within network relational learning . In ICDM , 2008 . [ 35 ] M L Zhang and K . Zhang . Multi label learning by exploiting label dependency . In KDD , 2010 .
[ 36 ] M L Zhang and Z H Zhou . Ml knn : A lazy learning approach to multi label learning . Pattern Recognition , 40(7):2038–2048 , 2007 .
[ 37 ] X . Zhang , Q . Yuan , S . Zhao , W . Fan , W . Zheng , and
Z . Wang . Multi label classification without the multi label cost . In SDM , 2010 .
622
