Inferring Latent Triggers of Purchases with Consideration of Social Effects and Media
Advertisements
Yusuke Tanakafi , Takeshi Kurashimafi , Yasuhiro Fujiwaray , Tomoharu Iwataz , Hiroshi Sawadafi fiNTT Service Evolution Laboratories , yNTT Software Innovation Center zNTT Communication Science Laboratories fi1 1 Hikari no oka , Yokosuka Shi , Kanagawa , 239 0847 Japan y3 9 11 Midori cho , Musashino shi , Tokyo , 180 8585 Japan z2 4 Hikaridai , Seika Cho , Soraku gun , Kyoto , 619 0237 Japan
{tanaka.y , kurashima.takeshi , fujiwara.yasuhiro , iwata.tomoharu , sawadahiroshi}@labnttcojp
ABSTRACT This paper proposes a method for inferring from singlesource data the factors that trigger purchases . Here , singlesource data are the histories of item purchases and media advertisement views for each individual . We assume a sequence of purchase events to be a stochastic process incorporating the following three factors : ( a ) user preference , ( b ) social effects received from other users , and ( c ) media advertising effects . As our user purchase model incorporates the latent relationships between users and advertisers , it can infer the latent triggers of purchases . Experiments on real single source data show that our model can ( a ) achieve high prediction accuracy for purchases , ( b ) discover the key information , ie , popular items , influential users , and influential advertisers , ( c ) estimate the relative impact of the three factors on purchases , and ( d ) find user segments according to the estimated factors .
Categories and Subject Descriptors H28 [ Database Management ] : Database Application| Data Mining
Keywords Single source data ; Purchase behavior ; Marked point processes
1 .
INTRODUCTION
Recent advances in information technology have increased our exposure to information in daily life . Users are exposed to so much information through web browsing , TV watching , and the use of social media , and make decisions ( ie , purchase an item ) based on the information . For example , users may purchase items recommended by their friends and may also purchase items promoted by TV advertisements . Marketers are interested in analyzing the impact of such information on purchase behavior , because it provides useful knowledge for optimizing advertising strategies [ 14 ] and viral marketing [ 3 , 10 ] .
In order to evaluate the effectiveness of their advertising strategies , marketing research companies continue to collect time series data of item purchases and advertisement views for each user . Histories of purchase and view events are collected from ‘single sources’ ( ie , individual users ) , so this data is called ‘single source data’ . In the field of marketing science , many methods have been proposed for estimating media advertising effects by analyzing single source data [ 11 , 23 , 24 ] . Most of these methods assume that a user ’s purchase behavior is triggered by only advertisements . This assumption , however , looks outdated . With the development of the web and social media , it is becoming increasingly important to consider social effects such as recommendations by other users . The previous methods are difficult to accurately evaluate the advertising effects since they ignore social effects . The purpose of this paper is to estimate the factors that trigger purchases and discover useful knowledge for marketers in single source data . This is , however , quite challenging to accomplish , mainly because event order and timing do not always show a direct causality . For example , a user watching an ad on TV may not become immediately keen to buy right away . Likewise , a latest recommendation by other users does not always trigger an immediate purchase . Furthermore , a purchase can occur independently of these external factors , ie , item purchases can be driven by user preference .
In order to effectively detect the causes of purchases , we focus on the strength of relationships between users and advertisers . This is because how strongly an advertiser influences a user depends on the relationship between them . For example , familiar users , such as friends or family , have a stronger impact than strangers . Likewise , a familiar company ’s ad on TV has a stronger impact on the user’ willingness to buy than an unfamiliar company ’s ad . Given the above , we develop a new probabilistic model for inferring the factors that trigger purchases from single source data . The model incorporates three factors : ( a ) user preference , ( b ) social effects received from other users , and ( c ) media advertising effects . We model users’ willingness to buy over
543 time by incorporating the latent relationships between users and advertisers . By using efficient Bayesian inference based on the stochastic EM algorithm [ 5 ] , we can obtain the latent triggers for purchases . Our model can estimate not only media advertising effects but also social effects and user preferences for each purchase event . Therefore , we can also evaluate the relative impact of the three factors on purchases for each user . The estimated impact of advertising is useful for marketers . For example , when marketers want to evaluate advertising strategies for a product that has been sold before , our model can show to what extent the advertisements were responsible for the purchases of the product . In addition , our model can discover users who are likely to be influenced by media advertisement from the estimated latent triggers ; we can expect high advertising effectiveness by targeting these users through advertising management . Furthermore , we can find influential users that trigger chainreaction purchases from the estimated relationships between users ; we can expect higher sales by targeting the influential users in viral marketing .
We demonstrate the effectiveness of the proposed model by using real single source data , the histories of item purchases and TV advertisement views by individuals . We evaluate the validity of our proposed model in terms of its accuracy in predicting purchases . In addition , we show three practical uses of our model by demonstrating that the model can actually extract the useful knowledge to marketers . First , we show that our model can discover key information , ie , poplar items , influential users and influential advertisers . This knowledge is helpful in optimizing the marketing strategies . Second , we demonstrate that our model can infer the impact of factors that trigger purchases . When marketers want to evaluate their advertising strategies for a product , we can estimate how many purchases were triggered by their advertisements . Third , we show that our model can find user segments based on their consumption behavior . This can suggest better approaches to activating the users .
This paper is organized as follows : Section 2 outlines related work . Section 3 describe the details of the single source data used . In Section 4 , we construct the proposed model with its three factors and present a Bayesian inference procedure to infer the latent triggers for purchases . Section 5 demonstrates the effectiveness of the proposed model by using real single source data . Finally , we present our conclusions in Section 6 .
2 . RELATED WORK
Many statistical methods have been studied for analyzing the social effects among users given a social network structure [ 1 , 27 ] . These methods are often used for viral marketing [ 3 , 10 , 15 ] and ranking influential users [ 21 ] . However , in many online social media , it is difficult to directly obtain the strength of relationships between users . Thus , estimating the influences among users from their activities is an important research topic .
Influences among users are often inferred by using information diffusion models , and a number of such models have recently been proposed for inferring the influences between users without prior knowledge ( eg , users’ network structure ) based on maximum likelihood [ 8 , 13 , 16 ] . A key restrictive assumption in these methods is that a user selects an item only once in the item selection sequence . More flexible models have been proposed [ 5 , 19 ] based on a point process framework . Point processes [ 20 ] are stochastic processes for modeling event occurrence over time . We can use marked point processes [ 9 ] to model the occurrence of an augmented event that is the pair of time and another random element ( eg , user ) . Cascade Poisson process [ 19 ] models event sequences of item selection based on marked point processes . Shared cascade Poisson process ( SCPP ) [ 5 ] is an extension of cascade Poisson process . SCPP can infer the latent influences between users in online social communities from the selection sequences of multiple items . SCPP does not consider the media advertising effects , which is important for modeling purchase behavior . The proposed model is an extension of SCPP , and can estimate the effect that each factor has in triggering purchases by simultaneously analyzing not only purchase events but also advertisement view events . Therefore , our model can estimate and evaluate the impact of media advertising . Furthermore , our model can capture the social effects and each user ’s preference more precisely . In the field of marketing science , many methods have been proposed for analyzing the impact of media advertising . Most of the methods estimate how effective media advertisements are in triggering purchases in the overall market [ 11 , 23 ] . These methods , unfortunately , cannot evaluate the advertising effects for each user , and cannot also estimate social effects and user preferences . Based on single source data , Terui et al . [ 24 ] proposed a model that can analyze the advertising effects for each user by modeling advertising stock : the cumulative effects of media advertising . In online advertising , Rosales et al . [ 17 ] proposed a model for analyzing the advertiser ’s attributes ( eg , ad type , campaign , etc . ) that can be expected to contribute to users’ conversion actions such as adding an item to the shopping cart and making a purchase . However , these methods assume that purchases are triggered only by media advertisements . The proposed model includes three factors . Different from previous methods , our model can estimate the impact of media advertising except for the possible effects of other factors .
A few methods consider both social and advertising effects when estimating the factors that trigger purchases , similar to our method [ 4 , 22 ] . However , since these models treat social and advertising effects as one factor , they do not evaluate the impact of each factor for each user ; these models do not estimate whose recommendation or which advertisement triggered a purchase . Therefore , these models cannot be used for finding , for each user , influential users , estimating user relationships , and inferring the impact of advertising .
3 . SINGLE SOURCE DATA
In this section , we describe the details of single source data , which are the histories of viewing a media ( TV , Web ) advertisement and purchase behavior over time for each singlesource ( ie , individual user ) . Single source data are collected by marketing research companies , such as TiVO Research Inc1 and INTAGE Inc2 , for the purpose of analyzing advertisement effects .
In our experiments , we used individual consumer panel research data ( SCI ) and INTAGE single source panel data ( i SSP ) collected by INTAGE Inc . Note that panels consist of users who agreed to provide detailed information on their
1http://wwwtivoresearchcom 2http://wwwintagecojp
544 Table 1 : Notations of single source data .
Symbol Description set of items I set of users U M set of advertisers item , i 2 I i user of the jth purchase event of item i , up up ij 2 U ij ij uv user of the kth view event of item i , uv advertiser of item i , mi 2 M ij mi tp time of the jth purchase event of item i ij tv time of the kth view event of TV advertisement ik of item i set of purchase events set of view events of TV advertisement observation period number of purchase events for item i in t 2 [ 0 ; T ] number of view events for item i in t 2 [ 0 ; T ]
D C T Ji Ki
2 U ij ; up ij ; up ij)gJi behavior over time . SCI records users’ purchase histories for daily shopping . On returning from a shopping , users enter their purchase information into an online data collection system . i SSP records users’ view histories for TV advertisements . The view histories are collected automatically using an in home recording device connected to household television sets .
Suppose that we have a set of purchase events D = fDigi2I , where I is a set of items . A purchase event sequence of item i consists of Ji events , Di = f(tp j=1 , in the time period from 0 to T . ( tp ij ) is the jth purchase event of item i , which represents that user up ij purchased item i at time tp ij . Without loss of generality , we assume that events are sorted by their timestamps , tp . We also have a set of events of viewing TV advertisements C = fC igi2I . An ij event sequence of viewing TV advertisements of item i consists of Ki events , C i = f(tv k=1 , in the time period from 0 to T . ( tv ik ) is the kth view events of TV advertisements of item i , which represents that user uv ik viewed a TV advertisement of item i at time tv ik . Similar to purchase data , we can assume that events are sorted by their timestamps , tv . Note that the set of users U is ik common between purchases and views . Additionally , each item has information that represents advertiser mi 2 M who promotes item i , where M is a set of advertisers . The notations used in this paper are listed in Table 1 . ik′ , for k < k ij′ , for j < j ik)gKi tp tv ik ; uv ik ; uv
′
′
4 . MODEL 4.1 Proposed Model
We propose a new probabilistic model for inferring the latent triggers for purchases from single source data . In the proposed model , a sequence of purchase events is assumed to be generated from marked point processes [ 9 ] . They are stochastic processes for modeling the occurrence of purchase events for each item , where an event represents a pair of time and user ( t ; u ) . The marked point processes are governed by a non negative purchase rate , i(t ; u ) . i(t ; u ) is the instantaneous probability of user u purchasing item i at time t . We model the purchase rate based on the following three factors : ( a ) user preference , ( b ) social effects received
Figure 1 : Plot of purchase rate of item i by user u according to our model . ( a ) Purchase rate based on user preference . ( b ) Purchase rate based on social effects received from other users . ( c ) Purchase rate based on TV advertising effects . ( d ) Purchase rate based on the three factors given the preceding purchase/view events .
′ from other users , and ( c ) media advertising effects . First , let fi(u ) be the purchase rate based on user preferences , it represents how strongly user u wants to buy item i . Second , let g(i;t′;u′)(t ; u ) be the purchase rate of user u purchasing item ′ i at time t influenced by the event in which user u purchased . Third , let h(i;t′;mi)(t ; u ) be the purchase item i at time t rate of user u purchasing item i at time t influenced by the event that user u viewed a TV advertisement of item i at time t . Details of each purchase rate are given in the following paragraphs . We have the following assumptions with regard to a user ’s purchase based on each purchase rate : a user ’s purchase can be triggered by ( a ) her/his preferences , ( b ) preceding purchase events by other users , and ( c ) preceding view events of TV advertisements . By combining the three factors , we can obtain the purchase rate based on these factors , i(t ; u ) , as follows :
′
∑ i(t ; u ) = fi(u )
+
( t′;u′)2Ditnu
∑ g(i;t′;u′)(t ; u ) + h(i;t′;mi)(t ; u ) ;
( t′;u′)2Citu
′
( 1 ) < t ^ u where Ditnu = f(t ′ ̸= ug is ; u the set of purchase events before time t excluding user u ’s = u g < t ^ u ones , and C itu = f(t ′ ′ ′ is the set of view events of user u before time t .
) 2 Di and t ) 2 C i and t ′
; u )j(t ′
)j(t ′
; u
; u
′
′
′
′
( a ) Purchase rate based on user preferences . We assume that each user has a different preference for each item . As described in Figure 1(a ) , we also assume that purchase rate based on user preferences is constant in the time period from 0 to T . This non negative constant rate is called the \background rate" in the point processes framework [ 20 ] .
TimeTimeTimeTimeRateRateRateRate(a ) User preference(b ) Social effects(c ) TV advertisement effects(d ) Total effects0T000TTTt545 The purchase rate at which user u purchases item i based on personal preference is as follows :
Table 2 : Parameters of the proposed model
( 3 )
< t
′ if t otherwise : ′
∑ fi(u ) = ffiϕiu :
( 2 ) Here , ffi 0 is the rate at which item i is purchased without being triggered by the preceding events . ffi represents the general popularity of item i ; a high popularity suggests many purchases are made without being triggered by other users or TV advertisements . ϕiu 0 is the probability that a user u2U ϕiu = 1 . who purchases item i is in fact user u , where If user u prefers item i more strongly than other users , ϕiu becomes large .
∑
( b ) Purchase rate based on the social effects received from other users . We assume that a purchase event can be triggered by the preceding purchase events of other users . For example , users are apt to purchase the same item purchased by their friends . We also assume that the influences of other users depend on the user and decays over time . For example , the effects of familiar users , such as friends or family , are larger than those of strangers . Furthermore , this decay over time is a natural assumption because trends evolve or change and is often used when modeling information diffusion processes between users [ 8 , 13 , 16 ] . We model the purchase rate at which user u purchases item i at time t influenced by the event that user u purchased item i at time t as follows :
′
′
{ g(i;t′;u′)(t ; u ) =
′ ,flp(t,t
) ffu′ u′ue 0
′
′ on other to user u , where
Here , ffu′ 0 represents the influence of user u users . The second factor u′u 0 represents the strength of u2Unu′ u′u = 1 . the relation from user u Note that U n u represents the result of the procedures that ′ from set U . The product of these factors , exclude user u ′ ffu′ u′u , corresponds to the influence from user u to user ) models decay of the influu . The third factor e ence over time with parameter flp 0 . Since an event does not influence on past events , the purchase rate is zero when ′ t . Figure 1(b ) illustrates the temporal dynamics of sot cial effects received from other users , where the colored part represents the social effects of each user .
′ ,flp(t,t
( c ) Purchase rate based on TV advertising effects . We assume that a user ’s purchases can be triggered by the preceding view events . We also assume that the influences of advertiser depend on the user and decay over time . For example , a familiar company ’s ad on TV has a stronger effect than those of unfamiliar advertisers . We model the purchase rate that user u purchases item i at time t influenced by the event that user u views an advertisement of item i at time ′ t as follows :
{ ffmi !miue 0
′ ,flv(t,t
)
′
< t if t otherwise :
( 4 ) h(i;t′;mi)(t ; u ) =
Note that TV advertising effects are directed from adver0 tiser mi to user u unlike the effects between users . ffmi ∑ is the influence of advertiser mi on the users through TV advertisements . The second factor !miu 0 represents the strength of the relation from advertiser mi to user u , where u2U !miu = 1 . The product of these factors , ffmi !miu , corresponds to the effects of ads from advertiser mi to user ) , models the decay of the influu . The third factor , e ence over time using parameter flv 0 . Advertising effects
′ ,flv(t,t
Symbol Description ffi ffu ffm ϕiu popularity of item i , ffi 0 influence of user u , ffu 0 influence of advertiser m , ffm 0 preference of user u to item i ϕiu 0 ; ′ strength of relation from user u u′u 0 ; strength of relation from advertiser m to user u !mu 0 ; decay parameter , flp 0 , flv 0
∑ ∑ ∑ u2Unu′ u′u = 1 u2U !mu = 1 u2U ϕiu = 1 to user u u′u
!mu flp ; flv are often modeled by using an exponential pattern , called carryover effects , in marketing science [ 2 , 23 ] . Figure 1(c ) illustrates the temporal dynamics of TV advertising effects . By substituting ( 2) (4 ) into ( 1 ) , we can obtain purchase rate based on the three factors whose temporal dynamics are illustrated in Figure 1(d ) . Parameters of the proposed model are summarized in Table 2 : popularity of each item , fffigi2I , influence of each user , fffugu2U , influence of each advertiser , fffmgm2M , relationship between users , . = fugu2U , u = fuu′gu′2Unu , relationship between user and advertiser , Ω = f!mgm2M , !m = f!mugu2U , user preferences gi2I , ϕi = fϕiugu2U , and parameters of to items , ( = fϕi influence decay over time , fl = fflp ; flvg . 4.2
Inference
Given purchase events D and view events C , we infer the model parameters shown in Table 2 . For this , we employ the stochastic EM algorithm , in which newly introduced latent variables Z are sampled in the E step and model parameter fl are optimized in the M step as described in Section 421
Other model parameters ff = ffflgl2U[M[I , . , Ω , ( are integrated out in the stochastic EM algorithm , and their point estimates are obtained as shown in Section 422 421 Inferring latent triggers via stochastic EM al gorithm
We assume that a set of purchase events Di is generated from a marked point process with rate i(t ; u ) . Given the multiple purchase event sequences D = fDigi2I , the likeli hood function of D is described as follows :
∑ P ( DjC ; ff ; . ; Ω ; ( ; fl )
∏
T
∫
(
,
)
Ji∏ exp
= i2I i(t ; u)dt
0 u2U j=1 i(tp ij ; up ij ) ;
( 5 ) where the exponential factor of ( 5 ) represents the probability of no purchase events occurring in the time period from 0 to T . Here , we can analytically calculate the integral as follows :
∫
∑
T
(
Ji∑ ( Ki∑ 1 , e ffuij j=1
1 flp k=1
)
1 , e
,flp(T,tp ij )
)
,flv(T,tv ik )
:
( 6 ) i(t ; u)dt =ffiT +
0 u2U
+ ffmi flv
546 ∫ distribution : P ( D ; ZjC ; fl ; fi ; a ; b )
=
∑
∑
P ( D ; ZjC ; ff ; . ; Ω ; ( ; fl)P ( ffja ; b)P ( .jfi1 ) 1A 0@ , . P ( Ωjfi2)P ( (jfi3)dffd.dΩd( ∏ , tizij ) / exp ∏ ) ∏ ∏ ( Lm + fi2jUj ) ( i2I ∏ u2Unu′ ,(Lu′u + fi1 ) ∏ ∏ Lu′ + fi1(jUj , 1 ) u2U ,(Liu + fi3 ) ,(Li + fi3jUj )
,(Ll + a ) ( Rl + b)Ll+a ; u2U ,(Lmu + fi2 ) ,
( dizij )(tp j:zij̸=0 m2M u′2U
,
.
. ij l2U[M[I i2I
{
( 9 )
( 10 ) where
( dizij ) = flp flv if dizij if dizij
2 U 2 M ;
∑ ∑
∑ ∑
′ i2I
Ji j=1 ffi(dizij ; u and we define the set of only time information for either purchase events or view events as ftij;jj = 1 ; : : : ; Nitug . ∑ Here , Lu′u = )ffi(uij ; u ) is the num′ and Lu′ = ber of events for user u triggered by user u u2Unu′ Lu′u is the total number of events triggered by ′ ∑ , where ffi(x ; y ) = 1 if x = y , and ffi(x ; y ) = 0 otheruser u Ki k=1 ffi(dizik ; m)ffi(uik ; u ) is the number wise . Lmu = of events for user u triggered by advertiser m and Lm = u2U Lmu is the total number of events triggered by adverJi tiser m . Furthermore , Liu = j=1 ffi(uij ; u)ffi(zij ; 0 ) is the number of events in which the user who purchased item i Ji based on preference was in fact user u and Li = j=1 ffi(zij ; 0 ) is the number of purchase events of item i triggered by user preferences . Additionally ,
∑
∑ i2I
8>><>> : T
1 flp
1 flv
∑ ∑ t2Dl t2Cl
( ( 1 , e 1 , e
Rl =
) )
,flp(T,t ) ,flv(T,t ) if l 2 I if l 2 U if l 2 M ;
( 11 ) where Dl is a set of timestamps of purchase events of user l . C l is a set of times when advertiser l broadcast a TV ad , noting that C l is not the set of times of view events .
Based on ( 9 ) , we present a stochastic EM algorithm for the inference . In the E step , a new value for zij is sampled from the following probability :
P ( zij = yjD ; Znij ; C ; fl ; fi ; a ; b )
/ P ( D ; Znij ; zij = yjC ; fl ; fi ; a ; b ) P ( Dnij ; ZnijjC ; fl ; fi ; a ; b )
( 12 ) where y 2 f0 ; 1 ; : : : ; Nitug , subscript nij represents the procedure that excludes the jth event of item i . Based on the procedure of Gibbs sampling , zij for all i and j are sampled sequentially .
;
In the M step , we estimate the decay parameters fl and Dirichlet parameter fi . Given Z , updated in the E step , these parameters are estimated by maximizing the logarithm of the joint likelihood ( 9 ) . We estimate fl and fi using Newton ’s method and the fixed point iteration method [ 12 ] , respectively . By iterating the E step and M step until convergence , we can estimate latent variables Z , decay parameters fl and Dirichlet parameters fi .
8< : fi(u )
Figure 2 : Candidate event set of latent triggers ; preceding purchase/view events of item i before time t for user u .
By the superposition theorem of point processes [ 20 ] , the point processes with the recursive rates , i(t ; u ) ( 1 ) , can be decomposed into independent point processes with each rate . We use this theorem to simplify the inference without changing the model . We define the candidate set of latent triggers as Ditnu [ C itu , which is the set of preceding events of item i before time t . Figure 2 shows the candidate set of latent triggers , where Nitu is the number of events in the candidate set . We introduce latent variable zij 2 f0 ; : : : ; Nitug to indicate the index of latent trigger event of the jth event of item i , where zij = 0 indicates that the event was triggered by the purchase rate based on user preferences . By using latent variable z , the purchase rate ( 1 ) can be written z i(t ; u ; z ) , where the augmented purchase as i(t ; u ) = rate is as follows :
∑ i(t ; u ; z ) = g(i;tiz ;diz )(t ; u ) h(i;tiz ;diz )(t ; u ) if z = 0 if z ̸= 0 ^ diz 2 U if z ̸= 0 ^ diz 2 M ;
( 7 )
,flp(T,tp ij ) where diz 2 U [ M is a dummy variable ; diz = uiz if the event indicated by zij is a purchase event , and diz = mi if the event is a view event .
Combining ( 5 ) , ( 6 ) and ( 7 ) , we obtain the joint distribution of observed purchase events D and latent variables Z = ffzijgJi Ji∑ ∏ P ( D ; ZjC ; ff ; . ; Ω ; ( ; fl )
) j=1
= exp i2I
1 flp ffiT + gi2I , [ ( Ki∑ 1 , e P ( . ) /∏ ∏ and P ( ( ) /∏ ∏ u′2Unu fi1,1 uu′ u2U ϕfi3,1 i2I
,flv(T,tv ffmi flv k=1 j=1
+ ik ) ffuij
( 1 , e ) ] Ji∏ , P ( Ω ) /∏ j=1 iu mu u2U m2M
We use the following Dirichlet priors over u , !m and ϕi as : u2U !fi2,1 . Here , fi = ffi1 ; fi2 ; fi3g are hyperparameters , each of which is estimated by using the fixed point iteration method described in [ 12 ] . Furthermore , we use the following Gamma priors over ffl , l 2 U[M[I as : P ( ffl ) / ffa,1 exp(,bffl ) , where a and b are hyperparameters and in this paper we set a = b = 1 , which is equivalent to an exponential distribution with mean of 1 . With the help of the conjugacy of the priors , the marginalization can be calculated analytically over the parameters . Integrating out the parameters gives the following marginalized joint l i(tp ij ; up ij ; zij ) :
( 8 )
∏
TimeTimeTime…Purchase events by other usersView events by oneselfCandidate events of latent trigger547 ^ϕiu =
Liu + fi3 Lu + fi3jUj ;
( 19 )
L1 =
422 Point estimates of integrated out parameters If we obtain Z , fl and fi from the above procedure , we can obtain point estimates of the integrated out parameters by using maximum posteriori given Z . The posteriors for these parameters are given by
P ( ffljD ; Z ; fl ; a ; b ) = Gamma(Ll + a ; Rl + b ) ; ( 13 ) ( 14 )
P ( ujD ; Z ; fi1 ) = Dirichlet(Lu′u + fi1 ) ; P ( !mjD ; Z ; fi2 ) = Dirichlet(Lmu + fi2 ) ; jD ; Z ; fi3 ) = Dirichlet(Liu + fi3 ) : P ( ϕi The point estimates of the parameters are given by
( 15 )
( 16 )
( 17 )
^ffl =
Ll + a Rl + b
; which can be used for finding popular items , influential users , and influential advertisers , and
^u′u =
Lu′u + fi1
Lu′ + fi1jU , 1j ;
^!mu =
Lmu + fi2 Lm + fi2jMj ;
( 18 ) which can be used for analyzing the relationships between users and advertisers , and which can be used for analyzing user preferences to items .
5 . EXPERIMENTS
In this section , we show the effectiveness of the proposed model by conducting quantitative evaluations on real singlesource data in Section 51 We also conducted the qualitative evaluations in accordance with the three practical uses by analyzing the estimated model parameters in Section 52 5.1 Quantitative Evaluation
The purpose of this quantitative evaluation is to validate the proposed model in terms of its prediction accuracy . This leads to increase confidence in the knowledge about the purchase behaviors indicated by the estimated parameters of our model . We note that predictive performance is the most commonly used measure for evaluating the appropriateness of a learned model [ 5 , 6 ] .
We used real single source data that are the histories of purchase and view events of TV advertisements in daily life gathered over 52 weeks ( January 1 , 2013 { December 31 , 2013)3 . The data sets consist of three categories : Canned Coffee , Beer and Soft Drink . For each data set , we prepared 3 different training and test data splits by changing the test months : August , October and December . For example , if the model was evaluated using purchase events in August as test data , the model was trained using the purchase/view events in the period from January to July as training data . Note that we omitted users who bought less than five items during the training period . In our experiments , each event timestamp is measured in days . Details of the data sets used in our experiments are shown in Table 3 .
We compared the proposed model with shared cascade Poisson processes ( SCPP ) [ 5 ] . SCPP considers only social effects in calculating the purchase rate . The social ef
3We used individual consumer panel research data ( SCI ) and INTAGE single source panel ( i SSP ) collected by INTAGE Inc .
Table 3 : Statistics of the data sets
Data Set #purchases #views #users #advertisers #items
Canned Coffee 51,120 102,480 743 11 40
Beer 54,830 339,331 1,135 7 36
Soft Drink 140,999 598,121 2,108 19 75 fects are determined from the estimated influences between users . In addition , we compared our model with the homogeneous Poisson process ( PP ) [ 20 ] as a baseline method . PP is a stochastic process for modeling event occurrence with a constant rate . In experiments we used the purchase rate described in ( 2 ) for the baseline method ; the baseline method assumes that each user makes a decision based only on her/his preferences . The predictive performance is evaluated by the negative logarithm of the likelihood for purchase events ( t ; u ) in the test period , T to T
, as follows :
′
) ∑
( ∑
∫
,
∑
′
T i2I
T u2U i(t ; u)dt log i(t ; u ) ;
( t;u)2Dtest i i
( 20 ) where Dtest is the test data for item i . When the value of L1 is small , the predictive performance is high . Figure 3 shows the results for each data set . \Proposed" in the figure indicate the results of our model . In this figure , the X axis plots test month and the Y axis plots the negative logarithm of the test likelihood , and the method marked by asterisk ( fi ) achieves the best performance . Figure 3 shows that , regardless of test month , our model matched or bettered the predictive performance of the alternatives . Since the proposed model considers three key factors , it can appropriately predict the user ’s purchase behavior . SCPP yielded slightly better predictive performance in only one experimental setting ( category = Soft Drink , test month = August ) . However , SCPP cannot estimate the media advertising effects , in which many marketers are interested .
To show the validity of our model , we also compared it with the most commonly used methods for predicting user behavior . Non negative tensor factorization ( NTF ) can analyze the temporal patterns of user purchase behavior [ 18 ] . This method has been applied and performs well in practical applications such as recommender systems [ 6 ] . In experiments , we constructed a three dimensional array , called tensor , which consists of user , item and time . In addition , we compared our model with a multinomial distribution as a baseline method . Since multinomial model predicts the chosen items based only on each user ’s purchase history , it always suggests the most chosen items in the past . These comparative methods cannot predict when a user will purchase an item , different from PP , SCPP , and our proposed model . Thus we compared our model with multinomial model and NTF in terms of the predictive performance of each user ’s item selection at the time when she made the decision . We evaluated the predictive performance by the negative logarithm of the likelihood for user u in the test period as follows :
∑
∑ log i(t ; u ) ;
( 21 )
L2 = i2I
( t;u)2Dtest i
548 Figure 3 : Comparisons of negative logarithm of the likelihood for purchase events ( t ; u ) in the test period .
Figure 4 : Comparisons of negative logarithm of the likelihood for user u given purchase time t in the test period . where
∑ i(t ; u ) = i(t ; u ) u′2U i(t ; u′ )
;
( 22 ) is the rate normalized so that the total summation is 1 . L2 has a small score if predictive performance is high . Figure 4 shows the results . For each data set and test month , the proposed model performed better than the other methods . These results indicate that our model has excellent ability to predict user purchase behavior unlike the most commonly used methods .
5.2 Qualitative Evaluation
The parameters learned by our model provide important insights into consumers’ behaviors . In this section , we show three practical uses of our model , and the model can actually extract the useful knowledge to marketers .
Discovering key information . By using the estimated parameters of our model , we can discover the key information , ie , popular items , influential users , and influential advertisers . Figure 5 shows the values of item popularity fffigi2I , user influence fffugu2U , and advertiser influence fffmgm2M estimated by the proposed model for Canned coffee data set . In this figure , items , users and advertisers are sorted by their parameter values . As shown , a few items , users and advertisers , have large values . This results suggest that a particular set of items is popular in Canned coffee market ( Figure 5(a) ) , a small set of influential users exist in this market ( Figure 5(b) ) , and a few companies have strong impact through their TV advertisements ( Figure 5(c) ) . These results are useful to marketers when they want to optimize marketing strategies . For example , discov ering popular items yields an opportunity to reduce advertising costs because these items are likely to be purchased even without social effect or advertising effect . Furthermore , marketers can expect the pervasive benefits by targeting the influential users in viral marketing . When marketers want to determine the optimal allocation of marketing resources , we can suggest that TV advertisements are effective for the influential advertisers identified by our model .
Evaluation of the factors that trigger purchases . By using the posterior distribution of latent variables in ( 12 ) , we can analyze the relative impact of the three factors that trigger purchases . Algorithm 1 shows the procedure of calculating the strengths of the three factors for jth purchase event of item i . The inputs are the posterior distribution and the set of dummy variables fdiygNitu y=1 as described in Section 42 Ef , Eg and Eh is the degree of user preferences , social effects , and TV advertising effects , respectively . Note that the sum of Ef , Eg and Eh equals 1 . Algorithm 1 calculated the degree of the three factors for each purchase event in the training period ( January 1 , 2013 { November 30 , 2013 ) . Table 4 shows the ratio of the three factors . The ratio of social effects was large for all data sets . This suggest that the influence of other users greatly impacts our purchase behavior in various categories . On the other hand , the ratio of TV advertising effects looks relatively small for all data sets . As described in a previous paper [ 25 ] , advertising effects can be classified into ( a ) direct effect and ( b ) intermediate effect . Direct effect leads to purchases in the near future , ie , short term . For example , a user purchases a new product immediately after viewing its TV ad . On the other hand , intermediate effect shapes the users’ beliefs and attitudes toward the brand , and so molds purchase intent over the
549 ( a ) Item popularity fffig i2I
( b ) User influence fffug u2U
( c ) Advertiser influence fffmg m2M
Figure 5 : Estimated item popularity ( a ) , user influence ( b ) , and advertiser influence ( c ) for Canned coffee data set . Items , users , and advertisers are sorted by their parameter values . An advertiser , represented by the red point in Figure ( c ) , is the focus of the evaluation of the factors that trigger purchases .
Table 4 : The ratio of estimated factors ( % ) Soft Drink Data Set Preferences 8.6 89.8 Social effects TV ads effects 1.6
Canned Coffee Beer 9.6 89.0 1.4
8.3 89.3 2.4
Algorithm 1 Calculate degree of the three factors for the jth purchase event of item i . y=1
Require : P ( zijjD ; Znij ; C ; fl ; fi ; a ; b ) , fdiygNitu 1 : Ef P ( zij = 0jD ; Znij ; C ; fl ; fi ; a ; b ) 2 : Eg 0 3 : Eh 0 4 : y 1 5 : while y Nitu do if diy 2 U then 6 : Eg Eg + P ( zij = yjD ; Znij ; C ; fl ; fi ; a ; b ) 7 : 8 : Eh Eh + P ( zij = yjD ; Znij ; C ; fl ; fi ; a ; b ) 9 : end if 10 : y y + 1 11 : 12 : end while 13 : return Ef , Eg , Eh else long term . For example , exposure to TV ads makes a good impression on users , and leads to purchases in the future . Our model infers the direct advertising effect , not the intermediate effect . In our model , the intermediate effect is absorbed into either user preferences or social effects . Thus , the results in Table 4 indicate the direct ( short term ) effect of advertisements .
Next , we focus on an influential advertiser , and analyze the purchase trigger factors . The advertiser indicated by the red point in Figure 5(c ) is an influential advertiser in the Canned coffee data set . We focus on this advertiser in the following evaluation , because it actively launched new or renewed products in the training period . Figure 6 shows the estimated degrees of the three trigger factors for the influential advertiser in the Canned coffee data set . Note that we aggregated Ef , Eg and Eh for each purchase event per week , and this figure plots the total number of purchase events per week . The blue , red , and green bars indicate the number of events caused by the factors of user preferences , social effects , and TV advertising , respectively .
As shown in this figure , while the number of events triggered by user preferences did not so change over time , the amount of events caused by social and TV advertising effects changed over time . This suggests the existence of some popular items that sell well based on user preference regardless
Figure 6 : Estimated number of purchases triggered by each factor . This figure plots the total number of purchase events per week . The three colors represent the estimated strengths of the three trigger factors . of trends or TV advertisements . Furthermore , this result shows that TV ads had relatively large impact in the last quarter of the training period . In autumn and winter ( from October to March ) , some companies offer heated coffee cans and cold coffee cans in warm months ( from April to September ) . New and renewed products are often launched at the changeover points of the product type . Figures 7(a ) and ( b ) show the trigger factors of the renewed products , and Figure 7(c ) shows those of new products . These figures show that purchases of renewed products are triggered more often by user preference unlike new products ; purchases of new products are triggered more often by social and TV advertising effects . This is because users already have an attitude to the prior generation products and are willing to buy them regardless of social and TV advertising effects . In addition , the results indicate that advertisements for new products
550 ( a ) Renewed product 1
( b ) Renewed product 2
( c ) New product
Figure 7 : Estimated amount of purchases triggered by the three factors for new or renewed products . to respond strongly to the advertisements . For the users lying in the left corner , marketers should adopt an indirect approach through the users with which have a strong relationship ( eg , viral marketing ) since they are likely to be influenced by other users . Furthermore , users lying in the bottom right corner should be shown favorite products since they are not influenced by the other factors .
The users inside of circle A , B and C in Figure 8 are characterized by any two factors . For example , the users inside circle A in Figure 8 are influenced by both social and TV advertising effects . As shown , there are far fewer users inside circle B than A or C . The result proves that advertisements are ineffective for the user who buys items based on preference . For marketers , the user with high preference score is a highly attractive customer since she/he actively chooses items . The result also shows that marketing strategies based on social effects such as viral marketing are the most effective way of increasing the number of good customers .
6 . CONCLUSIONS
This paper proposed a probabilistic model for inferring the latent triggers from single source data . The model incorporates three factors : ( a ) user preference , ( b ) social effects received from other users , and ( c ) TV advertising effects . Based on marked point process framework , we modeled users’ willingness to buy over time through the incorporation of latent relationships between users and advertisers ; a clear advance over previous models . By using an efficient Bayesian inference approach based on the stochastic EM algorithm , we can obtain the latent purchase triggers .
We used real single source data to evaluate the effectiveness of the proposed model . We showed its validity in terms of its prediction accuracy . In addition , we showed three practical uses of our model , and the knowledge useful to marketers that the model can actually extract . First , our model can discover the key information , that is , popular items , influential users , and influential advertisers by using the estimated parameters . Second , our model can estimate the relative impact of each factor in triggering purchases . Experiments showed that when marketers want to evaluate advertising strategies for a product , the proposed model can suggest how many purchases were triggered by their advertisements . Finally , our model can find user segments based on their type of consumption behavior . As we demonstrated , the user segments can suggest better approaches to activating the users .
Figure 8 : Segmenting users based on estimated latent triggers leads directly to purchases , while advertisements for existing products ( eg , renewed product ) has little influence on purchase behavior . Our evaluation demonstrates that the proposed model can quantitatively evaluate the factors that trigger purchase behavior , a highly useful attribute for marketers . For example , when marketers want to evaluate their advertising strategies for a product , our model can evaluate how many purchases were triggered by the advertisements . Segmentation of users . For a marketer , user segmentation is an important step in optimizing advertising and recommendation strategies . Our proposed model can characterize each user by her/his type of consumption behavior . Figure 8 plots users on a 2 simplex for Canned coffee data set . In our model , users are characterized in terms of the three factors ( eg , preference , social and TV ads effects ) . We aggregated Ef , Eg and Eh for each user ’s purchase events into the three factors , and normalized their sum to 1 . Many users occupy a corner of the simplex , and few users lie on the center . The results suggest that many users can be assigned to one of three classes according to the factor that dominates their purchase decisions . This makes it easier for marketers to determine the advertising strategies . Marketers who want to advertise their products effectively should focus on users occupying the top corner of the simplex since they are likely
551 Our model is not limited to the single source data used in our experiments , but is widely applicable to any history of user behavior , for example , viewing web advertisements . Our future work includes extending our model to incorporate the effects of seasonal sales [ 7 ] and the relations among items [ 26 ] . These extensions are expected to improve the model ’s predictive performance .
7 . REFERENCES [ 1 ] E . Bakshy , J . M . Hofman , W . A . Mason , and D . J .
Watts . Everyone ’s an Influencer : Quantifying Influence on Twitter . In Proceedings of the 4th ACM International Conference on Web Search and Data Mining , pages 65{74 , 2011 .
[ 2 ] F . M . Bass and D . G . Clarke . Testing Distributed Lag
Models of Advertising Effect . Journal of Marketing Research , 9(3):298{308 , 1972 .
[ 3 ] P . Domingos . Mining Social Networks for Viral
Marketing . IEEE Intelligent Systems , 20:80{82 , 2005 .
[ 4 ] A . Ishii , H . Arakaki , N . Matsuda , S . Umemura , T .
Urushidani , N . Yamagata , and N . Yoshida . The ‘Hit’ Phenomenon : A Mathematical Model of Human Dynamics Interactions as A Stochastic Process . New Journal of Physics , 14 , 2012 .
[ 5 ] T . Iwata , A . Shah , and Z . Ghahramani . Discovering
Latent Influence in Online Social Activities via Shared Cascade Poisson Processes . In Proceedings of the 19th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining , pages 266{274 , 2013 .
[ 6 ] A . Karatzoglou , X . Amatriain , L . Baltrunas , and N . Oliver . Multiverse Recommendation : N Dimensional Tensor Factorization for Context Aware Collaborative Filtering . In Proceedings of the 4th ACM Conference on Recommender Systems , pages 79{86 , 2010 . [ 7 ] H . Kim , N . Takaya , and H . Sawada . Tracking Temporal Dynamics of Purchase Decisions via Hierarchical Time Rescaling Model . In Proceedings of the 23th ACM International Conference on Information and Knowledge Management , pages 1389{1398 , 2014 .
[ 8 ] T . Kurashima , T . Iwata , N . Takaya , and H . Sawada . Probabilistic Latent Network Visualization : Inferring and Embedding Diffusion Networks . In Proceedings of the 20th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining , pages 1236{1245 , 2014 .
[ 9 ] G . Last and A . Brandt . Marked Point Processes on the Real Line : The Dynamical Approach ( Probability and Its Applications ) . Springer , 1995 .
[ 10 ] J . Leskovec , L . A . Adamic , and B . A . Huberman . The
Dynamics of Viral Marketing . In Proceedings of the 7th ACM Conference on Electronic Commerce , pages 228{237 , 2006 .
[ 11 ] N . Mehta , X . Chen , O . Narasimhan . Informing ,
Transforming , and Persuading : Disentangling The Multiple Effects of Advertising on Brand Choice Decisions . Marketing Science , 27(3):334{355 , 2008 .
[ 12 ] T . Minka . Estimating A Dirichlet Distribution . 2000 . [ 13 ] S . A . Myers and J . Leskovec . On The Convexity of
Latent Social Network Inference . In Advances in
Neural Information Processing Systems , pages 1741{1749 , 2010 .
[ 14 ] P . A . Naik , K . Raman , and R . S . Winer . Planning
Marketing Mix Strategies in The Presence of Interaction Effects . Marketing Science , 24(1):25{34 , 2005 .
[ 15 ] M . Richardson and P . Domingos . Mining
Knowledge Sharing Sites for Viral Marketing . In Proceedings of the 8th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining , pages 61{70 , 2002 .
[ 16 ] M . Gomez Rodriguez , D . Balduzzi , and B . Scholkopf .
Uncovering The Temporal Dynamics of Diffusion Networks . In Proceedings of the 29th International Conference on Machine Learning , pages 561{568 , 2011 .
[ 17 ] R . Rosales , H . Cheng , and E . Manavoglu . Post Click
Conversion Modeling and Analysis for Non Guaranteed Delivery Display Advertising . In Proceedings of the 5th ACM International Conference on Web Search and Data Mining , pages 293{302 , 2012 .
[ 18 ] A . Shashua and T . Hazan . Non Negative Tensor Factorization with Applications to Statistics and Computer Vision . In Proceedings of the 22th International Conference on Machine Learning , pages 792{799 , 2005 .
[ 19 ] A . Simma and M . I . Jordan . Modeling Events with Cascades of Poisson Processes . In Proceedings of the 26th Conference on Uncertainty in Artificial Intelligence , pages 546{555 , 2010 .
[ 20 ] D . L . Snyder and M . I . Miller . Random Point Processes in Time and Space , Springer , 1991 .
[ 21 ] X . Song , Y . Chi , K . Hino , and B . L . Tseng .
Information Flow Modeling Based on Diffusion Rate for Prediction and Ranking . In Proceedings of the 16th International Conference on World Wide Web , pages 191{200 , 2007 .
[ 22 ] R . Takahashi , H . Mizuta , N . Abe , R . L . Kennedy , V .
J . Jeffs , R . Shah , and R . H . Crites . Collective Response Spike Prediction for Mutually Interacting Consumers . In IEEE 13th International Conference on Data Mining , pages 727{736 , 2013 .
[ 23 ] G . J . Tellis , R . K . Chandy , D . Macinnis , and P .
Thaivanich . Modeling The Microeffects of Television Advertising : Which Ad Works , When , Where , for How Long , and Why ? Marketing Science , 24(3):351{366 , 2005 .
[ 24 ] N . Terui , M . Ban , and G . M . Allenby . The Effect of
Media Advertising on Brand Consideration and Choice . Marketing Science , 30(1):74{91 , 2011 .
[ 25 ] D . Vakratsas and T . Ambler . How Advertising Works :
What Do We Really Know ? Journal of Marketing , 63(1):26{43 , 1999 .
[ 26 ] J . Wang and Y . Zhang . Opportunity Model for
E commerce Recommendation : Right Product ; Right Time . In Proceedings of the 36th International ACM SIGIR Conference on Research and Development in Information Retrieval , pages 303{312 , 2013 .
[ 27 ] D . J . Watts and P . S . Dodds . Influence , Networks , and
Public Opinion Formation . Journal of Consumer Research , 34:441{458 , 2007 .
552
