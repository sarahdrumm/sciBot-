Ensemble Models for Data driven Prediction of Malware
Infections
Chanhyun Kang† , Noseong Park† , B . Aditya Prakash* , Edoardo Serra+ , and V . S .
*Department of Computer Science , Virginia Tech . , Blacksburg
†Department of Computer Science and UMIACS , University of Maryland , College Park
Subrahmanian†
+Department of Computer Science , Boise State University , Boise
Email : {chanhyun , npark}@csumdedu , badityap@csvtedu , edoardoserra@boisestate.edu , vs@umiacsumdedu
ABSTRACT Given a history of detected malware attacks , can we predict the number of malware infections in a country ? Can we do this for different malware and countries ? This is an important question which has numerous implications for cyber security , right from designing better anti virus software , to designing and implementing targeted patches to more accurately measuring the economic impact of breaches . This problem is compounded by the fact that , as externals , we can only detect a fraction of actual malware infections .
In this paper we address this problem using data from Symantec covering more than 1.4 million hosts and 50 malware spread across 2 years and multiple countries . We first carefully design domain based features from both malware and machine hosts perspectives . Secondly , inspired by epidemiological and information diffusion models , we design a novel temporal non linear model for malware spread and detection . Finally we present ESM , an ensemble based approach which combines both these methods to construct a more accurate algorithm . Using extensive experiments spanning multiple malware and countries , we show that ESM can effectively predict malware infection ratios over time ( both the actual number and trend ) upto 4 times better compared to several baselines on various metrics . Furthermore , ESM ’s performance is stable and robust even when the number of detected infections is low . Keywords cyber security ; malware attacks ; prediction model ; information diffusion ; anti virus ;
1 .
INTRODUCTION
The goal of this paper is to develop methods to predict the percentage of hosts in a given population ( we use country in our experiments ) that will be infected by a particular piece of malware , given some historical data about the malware and the hosts , but with no information whatsoever on how the hosts are connected together . This is made even more challenging by the fact that not all truly infected machines are actually detected to be infected ( by say using some anti virus software ) . This problem is an important one with immediate applications in web and cyber security . For example , a better prediction of the number of infections in a country will enable anti virus companies and security firms to better deploy patches and safety measures to counter threats .
In order to achieve this , we make several contributions . First , we define a very novel set of features that are related to the ability of hosts to detect malware and patch vulnerabilities . In order to achieve this , we present a novel hostmalware bipartite graph and a bi fix point algorithm to compute these features . These lead to a feature based prediction model ( FBP ) . Then , building upon the well known SIRmodel of disease spread , we develop an epidemiologicallyinspired predictive model called DIPS in which each host is either in a detected , infected , patched , or susceptible state . We define the model and show how to learn the parameters of the model in a data driven way . We also define a variant of DIPS called DIPS Exp . The outputs of these models , as well as outputs of past work on predicting epidemic spreads , are then fed into three different ensemble models : ESM0 , ESM1and FBP+ F unnel . We study the relative predictive accuracies of all of these models . On split sample 10 fold cross validation tests , ESM0 provides the best performance , significantly outperforming past work by large margins , irrespective of whether we use root mean squared error ( RMSE ) , normalized RMSE ( NRMSE ) , or Pearson Correlation Coefficient ( PCC ) as our measure . All the experiments use large scale extensive real data from Symantec ’s Worldwide Intelligence Network Environment ( WINE ) data set .
The paper is organized as follows . We describe our dataset and set up in the next section . Section 3 describes statistical features we develop for our task and the feature based prediction model ( FBP ) . In Section 4 , we propose a novel non linear time series model ( DIPS ) . The ensemble models ( ESM ) to combine two suggested models ( FBP and DIPS ) is described in Section 5 . In Section 6 we present our empirical data analysis including the prediction task . We review related work in Section 7 , and we discuss the implications of our results in Section 8 . 2 . DATASET AND SET UP
Symantec ’s wine data is collected from real world hosts running Symantec anti virus software . Users of Symantec ’s product line have a choice of opting in to report telemetry about the security events1 ( eg executable file downloads , virus detection ) that occur on their hosts . The wine dataset contains information about the hosts , files of the hosts and malware recognized on a file of a host .
We selected the 100 most frequently detected malware from the wine data and extracted infection information about hosts infected by these malware using the following records . Anti virus telemetry . Anti virus ( AV ) telemetry records detection history of known malware over hosts . From each record , we extracted the detection time and the hash ( MD5 and SHA2 ) of the malicious file detected . Each record indicates that the anti virus has blocked an attack that may have resulted in an infection . Binary reputation . The binary reputation data records all binary executable files – benign or malicious – that were downloaded/copied on end hosts worldwide . From each record , we extracted the creation time of the malicious file in the host ( infection time ) and the country where the host was when the file was infected .
Figure 1 : Examples of infections/infection intervals
Figure 2 : Examples for infection patterns of 2 malware in the US in our dataset . Number of infected hosts ( bold red ) and number of detection ( blue ) vs time ( in days ) . Note that the number of detection are a fraction of the number of infected hosts and that both time series are highly non linear .
We note that an infection interval is the period from the infection time to the detection time of a malware in a host ( See Figure 1 ) . When the length of the infection interval is larger than 0 , we call it an infection.2 The number of infections over the 100 most frequently detected malware during 640 days was 3,170,669 ( for the US alone , it was 989,263 ) . The infection patterns are very different ( See Figure 2 ) . We adopt the following approach to address this problem : ( a ) we first carefully define and extract novel domain based features from the wine datasets including measures of hosts’ detection ability and incompetence — we call this feature based prediction ( FBP ) ; ( b ) we then construct a novel non linear temporal model called DIPS ( Detected , Infected , Patched , and Susceptible ) based on epidemiological principles , and 1The events included in wine are representative of events that Symantec observes around the world [ 23 ] . 2If the anti virus software blocked a file containing a malware immediately when the files appeared , then the detection record is not an infection in our framework . then ( c ) utilize sound regression methods to link both the features as well as the epidemiology based models to the dependent variable ( the number of malware infections ) . Because the inputs of FBP as well as multiple DIPS variants and FUNNEL[19 ] are themselves predictors that feed into yet another predictor , our overall framework is an ensemble prediction method .
3 . FEATURE BASED PREDICTION ( FBP )
In a very dynamic environment like malware infections and patching , it is not possible to predict infection patterns solely based on infection trends . Some amount of domain knowledge has to be incorporated ( for example , when the number of detected infections are small ) . Hence as a first step , we build a feature based prediction model ( FBP ) , where given past history we extract meaningful features of hosts and malware . Essentially these features encode the defending abilities of hosts and infection properties of the malware as relative scores . Next , we describe the domain based features we constructed for our analysis in more detail . We define H and M as the set of hosts and the set of malware , respectively . For each host h ∈ H , F(h ) denotes the set of files of h . For f ∈ F ( h ) , th f is the time stamp representing the time when f appears on h . For each host h ∈ H , the malware detection set dH(h ) of h is a set of tuples of the form ( f , m , t ) where f ∈ F(h ) , m ∈ M and t is the time stamp when the file f infected by the malware m is discovered on the host h . By using the malware detection sets for each host , we define the set of host detection dM ( m ) of the malware m as dM ( m ) = {(f , h , t)|h ∈ H , f ∈ F ( h ) , ( f , m , t ) ∈ dH(h)} .
Vulnerabilities : Let V be the set of all vulnerabilities . Given a malware m ∈ M the set V u(m ) is the set of all vulnerabilities used by this malware . For each vulnerability v ∈ V , two time stamps are important [ 5 ] :
• Anti virus signatures released . Once the vulnerability is disclosed , anti virus vendors release new signatures for ongoing attacks and created heuristic detection for the exploit . After this point , the attacks can be detected on end hosts with updated A/V signatures . We denote this as ts v . We can retrieve this information from Symantec website or the National Vulnerabilities Database ( NVD)3 maintained by NIST ( National Institute of Standards and Technology of the US Government ) .
3.1
• Patch released . On the disclosure date , or shortly afterward , the software vendor releases a patch for the vulnerability . After this point , the hosts that have applied the patch are no longer susceptible to the exploit . We denote this as tp v . This information is readily available from NVD . Incompetence
Given a host h ∈ H and a tuple ( f , m , t ) ∈ dH(h ) , we define two classes of features : hosts’ incompetence in detecting malware and incompetence in patching ( DI and P I , respectively ) . For each , we consider an absolute case and a relative case ( i.e ADI , AP I , RDI and RP I ) . These four measures measure the incompetence of a host in detecting 3https://nvdnistgov/ timet1 t2 t3 t4 t5 t6 t7 t8 t9 # of infected hosts# of detections124543443001100201Host EHost DHost CHost BHost AInfection intervalInfection timeDetection time010020030040050060001000020000Days# of infected hosts / detectionsllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll# of infected hosts# of detections01002003004005006000200040006000Days# of infected hosts / detectionsllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll# of infected hosts# of detections and patching the malware m associated with file f . The only difference between the relative case and absolute case is that the absolute case does not consider the time ts v for each vulnerability v contained in a malware .
ADI(h , f , m , t ) = t − th RDI(h , f , m , t ) = maxv∈V u(m ) max(0 , t − max(ts f ) ) AP I(h , m ) = ( max(f,m,t)∈dH(h ) t ) − ( min(f,m,t)∈dH(h ) th f ) RP I(h , m ) = maxv∈V u(m ) max(0 , ( max(f,m,t)∈dH(h ) t v , th f
− max(tp v , ( min(f,m,t)∈dH(h ) th f )) ) )
For instance , absolute detection incompetence , ADI(h , f , m , t ) of host h wrt a file f of malware m and the time t when f was detected by host h is simply ( t − th f ) , ie the time that passed from the detection time to the time of original infection . The relative detection incompetence RDI(h , f , m , t ) looks at all possible vulnerabilities v that malware m exploits . For each such vulnerability , it looks at the time elapsed between when the file f was detected by host h and when either the file infected the host or when an updated anti virus signature could have detected it . The longer this time gap , the more incompetent the host . The absolute and relative ( API , RPI ) patching incompetence are similarly defined .
Estimation by using only the wine datasets . The relative detection and patch incompetence formulas can be rewritten as :
RDI(h , f , m , t , ) = max(0 , t − max((minv∈V u(m ) ts RP I(h , m ) = max(0 , ( max(f,m,t)∈dH(h ) t− v ) , th f ) ) ) max((minv∈V u(m ) tp v ) , ( min(f,m,t)∈dH(h ) th f )) ) )
For a malware m , ts(m ) = minv∈V u(m ) ts v denotes the earliest time at which a host downloaded an anti virus signature for the vulnerability ( we call this “ time signature ” ) , showing that it might have become aware of the malware , and tp(m ) = minv∈V u(m ) tp v denotes the earliest time the host applied a patch for a vulnerability for malware m ( we call this “ patch signature ” ) . Both these quantities are recorded by wine . Then , the two measures becomes the following : RDI(h , f , m , t , ) = max(0 , t − max(ts(m ) , th f ) )
RP I(h , m ) = max(0 , ( max(f,m,t)∈dH(h ) t)− max(tp(m ) , ( min(f,m,t)∈dH(h ) th f )) ) )
A possible way to estimate time signature and patch signature of a malware in wine is : ts(m ) = minv∈V u(m ) tm f tp(m ) = minv∈V u(m ) tp v
≈ minh∈H,(f,m,t)∈dH(h ) t ≈ minh∈H,(,m,t)∈dH(h ) max(f,m,t)∈dH(h ) t
Average Incompetence . Average/relative detection/patching incompetence of a host h can be defined by aggregation .
AADI(h ) =
ARDI(h ) =
AAP I(h ) =
ARP I(h ) =
( f,m,t)∈dH(h ) ADI(h,f,m,t )
( f,m,t)∈dH(h ) RDI(h,f,m,t )
|dH(h)| |dH(h)| m∈{m|(,m ,)∈dH(h)} AP I(h,m ) m∈{m|(,m ,)∈dH(h)} RP I(h,m )
|{m|(,m,)∈dH(h)}| |{m|(,m,)∈dH(h)}|
For instance , average patch incompetence ( AAPI ) is obtained by adding up the average patch incompetence of the host wrt all malware files that it patched , and dividing this by the number of such malware files associated with that host .
3.2 Features on Bipartite Host Malware ( HM )
Graphs
Given a training set of historical wine data , we can derive a bipartite graph whose vertices are hosts and malware , respectively . An edge links a host and malware if the training data shows that the malware has infected the host . Edges can be weighted with quantities like ADI , RDI , API , and RPI as defined earlier in this section .
We now define some novel features using HM graphs . The absolute detection ability ( ADA ) of a host h captures the host ’s ability to detect malware , while the absolute detection hardness ( ADH ) of a malware m captures the difficulty in detecting that malware . Clearly , these two quantities are closely intertwined . We define them below in a mutually recursive manner .
( f,m,t)∈dH(h ) w12(h , f , m , t ) · ADH(m ) ( f,h,t)∈dM ( m ) w21(m , f , h , t ) · ADA(h )
ADA(h ) = ADH(m ) = where h ∈ H , m ∈ M and w12(h , f , m , t ) = w21(m , f , h , t ) =
1
ADI(h,f,m,t )
( f ,h,t )∈dM ( m ) ADI(h ,f ,m,t ) ( f ,m ,t )∈dH(h ) ADI(h,f,m,t )
ADI(h,f,m,t )
1
By way of explanation , consider the definition of ADA(h ) . To do this , we look at every ( f , m , t ) triple in the training set . If h can detect m , then the harder m is to detect ( captured by ADH(m ) in the formula ) , the better h ’s detection abilities are . Thus , when considering a specific ( f , m , t ) triple , the definition of ADA(h ) multiplies ADH(m ) by a quantity w12 which is the relative competence ( inverse of absolute detection incompetence ADI(h , f , m , t) ) . A similar rationale applies to the definition of ADH . As in the previous section , we can define relative variants , RDA , RDH as well .
( f,m,t)∈dH(h ) w12(h , f , m , t ) ∗ RDH(m ) ( f,h,t)∈dM ( m ) w21(m , f , h , t ) ∗ RDA(h )
RDA(h ) = RDH(m ) = where h ∈ H , m ∈ M and w12(h , f , m , t ) = w21(m , f , h , t ) =
1
RDI(h,f,m,t )
( f,h ,t)∈dM ( m ) RDI(h,f ,m,t ) ( f,m ,t )∈dH(h ) RDI(h,f,m,t )
RDI(h,f,m,t )
1
321 Fix point Computation and Convergence Re sult
ADAi(h ) = ADH i(m ) =
As ADA , ADH are mutually recursively defined , one may wonder if they are well defined . We show below , an iterative fix point computation procedures that describes how this may be achieved . We now define the iterations ADAi , ADH i as follows . Let ADA0(h ) = 1|H| , ADH 0(m ) = 1|M| for h ∈ H , m ∈ M,then for iteration i > 0 ,
( f,m,t)∈dH(h ) w12(h , f , m , t ) ∗ ADH i−1(m ) ( f,h,t)∈dM ( m ) w21(m , f , h , t ) ∗ ADAi−1(h ) We can capture the above computations as a bi fix point algorithm , Algorithm 1 that maintains two lists ADA , ADH . The entry ADA(h ) specifies the value of the ADA quantity computed thus far similarly for the entry ADH(m ) . These two lists are manipulated . We assume the existence of an equivalence relation ≡ on ADA and ADH lists , telling us when two ADA lists and two ADH lists are essentially the same . For instance , we can decide that ADA lists 1 , 2 are similar whenever a measure of distance , such as cosine distance or Jaccard distance , between the two vectors is below a threshold .
Algorithm 1 : BiFixpoint Input : H , M , T ( ∗T is a training set ∗ ) Output : ADA , ADH
1 forall h ∈ H , ADA(h ) ← 1|H| ( ∗ initialize ∗ ) 2 forall m ∈ M , ADH(m ) ← 1|M| 3 change ← true ; 4 while change do 5
ADA(h ) ← ADH(m ) ←
( f,m,t)∈dH(h ) w12(h , f , m , t ) ∗ ADH(m ) ( f,h,t)∈dM ( m ) w21(m , f , h , t ) ∗ ADA(h )
6
7
8
9
10 if ADA ∼ ADA and ADH ≡ ADH then change ← false ADA ← ADA and ADH ← ADH else end
11 12 end 13 return ADA , ADH
The following result shows that this algorithm is guaran teed to converge .
Theorem 1 . For any sets ( H,M , T ) , BiF ixpoint(H,M , T ) is guaranteed to converge and the returned solution is unique . m∈{m|(,m,)∈dH(h)} p12(h , m)∗ in the following way RDA(h ) = RDH(m ) and RDH(m ) = RDA(h ) where p12(h , m ) = and p21(m , h ) = each m ∈ M , each h ∈ H ,
Proof . The recursive equations describing RDA and RDH have the same structure of those of a bipartite Markov Chain where the first partition is the set of hosts H and the second is the set of malware M . In fact we can rewrite the equations h∈{f|(,h,)∈dM ( m)} p21(m , h ) ∗ ( f,m,t)∈dH(h ) w12(h , f , m , t ) ( f,h,t)∈dM ( m ) w21(m , f , h , t ) . Because of the definition of the weights w12 and w21 , it follows that for h∈{h|(,h,)∈dM ( m)} p12(h , m ) = 1 and for m∈{m|(,m,)∈dH(h)} p21(m , h ) = 1 . In addition both the p1,2(h , m ) ( with m ∈ M and h ∈ {h|(,h , ) ∈ dM ( m)} ) and p2,1(m , h ) ( with h ∈ H and m ∈ {m|(,m , ) ∈ dH(h)} ) are greater than zero . Moreover , by construction , if we have an edge ( h , m ) also the edge ( m , h ) exists , both with value ( probability ) greater than zero . The last statement implies that for each pair of nodes ( a , b ) in each connected components in this Markov chain the probability to reach a from b ( and vice versa ) after a finite number of steps is greater than zero . This implies that , for each connect component , the associate transition matrix is regular , it follows that the BiF ixpoint(H,M , T ) algorithm converges and the returned solution is unique . 3.3 Patch Ability
Exactly analogous to the measures defined above , we can define two patch abilities : absolute and relative . The absolute patch ability ( APA ) and absolute patch hardness ( APH ) are defined in the following way : m∈{m|(,m,)∈dH(h)} w12(h , m ) · AP H(m ) h∈{h|(,h,)∈dM ( m)} w21(m , h ) · AP A(h )
AP A(h ) = AP H(m ) = where h ∈ H , m ∈ M , and w12(h , m ) = w21(m , h ) =
1
AP I(h,m ) h∈{h|(,h,)∈dM ( m)}
AP I(h,m ) AP I(h,m ) m∈{m|(,m ,)∈dH(h)} AP I(h,m )
1
The relative patch ability ( APA ) and relative patch hard ness ( APH ) are defined in the following way : m∈{m|(,m,)∈dH(h)} w12(h , m ) ∗ RP H(m ) h∈{h|(,h,)∈dM ( m)} w21(m , h ) ∗ RP A(h )
RP A(h ) = RP H(m ) = where h ∈ H , m ∈ M and w12(h , m ) = w21(m , h ) =
1
RP I(h,m ) h∈{h|(,h ,)∈dM ( m)} RP I(h,m ) RP I(h,m ) m∈{m|(,m,)∈dH(h)} RP I(h,m )
1
In order to compute the patch ability we can use the BiF ixpoint(H,M , T ) algorithm with opportune modifications according the specific equations . By following the same proof methodology of Theorem 1 , is possible to prove that the resulting algorithm converge and the returned solution is unique . 3.4 Collaborative Features
Let H be a set of all hosts and H be a subset of H . We use a memory based collaborative filtering approach to produce features whose meaning is close to the number of malware infections in a specific set of hosts H , ie all the hosts of a specific country . The basic intuition under this collaborative filtering is that if host h is infected by malware m and host h similar to h , then h could also be infected by m . We assume the existence of a function sim : H × H → [ 0 , 1 ] that similarity between hosts . Given a host h ∈ H , the percentage of infected hosts in H ( weighted by the similarity ) by malware m is h∈H,∃(,m,)∈dH(h ) sim(h , h ) inf ected(h , m ) =
( 1 ) where ∃( , m , ) ∈ dH(h ) is used to check if h is infected by m . Intuitively inf ected(h , m ) estimates the possibility that the host will be infected by m . In fact , the greater the percentage of hosts similar to h infected by m , the greater is the possibility ( or probability ) that h will be infected by m . Since we want to predict the expected number of infected hosts in H , our resulting variable is the following :
|H| h∈H inf ected(h , m ) value
If we assume that inf ected(h , m ) is a correct estimation of the probability that the host h will be infected by m , the h∈H inf ected(h , m ) estimates the expected number of infected host in H . Since H can be huge ( millions of hosts ) , we consider a reduced subset ˜H obtained by uniformly sampling H , and then we replace H in Eq 1 by ˜H .
Similarity Measures . We define different notions of similarity – each of these notions yields a different feature estimating the expected number of infected hosts . The definitions below show some examples .
)| ) = 1 − |ADA(h ) − ADA(h sim1(h , h )| ) = 1 − |RDA(h ) − RDA(h sim2(h , h )| ) = 1 − |AP A(h ) − AP A(h sim3(h , h )| ) = 1 − |RP A(h ) − RP A(h sim4(h , h sim5(h , h ) =
1 − ( ADA(h)−ADA(h))2+(AP A(h)−AP A(h))2 1 − ( ADA(h)−RDA(h))2+(RP A(h)−RP A(h))2 sim6(h , h ) =
2
2
3.5 The FBP Model
The FBP Model is a general framework to predict the ratio of hosts infected by malware m in country c with a given regression method r such as GPR ( Gaussian Process Regression ) , Elastic Net , Ridge , Lasso , and etc . The dependent and independent variables for the regression method are following :
Dependent variable . The dependent variable for each country malware pair ( c , m ) is the percentage of hosts in country c infected by malware m .
Independent variables ( features ) . For each country malware pair ( c , m ) , we compute ADI , AP I , RDI , RP I , AADI , ARDI , AAP I , ARP I , ADA , RDA , AP A and RP A of hosts in country c , AP H and RP H of malware m and the collaborative variables of the hosts in c with the 6 similarity measures . Other features are the percentages of the hosts which were not detected for m in countries which are economically similar to country c.4 Two measures , Human Development Index ( HDI ) and Per Capita GDP PPP of countries are used to determine the similar countries . The features are computed for each day d with respect to four different time intervals from 0 , d − 60 , d − 30 , d − 10 to d day .
Nearest Neighbors ( additional feature selection ) To make the learned model more robust , we also take features of the k−nearest neighbors . For a given country malware pair ( c,m ) and similarity measure S , we find the k most similar country malware pair(s ) Pk to ( c,m ) with respect to the past infection pattern . We then use the features of Pk as well ( in addition to those of ( c,m ) ) for predicting . Various existing techniques can be used for measuring similarity between two time series eg Dynamic Time Warping ( DTW ) , Euclidean distance etc .
4 . TIME SERIES MODEL BASED PREDIC
TION ( DIPS )
In this section we propose a novel non linear time series model called DIPS ( short for Detected , Infected , Patched , Susceptible ) which is a variant of the SIR model of disease spread tailored for malware . Typical infection patterns ( see Figure 2 ) are highly non linear . Hence intuitively linear approaches are ill suited to this task . Malware spread has multiple similarities to information diffusion and epidemiology ( indeed , some of the earliest papers on this topic try to model it as a disease ) . Inspired by these models , DIPS adapts a recent model [ 19 ] to handle malware infections . The most challenging part is to deal with difference in the detected and actual infections . We assume that in the training dataset we have the true ( as well as the detected ) number of infections but in the test dataset , we are only given the number of actual detections . 4.1 Model Parameters
Similar to fundamental models like the Susceptible Infected
Recovered ( SIR ) ‘mumps like’ model , our model assumes that the machine population can be in one of the following states :
• Susceptible :
In this state , a machine is not patched and hence is vulnerable to an attack by a particular malware .
4We define that country C and C are similar wrt measure T when |T ( C ) − T ( C)|/(T ( C ) + ( T ( C ) ) ∗ 0.5 ≤ p where p = {3 % , 6 % , 9 % , 12 % , 15 % , 18%} .
• Infected : In this state , the machine is now infected , and spreads the malware by infecting other susceptible hosts . • Detected : In this state , we have detected that the machine is infected ( by say an anti virus software running on the machine ) . Note that not all infected machines may be detected as infected . • Patched : As the name suggests , in this state the ma chine is patched , and cannot get infected .
We temporally track the number of hosts in each of these states . In addition , we assume we have a variable DET ( t ) which is the true number of detection at time t . 4.2 The DIPS Model
We are now ready to describe the DIPS model . There are a total of N potential susceptible hosts for the malware ( one may also assume that there is an inflow of additional hosts at every time tick ) . Each host starts out in the Susceptible state . From the susceptible state , a host may move into the Patched state ( at the rate of θ(t ) ) or the Infected state . We assume each infected host may infect a susceptible host at a certain rate ( called β(t) ) , which is also periodic and dictated by users’ habitual behavior . An infected host may move into the Detected state upon detection , after which the host may become susceptible again ( if it is not patched ) , or be patched ( at the rate of δ(t ) ) and never get infected again — these transitions are shown in Figure 3 .
Figure 3 : DIPS model . D , I , P and S are the Detected , Infected state , Patched and Susceptible states Infection Rate β(t ) : This is the rate at which an infected host infects susceptible machines . We assume β(t ) has the following form :
2π Pp
β(t ) = β0(1 + Pa cos(
( t + PS) ) ) where , hosts ) habitual behavior averaged over days
• β0 : is the infection rate by users’ ( who are using the • Pp : stands for the period of a cycle . Infection data , like information diffusion data , and epidemiological data , typically shows obvious periodicity ( like weekly ) which we want to capture .
• Pa : represents the amplitude of the fluctuation . • PS : represents the phase shift in the cycle .
Patching rates δ(t ) and θ(t ) : As mentioned above , we assume that susceptible hosts get patched at the same rate θ(t ) and hosts in the detected state get patched at rate δ(t ) . More formally :
θ(t ) = 0 ( t < tp ) δ(t ) = 0 ( t < tp , td ) or θ0 ( t ≥ tp ) or δ0 ( t ≥ tp , td ) where tp is the start time of the patching and td is the first detection time .
SIDPθ(t)β(t)γ(t)δ(t)(t)1 δ(t)σ Error rate γ(t ) : This captures the fact that the number of true detections DET ( t ) may not exactly match the number of detection in our model ( ie the number of hosts in the D(t ) state ) .
Finally , putting everything together , the DIPS model can be expressed using the following differential equations : S(t + 1 ) = S(t ) − β(t)S(t)I(t ) + ( 1 − δ(t))D(t ) − θ(t)S(t ) I(t + 1 ) = I(t ) + β(t)S(t)I(t ) − γ0DET ( t ) D(t + 1 ) = γ0DET ( t ) P ( t + 1 ) = P ( t ) + δ(t)D(t ) + θ(t)S(t )
( 2 )
Intuitively , S(t ) , I(t ) , D(t ) , P ( t ) capture the number of hosts in a susceptible , infected , detected , and patched state , respectively .
The DIPS exp model .
We have another variant of the DIPS model , called DIPSexp where we have an inflow of additional susceptible hosts at every time tick ( σ(t) ) . All the equations in Equation 2 remain the same , except for the equation defining S(t + 1 ) which changes to : S(t+1 ) = S(t)−β(t)S(t)I(t)+(1−δ(t))D(t)−θ(t)S(t)+σ(t ) 4.3 Model Learning The parameters of the DIPS model Θ = {N , β0 , Pa , PS , γ0 , tp , θ0 , δ0} ( DIPS exp additionally has a parameter of σ0 ) need to be learned . Given two real time sequences , Itrue(t ) and Dtrue(t ) , of the number of actual infections and detection ( resp . ) at time tick t , we find the parameters which optimize the following equation :
∗
Θ
= arg min
Θ
( Itrue(t ) − IΘ(t))2 . t true ( t ) and Dsum
The learning algorithm is given in Algorithm 2 . Basically , there are two phases to learn the parameters . The first step is to adjust the initial parameters to fit them on overall infection time sequences ( I sum true(t ) ) and fix parameter tp,θ0 , Pa and PS . The learning order of the parameters is N → β0 → γ0(→ σ0 ) → tp → δ0 → θ0 → Pa → PS 5 . The second step is to fit the learned parameters on the specific infection pattern of country c for malware m . Here , we only update the following parameters : N → β0 → γ0(→
σ0 ) → δ0 . The LearnP arameters(Θ , I(t ) , D(t ) , f lag ) is the function to update the given parameter values Θ ap plying parameter p ∈ Θ ← arg minp t ( I(t ) − IΘ(t))2 and to return the updated parameters , Θ and the error , t(I(t)− IΘ ( t))2 . The flag represents the learning order of each step ( if f lag = 1 , the first step , else the second step ) . Initially , S(0 ) = N−D(0)−I(0 ) , P ( 0 ) = 0 , D(0 ) = DET ( 0 ) , and I(0 ) = Itrue(0 ) . We leverage the Levenberg Marquardt ( LM ) algorithm [ 16 ] for each argmin in LearnP arameters .
5 . ENSEMBLE MODELS ( ESM )
We have suggested three models : feature based prediction ( FBP ) , and time series model based prediction ( DIPS and DIPS exp ) . We now propose ensemble models , ESM which combine both of them to improve performance . We add the expected number of infections we get from the DIPS and DIPS exp models as features for our feature prediction
5The order affects the prediction performance a lot .
Algorithm 2 : DIPS learning algorithm Input : country c , malware m and X(m ) =
Output : Θ = {N , β0 , Pa , PS , γ0 , tp , θ0 , δ0 , ( σ0)}
{(c , Itrue(t ) , Dtrue(t))|c ∈ Countries , Itrue(t ) and Dtrue(t ) for c and m} 0 , δ
0)} // Assign default
1 Θ ← {N , β
0 , ( σ p , θ
S , γ
0 , t parameter values
0 , P a , P true(t ) ← true ( t ) , Dsum
2 I sum c∈Countries,(c,I(t),D(t))∈X(m ) I(t ) , D(t ) // Sum of # of infections/detection over countries wrt each time
3 err ← inf inite , err ← 0 , Θ ← Θ 4 while err > err do
// Learn all parameters < err , Θ >← LearnP arameters(Θ , I sum if err > err then true ( t ) , Dsum true(t ) , 1 )
Θ ← Θ , err ← err err ← 0 end
5
6
7
8
9
10 end 11 Let ( c , Itrue(t ) , Dtrue(t ) ) ∈ X(m ) where c equals c 12 Θ ← Θ , err ← 0 13 while err > err do
// Learn N , β0 , γ0(σ0 ) , δ0 only < err , Θ >← LearnP arameters(Θ , Itrue(t ) , Dtrue(t ) , 0 ) if err > err then
Θ ← Θ , err ← err err ← 0
14
15
16
17 end
18 19 end 20 return Θ model . We do not use the learned parameters Θ∗ of DIPS directly as features . This is because DIPS is highly nonlinear ; to take advantage of it , we use the output of DIPS instead .
To summarize , we extract all the features , add the output of DIPS as additional features , and then use a regression model to perform prediction . We used a variety of models like logistic regression and Gaussian process regression .
6 . EMPIRICAL ANALYSES
In this section , we empirically analyze the performance of the proposed prediction methods . Specifically , we study three questions : that are infected by a malware ?
• Q1 : Can we predict the number of hosts in a country • Q2 : How does predictive accuracy change with the • Q3 : Does the prediction performance of the models number of infections ? depend on the number of hosts monitored ?
Experiment setting . We focused on top 50 most infectious malware in the 100 malware infection data extracted from wine , and the top 40 countries ( by GDP ) , leading to 2000 ( 50x40 ) country malware pairs . This data includes over 1.45M unique hosts and 2.99M infections . The number of reported hosts varies from just 634 ( Iran ) to 554,969 ( United States ) . We ran the experiment over 541 days from 60th to 600th day among total 640 days . Because infection data is not complete for the head and the tail periods , we eliminated the first 60 and last 40 days of the 640 day data set .
Performance metrics . We checked RMSE ( root mean squared error ) , NRMSE ( normalized RMSE ) , and Pearson correlation coefficient ( PCC ) to evaluate performance . N RM SE = RM SE /(max(X)− min(X) ) , where X is a set of ground true infection ratios of each malware country pair over all days . Due to space constraints , we focus on NRMSE6 .
Train/Test Split . Each prediction model was trained in the first l days ( on the features defined earlier ) and tested for the remaining days . We used 80 % of the data for training and the rest for validation .
F unnel
Prediction models . We tested 7 different prediction models , Funnel [ 19]7 , FBP , DIPS , DIPS Exp , two different ESM models ( ESM0 and ESM1 ) and FBP+ 8 . Funnel is a recently proposed time series model which has been used to predict large scale disease patterns ( and like DIPS , it too is based on epidemiological models like SEIR ) . However , intuitively , Funnel is too tailored to model disease trends ( like taking into account strong seasonality and locality ) and not malware attacks . For example , it does not distinguish between detected and patched states , and its parameters are not suitable to represent malware infection . ESM0 refers to ESM using FBP with the expected values of the two DIPS models as additional features for each pair . ESM1 uses FBP with Funnel and DIPS models . To estimate the performance of ESM more precisely , we also tested FBP+ F unnel which uses FBP with only Funnel ( but without DIPS ) .
For FBP , we tested various regression methods such as GPR ( Gaussian Process Regression ) , Elastic Net , Ridge , Lasso , and etc with k more country malware pairs whose infection patterns are similar with each country malware . We tested with k ∈ {0 , 1 , 2} . The similarity was measured by Dynamic Time Wrapping ( DTW ) . For FBP , DTW showed best performance in our testing among several similarity measures , such as Euclidean distance , average correlation coefficient , DTW and etc . In testing with 2000 ( country,malware ) pairs , FBP showed the best performance with GPR and k = 2 wrt the average RMSE and NRMSE . The average correlation coefficients were similar for all . We did not consider k > 2 because the performance improvement from k = 1 to k = 2 was very trivial . In the following experiment sections , we fix k = 2 and GPR for FBP and the FBP setting was used for ESM0 , ESM1 and FBP+ 6.1 Performance over all countries and mal
F unnel also . ware
Answering Q1 with overall performance . The overall performance of the prediction models is shown in Table 1 . FBP is clearly better than Funnel with respect to all four measures , showing that the features defined in Section 3 are useful to predict infection patterns generally . Also , DIPS shows good prediction performance . The average MAE* , RMSE and NRMSE are 25 % , 30 % and 73 % respectively of Funnel . Moreover the average correlation coefficient is more than 6 times that of Funnel . ESM models ( FBP+DIPS ) shows significant performance improvement from FBP and the best performance with respect to NRMSE . DIPS models show slightly better prediction performance wrt MAE* , RMSE and Correlation coefficient than ESM0 and ESM1 . We can
6The other two measures provide similar results . 7The code was downloaded from http://wwwcskumamotouacjp/∼yasuko/softwarehtml 8The source code for the models suggested in this paper are available at http://wwwumiacsumdedu/research/ CDIG/projects/CCAFE.html
Model FBP
Funnel
DIPS
DIPS Exp
ESM0 ESM1
FBP+
F unnel
MAE* RMSE NRMSE CC 0.12 73.74 127.83 0.08 0.50 32.36 0.48 36.56 0.31 39.41 41.84 0.31 0.19 79.01
0.00170 0.00269 0.00083 0.00096 0.00115 0.00118 0.00189
0.179 0.226 0.165 0.223 0.150 0.151 0.179
Table 1 : Average of MAE , RMSE , NRMSE and Correlation coefficient over 2000 pairs in testing period . Training ratio is 08 The MAE* values were computed with |# of ground true infected hosts the expected # of infected hosts| . Others were based on the infection ratio of each country . also confirm that FBP+ F unnel ( FBP with Funnel only ) and ESM1 ( ESM0 with Funnel ) do not show clear improvement from FBP and ESM0 . This suggests that DIPS significantly improves upon the predictive accuracy of past work . In any case we wish to point out that Funnel was designed and intended for disease patterns and not malware spread .
More detailed analysis : Performance of the prediction models for each country malware pair is shown in Figure 4 . DIPS models show many cases having very high correlation coefficient and very low NRMSE . But there are some cases having very high NRMSE when the correlation coefficient is very low . On the other hand , NRMSE of FBP is relatively low even when the correlation coefficient is pretty low . Interestingly , ESM models have the both strength of FBP and DIP S . To analyze the performance more , kernel density estimations are shown in Figure 5 . As you see in Figure 5 ( a ) , the density of ESM models and DIPS models are high in very high correlation coefficient values . In Figure 5 ( b ) , the density of DIPS models and ESM models are really high with very low NRMSE values . But DIPS models have very long tail having very high NRMSE values .
Answering Q2 . We define the infectiousness level as the average number of infected hosts over all days . Precisely , ln(1 + Avg.# inf ected hosts over days ) , here 1 is added as a default because Avg.# inf ected hosts over days could be less than 1 . In Figure 6 , we projected values of correlation coefficients and NRMSE over the infectiousness level wrt each country malware pair in order to check how each model works in different infectiousness levels . Each dot corresponds to a certain country malware pair — the infectiousness level varies a lot . In terms of correlation coefficient , DIPS shows the best performance across all infectiousness levels especially with very high values in highly infectiousness levels , and ESM0 follows after it . Switching the perspective to NRMSE more interestingly , DIPS still shows very good performance in general but some glitches in relatively lower infectiousness levels . This shows the performance of DIPS may be less robust when the number of infections is low . On the other hand , NRMSE of FBP is still low in the situation . This means the two models are very complementary to each other . So , ESM models show very stable and reliable performance regardless of infectiousness levels for both measures . Shortly , Funnel doesn’t show any good performance even in highly infectiousness levels . 6.2 Performance for certain countries
Answering Q3 . The number of reported hosts over countries in our data is very different . Figure 7 shows the perfor
Figure 4 : Scatter plot for NRMSE and Correlation coefficient over 2000 pairs . Each point represents the performance for each country malware pair .
( a ) Correlation coefficients
( b ) NRMSE
Figure 5 : Kernel Density of ( a ) Correlation coefficient and ( b ) NRMSE over 2000 pairs
( a ) Correlation coefficient
( b ) NRMSE
Figure 6 : ( a ) Correlation coefficient and ( b ) NRMSE by ln(1+ Avg.# infected hosts over all days ) mance of the models according to each country . The order of countries from left to right is the descending order wrt the number of hosts in each country . DIPS models show good correlation coefficients . ESM models show stable and good performance for NRMSE over countries whose number of monitored hosts are very different . The overall prediction performance of DIPS and ESM do not depend on the size of monitored hosts except the cases when the number of monitored hosts are really small relatively . But for the countries having really small number of hosts , such as Nigeria ( 704 ) and Iran ( 634 ) , the models show slightly worse correlation coefficient .
6.3 Summary of experiments llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll01234−100010NRMSECCESM0llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll01234−100010NRMSECCESM1lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll01234−100010NRMSECCFBPlllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll01234−100010NRMSECCDIPSlllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll01234−100010NRMSECCDIPS−Explllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll01234−100010NRMSECCFUNNELl−10−050005100246810Correlation coefficientDensityESM0ESM1FBPDIPSDIPS−ExpFUNNELl0123401234NRMSEDensityESM0ESM1FBPDIPSDIPS−ExpFUNNELllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810−100010ln(1+Avg#infectedHosts over days)CCESM0llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810−100010ln(1+Avg#infectedHosts over days)CCESM1lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810−100010ln(1+Avg#infectedHosts over days)CCFBPlllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810−100010ln(1+Avg#infectedHosts over days)CCDIPSllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810−100010ln(1+Avg#infectedHosts over days)CCDIPS−Explllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810−100010ln(1+Avg#infectedHosts over days)CCFUNNELlllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810001020ln(1+Avg#infectedHosts over days)NRMSEESM0lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810001020ln(1+Avg#infectedHosts over days)NRMSEESM1llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810001020ln(1+Avg#infectedHosts over days)NRMSEFBPllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810001020ln(1+Avg#infectedHosts over days)NRMSEDIPSllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810001020ln(1+Avg#infectedHosts over days)NRMSEDIPS−Expllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll0246810001020ln(1+Avg#infectedHosts over days)NRMSEFUNNEL ( a ) Correlation
Figure 7 : ( a ) Correlation coefficient and ( b ) NRMSE by each country . The order from left to right is the descending order by the number of hosts over countries . Each red line is the average over countries .
( b ) N RM SE
ESM and DIPS have low prediction errors and relatively high correlation coefficient values on average over all 2000 ( country,malware ) pairs . Both models have better prediction performance for the country malware pairs having more infected hosts . For the cases having lower infectious levels , DIPS was not reliable and sometimes yielded very large errors . Interestingly , in the lower infectious levels , DIPS and FBP showed complementary performance . So , the combination of two techniques , ESM showed good and very stable performance for almost all cases except the very small number cases where DIPS was originally the best .
7 . RELATED WORK
We considered related work in cyber security , data mining and epidemiology . Much research has tried to model malware propagation . In July 2001 , the Code Red worm infected 359,000 hosts on the Internet in less than 14 hours [ 22 ] . Code Red achieved this by probing random IP addresses ( using different seeds for its pseudo random number generator ) and infecting all hosts vulnerable to an IIS exploit . Staniford et . al . [ 26 , 25 ] analyzed the Code Red worm traces and proposed an analytic model for its propagation . They also argue that optimization like hit list scanning , permutation scanning can allow a worm to saturate 95 % of vulnerable hosts on the Internet in less than 2 seconds . Such techniques were subsequently employed by worms released in the wild , such as the Slammer worm [ 21 ] ( infected 90 % of all vulnerable hosts within 10 minutes ) and the Witty worm [ 28 ] . Gkantsidis et al . study the dissemination of software patches through the Windows Update service and find that approximately 80 % of hosts request a patch within a day after it is released ; the number of hosts drops by an order of magnitude during the second day , and is further reduced by factor of 2 in day three [ 8 ] . Additionally , [ 27 ] [ 15 ] [ 17 ] conducted measurement studies into routing instability in Broder Gateway Protocol ( BGP ) routers caused by catastrophic events , such as worm outbreaks or power outages . Other recent research also includes using machine learning methods like belief propagation on the file machine graph [ 6 ] to infer files’ reputations ( say malicious or benign ) . Papalexakis et . al . [ 23 ] propose the SharkFin and GeoSplit models of spatio temporal propagation of malware based on an analysis of the wine data . Their system models only the total volume of malware attacks as a whole over time using a simplified model . In contrast , in this paper we model the magnitude of malware attacks per machine in context of the machine usage and using many more sophisticated variables . Remotely related work also comes from the area of information diffusion . Information diffusion is the phenomena in which an action or idea becomes widely adopted due to the influence of others , typically , neighbors in some network [ 4 , 9 , 10 ] . There are a lot of dynamic process on graphs , all of which are related to virus propagation like blogs cascades [ 1 , 14 , 11 ] and information cascades [ 18 ] .
Finally our DIPS model is inspired by epidemiological models . The canonical textbooks and surveys discussing fundamental epidemiological models like SIS and SIR include [ 12 , 2 ] . Much work has gone into finding epidemic thresholds ( minimum virulence of a virus which results in an epidemic ) for a variety of networks [ 3 , 20 , 2 , 13 , 7 , 24 ] .
8 . CONCLUSIONS
In this paper , we studied the problem of predicting the volume of actual malware infections in a country given past data . This is a challenging problem because we can only detect a fraction of malware infections . There are many
USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRFBPCountriesAverage CC for 50 malware−0200020406USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRFUNNELCountriesAverage CCfor 50 malware−0200020406USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRDIPSCountriesAverage CCfor 50 malware−0200020406USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRDIPS−ExpCountriesAverage CCfor 50 malware−0200020406USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRESM0CountriesAverage CCfor 50 malware−0200020406USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRESM1CountriesAverage CCfor 50 malware−0200020406USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRFBPCountriesAvg NRMSE for 50 malware0001020304USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRFUNNELCountriesAvge NRMSE for 50 malware0001020304USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRDIPSCountriesAvg NRMSE for 50 malware0001020304USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRDIPS−ExpCountriesAvg NRMSE for 50 malware0001020304USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRESM0CountriesAvg NRMSE for 50 malware0001020304USUKDEJPAUFRITCACNBRESINMXBEPLSETRKRCHNLNOSGGRFIATDKILAEZASARUTHPTMYARCOIDVENGIRESM1CountriesAvg NRMSE for 50 malware0001020304 potential benefits of accurately predicting malware volume , which can have implications for better anti virus software , and targeted patching . Using Symantec ’s extensive malware database in wine , we investigated the infection patterns of 50 malware in more than 1.4 million hosts spread over two years in several countries . We present ESM , an ensemble based approach which carefully leverages well designed domain specific features ( FBP ) and a novel non linear timeseries model DIPS which incorporates detection and infections seamlessly . We show that our approach gives robust and stable predictions , even in case of low volume of infections , across all the countries over several metrics ( correlation coefficients and NRMSE ) .
Acknowledgments : This paper is based on work partially supported by the Maryland Procurement Office under Contract No . H98230 14 C 0137 , by the NEH under Grant No . HG 229283 15 , by ORNL under Task Order 4000143330 , by the VT College of Engineering , and a Facebook faculty gift . We thank Symantec for providing access to the wine platform . Other researchers may reproduce and verify our results by analyzing the reference data set we recorded in wine ( WINE 2013 001 ) after signing a research agreement with Symantec .
9 . REFERENCES
[ 1 ] E . Adar and L . A . Adamic . Tracking information epidemics in blogspace . Web Intelligence , pages 207–214 , 2005 .
[ 2 ] R . M . Anderson and R . M . May . Infectious Diseases of
Humans . Oxford University Press , 1991 .
[ 3 ] N . Bailey . The Mathematical Theory of Infectious
Diseases and its Applications . Griffin , London , 1975 .
[ 4 ] S . Bikhchandani , D . Hirshleifer , and I . Welch . A theory of fads , fashion , custom , and cultural change in informational cascades . Journal of Political Economy , 100(5):992–1026 , October 1992 .
[ 5 ] L . Bilge and T . Dumitras . Before we knew it : an empirical study of zero day attacks in the real world . In ACM Conference on Computer and Communications Security , pages 833–844 , 2012 .
[ 6 ] D . H . P . Chau , C . Nachenberg , J . Wilhelm , A . Wright , and C . Faloutsos . Polonium : Tera scale graph mining for malware detection . In SDM , Mesa , AZ , April 2011 .
[ 7 ] A . Ganesh , L . Massoulie , and D . Towsley . The effect of network topology in spread of epidemics . IEEE INFOCOM , 2005 .
[ 13 ] J . O . Kephart and S . R . White . Measuring and modeling computer virus prevalence . IEEE Computer Society Symposium on Research in Security and Privacy , 1993 .
[ 14 ] R . Kumar , J . Novak , P . Raghavan , and A . Tomkins . On the bursty evolution of blogspace . In WWW ’03 : Proceedings of the 12th international conference on World Wide Web , pages 568–576 , New York , NY , USA , 2003 . ACM Press .
[ 15 ] M . Lad , X . Zhao , B . Zhang , D . Massey , and L . Zhang .
Analysis of BGP Update Burst During Slammer Attack . In The 5th International Workshop on Distributed Computing , Dec 2005 .
[ 16 ] K . Levenberg . A method for the solution of certain non linear problems in least squares . Quarterly Journal of Applied Mathmatics , II(2):164–168 , 1944 .
[ 17 ] J . Li , Z . Wu , and E . Purpus . CAM04 5 : Toward
Understanding the Behavior of BGP During Large Scale Power Outages . GLOBECOM ’06 . IEEE , pages 1–5 , Nov . 2006 .
[ 18 ] Y . Matsubara , Y . Sakurai , B . A . Prakash , L . Li , and
C . Faloutsos . Rise and fall patterns of information diffusion : model and implications . In Proceedings of the 18th ACM SIGKDD international conference on Knowledge discovery and data mining , KDD ’12 , pages 6–14 , 2012 .
[ 19 ] Y . Matsubara , Y . Sakurai , W . G . Van Panhuis , and C . Faloutsos . Funnel : automatic mining of spatially coevolving epidemics . In KDD , pages 105–114 , 2014 .
[ 20 ] A . G . McKendrick . Applications of mathematics to medical problems . In Proceedings of Edin . Math . Society , volume 44 , pages 98–130 , 1925 .
[ 21 ] D . Moore , V . Paxson , S . Savage , C . Shannon ,
S . Staniford , and N . Weaver . Inside the Slammer worm . Security & Privacy , IEEE , 1(4):33–39 , 2003 .
[ 22 ] D . Moore , C . Shannon , and K . C . Claffy . Code red : a case study on the spread and victims of an internet worm . In Internet Measurement Workshop , pages 273–284 , 2002 .
[ 23 ] E . E . Papalexakis , T . Dumitras , D . H . Chau , B . A .
Prakash , and C . Faloutsos . Spatio temporal mining of software adoption & penetration . In 2013 IEEE/ACM International Conference on Advances in Social Networks Analysis and Mining , 2013 .
[ 24 ] B . A . Prakash , D . Chakrabarti , M . Faloutsos ,
N . Valler , and C . Faloutsos . Threshold conditions for arbitrary cascade models on arbitrary networks . In ICDM , 2011 .
[ 8 ] C . Gkantsidis , T . Karagiannis , and M . Vojnovic .
[ 25 ] S . Staniford , D . Moore , V . Paxson , and N . Weaver .
Planet scale software updates . In SIGCOMM , pages 423–434 , 2006 .
[ 9 ] J . Goldenberg , B . Libai , and E . Muller . Talk of the network : A complex systems look at the underlying process of word of mouth . Marketing Letters , 2001 .
[ 10 ] M . Granovetter . Threshold models of collective behavior . Am . Journal of Sociology , 83(6):1420–1443 , 1978 .
[ 11 ] D . Gruhl , R . Guha , D . Liben Nowell , and A . Tomkins .
Information diffusion through blogspace . In WWW ’04 , 2004 .
[ 12 ] H . W . Hethcote . The mathematics of infectious diseases . SIAM Review , 42 , 2000 .
The top speed of flash worms . In WORM , pages 33–42 , 2004 .
[ 26 ] S . Staniford , V . Paxson , and N . Weaver . How to 0wn the internet in your spare time . In Proceedings of the 11th USENIX Security Symposium , pages 149–167 , Berkeley , CA , USA , 2002 . USENIX Association . [ 27 ] L . Wang , X . Zhao , D . Pei , R . Bush , D . Massey ,
A . Mankin , S . Wu , and L . Zhang . Observation and Analysis of BGP Behavior under Stress . In IMW , 2002 .
[ 28 ] N . Weaver and D . Ellis . Reflections on Witty : Analyzing the attacker . ;login : The USENIX Magazine , 29(3):34–37 , June 2004 .
