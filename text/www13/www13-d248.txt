Understanding User Spatial Behaviors for Location based
Recommendations
Jun Zhang
Junzhang@pbcom Pitney Bowes Inc .
Chun yuen Teng
Chun yuenteng@umichedu
University of Michigan
Yan Qu
Yanqu@acmcom
PlaceNous.com
ABSTRACT
In this paper , we introduce a network based method to study user spatial behaviors based on check in histories . The results of this study have direct implications for location based recommendation systems .
Author Keywords Network analysis , location based services , spatial behavior , human mobility
ACM Classification Keywords H5m Information interfaces and presentation ( eg , HCI ) : Miscellaneous .
General Terms Human Factors ; Design ; Measurement . recommendation
INTRODUCTION Rapid adoption of mobile phones has driven the growth of location based systems . Finding a restaurant on a smart phone is a regular practice for travelers in a new city . In business , mobile marketing techniques like location based coupons is one of the fastest areas of growth . Novel applications have been developed by researchers such as De Choudhury et al . [ 4 ] who proposed constructing travel itineraries with recommended paths from geo tagged photos and Cranshaw et al . [ 3 ] who identified for visitors using Foursquare check ins . living neighborhoods
To create stronger location based recommendations , we need deepen our understanding of human mobility and spatial behavior . Excellent work has been done by González et al . [ 5 ] who built a model using call logs from millions of users , demonstrating that human mobility has “ a high degree of temporal and spatial regularity ” and “ high predictability ” . They also demonstrated that the activity of an individual usually center around a small number of frequently visited locations . Cheng et al . [ 1 ] analyzed millions of Foursquare check ins and found that location displacement follows a Levy Flight like pattern : a mixture of short random movements with occasional long jumps .
These previous works established an excellent theoretical basis for understanding the basic laws governing mobility . However , they focused primarily on extracting patterns from large amounts of data , less attention was paid to user type , location context , and how individual behaviors and motivations shape the data generated . Specifically :
 There are different types of users . Lindqvist et al . [ 6 ] and Cramer et al . [ 9 ] found that the motivations and preferences of location based services users are very diverse , and their differences significantly impact the way data generated and its potential applications . For instance , a person who checks in at home and at work will generate different location trails compared to a person who only checks in when they travel . Thus a location based should consider what types of users they serve . recommendation system
 People have different needs based on their location context . Places checked in by local residents are very different than places checked in by tourists . Also , users look for different kinds of recommendations based on their location context . Understanding these differences as well as finding ways to separating them will allow us to develop better location based recommendations .
With this in mind , we introduce a network based approach to analyze location histories . We focus on identifying location context in one ’s location histories as well exploring differences among users .
The paper is organized as following : first , we describe check in data and ways to construct trajectory networks ; second , we analyze a known user ’s trajectory network in detail to illustrate the process of how we analyze a check in network ; third , we analyze trajectory networks of a large group of Foursquare users and compare their differences ; we conclude the paper with a discussion of implications and avenues for future work .
LOCATION DATA AND TRAJECTORY NETWORK OF MOBILE USERS
Location Data of Mobile Users Widespread usage of mobile phones enables us to collect rich location data from location based services such as Foursquare check ins , geo tweets , and location enabled mobile applications . Although collected and accessed in different ways , generally speaking , this data takes the following format :
1
[ userID ] [ check in time ]
[ lati]/[longi ]
[ location ]
ID1 2012 02 24T12:45:06 523648119/ 23723465833 placeA
ID1 2012 02 24T13:34:58 52360511233/ 2366369017 placeB
ID1 2012 02 26T11:22:45 52249494444/ 2301756444 placeC
Sometimes device ID is recorded instead of user ID . Here we treated both as user ID . Some dataset may not have detailed location names , but this information can easily be added using a reverse geocoding process . In this paper , we used Foursquare check in data as a test case to illustrate our methods of analysis . However , we believe the same process can be applied to any location history dataset .
Construct and Analyze a Trajectory Network We define a trajectory network as a network that reflects the sequential structure of a user ’s location histories . A node is a location that was visited . An edge is drawn between two locations that were visited consecutively within a time threshold . If consecutive locations were logged within the threshold , we viewed them as a part of the same trip and drew an edge between them . Otherwise these locations were treated as separate trips and no edge was created . Figure 1 show a simple network created using the above sample data . Based on earlier work on check in displacement time distribution [ 2 ] and our own analysis of twenty people ’s check in trips , we set 3 hours as the time threshold . Note there is no edge between place B and C because the time gap was more than 3 hours . If a user went from place A to place B multiple times , the weight of the edge reflects this . Thus , the network generated is weighted and directed . placeA placeB placeC
Figure 1 : The construction of a trajectory network
Analyze a sample trajectory network We used a sample user to illustrate how a trajectory network can be used to analyze user spatial behaviors . Sam , an active Foursquare user , gave us his six months of check in data , comprising of 1,288 check ins at 370 unique locations . Figure 2 shows Sam ’s trajectory network , which has 370 nodes and 425 edges . Note : only 329 nodes are visible because 41 nodes without edges are hidden . To explore spatial aspect of the network , we colored nodes more than 20km away from Sam ’s home in red ( his office is close to his home ) .
Figure 2 : Sam ’s check in network
Node characteristics We next examined the connectivity of nodes by checking their degrees ( ie in degree pluses out degrees ) . Figure 3 shows the skewed distribution of the node connectivity . A clear pattern in this network is that there are several nodes with high degrees while most nodes have a degree of 0 or 1 or 2 . 11 % of nodes have a degree of 0 , indicating they are isolated check ins . 44.3 % of nodes have a degree of 1 or 2 , indicating they are the only parts of a single trip . 1.6 % of nodes have a degree more than 20 . We call these high degree nodes location hubs because many trips start or end at them .
Figure 3 : The degree distribution of Sam ’s check in network
A detailed examination of Sam ’s data reveals that the top five location hubs are his home , his office , his favorite gym , a restaurant nearby his office , and a supermarket near his home . All of these location hubs are within 20km of his home . There are two red nodes with degree higher than 8 . One is his parents’ home and the other one is his hotel during a two week vacation . Identifying location hubs in a trajectory network has commercial implications . For instance , application designers can send different recommendations to hub locations ( where routine activities are performed ) than to leaf nodes ( where casual activities are performed ) .
2
Edge characteristics Next , we looked at the edge patterns and found that the network can be separated into two parts : nodes in black ( within 20km of home ) are highly connected , while nodes in red ( more than 20km away ) form several paths of varying length . In the black sub network , there is a strong triad cycle connecting the three check in hubs at Sam ’s home , office , and gym . This cycle is a good indication of his daily mobility pattern and is highly regular when time of day and day of the week are taken into account . Moreover , many short trips surround these hubs . These trips are related to daily needs like going out for lunch or dinner . There are also several longer paths that correlate with local travel ( ie a trip to a local mall ) . This subnet is a good representation of Sam ’s regular local check in activities . For red nodes more than 20km away from Sam ’s home , one noticeable pattern is several isolated long paths that correlate with Sam ’s travels in the past 6 months . We can also find some medium length paths around two hubs discussed earlier ( his parents’ home and a vacation hotel ) . These trip paths are longer than those near his home . Developers looking to identify popular tourist locations should pay special attention to these red paths , while the black part of the network can be used to identify hot spots for locals .
We analyzed the edge weight distribution in Sam ’s trajectory network and found that about 74 % of edges in Sam ’s network have a weight equal to one , coinciding with trips that only happened once between two connected locations . About 26 % of edges are repeated and about 2 % are repeated more than 10 times ( forming the triadic cycle between Sam ’s home office gym ) . Edge weight distribution indicates how many of the place visits are repeated activities and how many represent travel that only occurred once .
Above all , we can draw several conclusions about Sam ’s activities based on his trajectory network . He has location hubs at his home , office , and gym as well as other places he only visited once . There are repeated trips on a regular basis around where he lives as well as unique trips to other areas . Our analysis indicates that it is possible to use simple network metrics like node degree and edge weight to separate these types of trips .
Next , we applied this method to a large number of Foursquare users to explore similarities and differences between other users with Sam .
Trajectory Networks for Different Users
Dataset Our dataset was a subset of six months of Foursquare check ins from Nov . 2011 to May 2012 . It was collected using a similar method described in [ 2 ] by mining Foursquare Twitter is debatable whether Foursquare check in is prefered when studying spatial behaviors because of varying motivations for using linked accounts . It the service [ 9 ] . However , Foursquare check ins is a large dataset with fine grained information that is otherwise not available . We used this data as a test case , limiting our analysis to active users with a high number of check ins . However , we kept the limitations of this dataset in mind when interpreting our results .
The most interesting question we addressed is whether most users have location hubs in their trajectory networks . We introduced a network metric called Gini Coefficient ( GC ) to answer the question . GC measures the inequality of degree distribution , and in the case of trajectory networks it can be interpreted as the expected difference of degrees between randomly selected places . Assuming the degree distribution of check ins is sorted in ascending order , we used the same definition as described by Sen [ 8 ] : where is the degree of location i , i is the rank of location x , is the mean of the degrees among all locations , and n is the total number of locations . A network with high degree hubs will have a high GC .
Figure 4 shows two similar sized networks with different GCs . User A does not have any location hubs and the trips are mostly disconnected . A detailed review of user A ’s data reveals that they rarely checked in when traveling and did not check in during routine activities such as grocery shopping . User B ’s network is more similar to Sam ’s ( GCN=0.59 ) and has several location hubs and long trip paths .
A : GCN=0.19 , n=134
B:GCN=0.73 , n=136
Figure 4 . Two check in networks with different GCN
Figure 5 shows the distribution of GC of all 38,831 users . We can see that 13.6 % users have a GC lower than 0.3 , indicating that not all users have location hubs . These users probably only checked in while traveling . 38.4 % of users have a GC higher than 0.5 , indicating many users have high degree location hubs . We looked at 1,197 users who checked in at homes and calculated the distance between their highest degree nodes and home and we that found 82 % of the highest degree nodes are within 3km of home . This indicates that the highest degree node is often a good approximation of home area .
3
G2n2xi(xix)i1nxix As an early work in this field , there is more work to be done expanding on these findings and concepts . In the future , we plan to improve this network construction method by developing a more precise means of identifying trips rather than using a simple threshold . We also plan to integrate trajectory network analysis with two other methods we are developing : spatial patch analysis [ 11 ] and trade area analysis [ 10 ] .
Figure 5 : Distribution of Gini Coefficient
REFERENCES 1 . Cheng , Z . , Caverlee , J . , Lee , K . , and Sui , D . Z .
Above all , analyzing a large number of active users , we see that there are at least three different types of Foursquare users : those who regularly check in at local areas and during repeated trips , those who only check in while traveling and do not record repeated trips , and others who fall somewhere in between . We should consider these type differences into how we identify patterns in check in data and as we develop location based services .
DISCUSSION In this paper , we introduced trajectory network analysis to user generated location data . This method detected important structural and sequential features of mobility , giving us a unique perspective on user types and location context .
First , trajectory network analysis allowed us to identify different types of users based on their check in behavior , such as those who check in for daily activities or others who only check in when traveling . Understanding these differences in motivation is crucial to correctly interpreting location data . For instance , data from users with repeated check ins can be used to study regularities in mobility and analyze local customers , while data from travelers is ideal for marketing efforts at tourist spots .
Second , the concept of location hub is an important tool when trying to determine location context . Location hubs are place where many trips start and end , which implies frequent visits and significant time spent at that location . These hubs may correspond to a home , office , or regularly visited place like a gym . Identifying the spatial location and place type of a hub is important to understanding the activities that happen around it . As frequently visited places , these hubs can be used as spatial activity center in mobility analysis . Moreover , the type of hub provides a context about the activities that take place before or after it is visited . For instance , activities on trips departing from home may differ from activities on trips departing from an office . Better descriptions of location context will lead to a better understanding of the purpose of these trips . This is valuable location based recommendation service or mobile marketing campaign . It is easy to imagine such a service suggesting restaurants that are close to home and coffee shops that are near the office . information for any
Exploring Millions of Footprints in Location Sharing Services . In Proc . ICWSM 2011 .
2 . Colombo , GB , Chorley , M . J . , Williams , M . J . , Allen ,
S . M . , and Whitaker , R . M . You Are Where You Eat : Foursquare Checkins as Indicators of Human Mobility and Behavior . In Proc . Percom workshop 2012 , 217222 .
3 . Cranshaw , J . , Schwartz , R . , Hong , J . , and Sadeh , N . M.The Livehoods Project : Utilizing Social Media to Understand the Dynamics of a City . In Proc . ICWSM 2012 .
4 . De Choudhury , M . , Feldman , M . , Amer Yahia , S . , Golbandi , N . , Lempel , R . , and Yu , C . Constructing travel itineraries from tagged geo temporal breadcrumbs . In Proc . WWW 2010 , 1083 1084 .
5 . González , M . C . , Hidalgo , C . A . , and Barabási , A . L .
Understanding individual human mobility patterns . Nature , vol 435 , 779 782 .
6 . Lindqvist , J . , Cranshaw , J . , Wiese , J . , Hong , J . , and
Zimmerman , J . I’m the mayor of my house : examining why people use Foursquare : a social driven location sharing application . In Proc . CHI 2011 , ACM Press ( 2011 ) , 2409 2418 .
7 . Zheng , Y . , Zhang , L . , Xie , X . , and Ma , W . Y . Mining interesting locations and travel sequences from GPS trajectories . In Proc . WWW 2009 , 791 800 .
8 . Sen , A . On Economic Inequality . Oxford : Clarendon
Press 2011 .
9 . Cramer , H . , Rost , M . , and Holmquist , L . E . Performing a check in : emerging practices , norms and conflicts in location sharing using foursquare . In Proc . MobileHCI 2011 , ACM Press ( 2011 ) , 57 66 .
10 . Qu , Y . and Zhang , J . 2013 . Trade Area Analysis Using User Generated Mobile Location Data . Proceedings of the 22nd International World Wide Web Conference ( WWW2013 ) , May 13 17 , 2013 , Rio de Janeiro , Brazil .
11 . Qu , Y . and Zhang , J . 2013 . Regularly Visited Patches in Human Mobility . Proceedings of Conference on Human Factors in Computing Systems ( CHI2013 ) , April 27May 2 , 2013 , Paris , France .
4
