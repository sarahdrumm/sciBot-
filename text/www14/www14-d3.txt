Generating Ad Targeting Rules using Sparse Principal
Component Analysis with Constraints
Mihajlo Grbovic mihajlo@yahoo inc.com
Yahoo! Labs
701 First Avenue Sunnyvale , USA
Slobodan Vucetic Temple University
1805 N Broad Street Philadelphia , USA vucetic@temple.edu
ABSTRACT Determining the right audience for an advertising campaign is a well established problem , of central importance to many Internet companies . Two distinct targeting approaches exist , the model based approach , which leverages machine learning , and the rule based approach , which relies on manual generation of targeting rules . Common rules include identifying users that had interactions ( website visits , emails received , etc . ) with the companies related to the advertiser , or search queries related to their product . We consider a problem of discovering such rules from data using Constrained Sparse PCA . The constraints are put in place to account for cases when evidence in data suggests a relation that is not appropriate for advertising . Experiments on real world data indicate the potential of the proposed approach .
Categories and Subject Descriptors H28 [ Database applications ] : Database Applications Data Mining
Keywords data mining , computational advertising , audience modeling
1 .
INTRODUCTION
The key players in display advertising are advertisers and publishers . Given a fixed budget , advertisers wish to advertise a product and maximize the campaign response in terms of user clicks or purchases . Publishers run the websites and want to supplement their income . They are typically able to track user behavior in great detail , including search queries , page views , email activity , ad clicks . This gives them the ability to identify subsets of users who are likely to respond to the campaign . This is referred to as ad targeting . In model based targeting [ 1 ] , a model is learned using behavioral data to estimate the probability of action for every user . In rule based targeting , an audience is manually defined by a set of rules , and any user satisfying all the rules qualifies .
Main representatives of rule based targeting are 1 ) site retargeting , which targets users that visited websites of certain companies ; 2 ) email retargeting , which targets users that received emails from certain companies ; 3 ) search retargeting , which targets users that searched certain keywords . Typical scenario is that the advertiser already knows the market well and can provide a list of targeting elements , ie websites , domains or keywords . However , most advertisers provide an incomplete list or settle for self retargeting , thus missing opportunity to show ads to relevant users who visited websites or received emails from domains related to the advertiser .
In this paper we consider a problem of data driven recommendation of targeting elements . Without loss of generality , let us consider email retargeting as an example . Given user profiles composed from counts of emails received per domain , eg during the last T = 30 days , we can use Sparse Principal Component Analysis [ 2 ] to find small groups of correlated domains . The domains which co exist with the advertiser ’s domain in the resulting groups are recommended . The main problem with such correlation based domain groupings is that not all groupings are meaningful for targeting . For example , a retail domain nike.com may be highly correlated with a financial domain paypal.com that typically processes the order , and/or usps.com that typically ships the order . Moreover , some groupings may not be appropriate from a privacy standpoint . For example , fast food domains were found to be correlated with plus size clothing stores . Such profiling may offend the users . For this reason we propose a Constrained Sparse PCA variant that leverages taxonomy over domains , and penalizes grouping of domains which belong to categories that are far apart from each other .
2 . PROPOSED APPROACH
Given advertiser ’s website(s ) , domain(s ) or search keyword(s ) , consider suggesting a handful of targeting elements , websites , commercial domains or keywords to form a rulebased segment . We describe the proposed approach in the context of all three rule based types , as it is applicable in any single scenario ; combining them has not been considered .
.
We assume n targeting elements ( websites , domains or keywords ) , and m users . Let us define the number of interactions between i th element and j th user in the last T days as xi(j ) . Considered interactions are : visits to website i by user j , emails sent by domain i to user j , searches for keyword i by user j . Combining information about all n targeting elements , we have a row vector xj = [ x1(j ) , x2(j ) , , xn(j) ] , which serves as a user profile . Finally , combining all m users m]T of size m × n . we have a data matrix X = [ xT
2 , , xT
1 , xT
Let us assume the features are centered and denote the m×m covariance matrix of targeting elements as S = XT X . The problem at hand is to decompose S into K sparse principal components uk , k = 1 , , K of cardinality r . Each resulting PC defines a group , where non zero element indices define group members . Targeting elements that co occur with advertiser ’s query element are suggested as rules .
The problem of maximizing the variance of component u with a constraint on its cardinality is NP hard . In [ 2 ] , the authors proposed an approximate solution to the problem based on a convex relaxation in which the vector u is replaced by a matrix U = uuT , maximize Tr(SU ) subject to Tr(U ) = 1 , 1T|U|1 ≤ r , U 0 .
( 1 ) where 1 is a vector of ones , matrix |U| contains absolute values of U elements , and U 0 means that U is positive semidefinite . The first PC u1 is obtained as the most dominant eigenvector of U1 , the solution to ( 1 ) . Similarly to regular PCA , this process iterates by updating S , S2 = S1 − ( uT
1 to obtain the second component .
1 S1u1)u1uT
In SPCA with Constraints ( CSPCA ) [ 3 ] we assign an additional cost on grouping features together , and enforce disn tance constraints on uk parameterized by allowed distance d . Given a distance metric D , the total cost associated with the j=1 I(Uij = 0)Dij , first PC can be defined as C = 1 2 where I is an indicator function , Dij is a distance between features i and j and U is the problem ( 1 ) solution . After appropriate convex relaxation due to non convex cost [ 3 ] , the resulting constrained Sparse PCA problem is n i=1 maximize Tr(SU ) subject to Tr(U ) = 1 , 1T|U|1 ≤ r 1T|U ◦ D|1 ≤ d , U 0 ,
( 2 )
Leveraging taxonomy to form D . Given two targeting elements , eg domains , i and j and a function f ( · ) → c that maps them into taxonomy nodes ( categories ) , we define a distance between the targeting elements Dij as the distance between the nodes Dij = dist(ci , cj ) . In SPCA this distance can be used to enforce a penalty on grouping elements that are far from each other in the taxonomy . Such optimization problem will favor groupings with similar categories .
3 . EMPIRICAL ANALYSIS
We chose email retargeting as an example application , and compared 3 targeting approaches : 1 ) self retargeting , where only advertiser ’s domain is targeted , 2 ) SPCA based and 3 ) CSPCA based targeting . We constructed a matrix X of email counts that 10 , 336 commercial domains sent to 11M anonymous users of Yahoo Mail during 1 month . It is important to stress that we used this data and the email retargeting example purely as a test bed for our framework . The point of our experiments is simply to show that the SPCA rule recommendation framework is effective . Only f rom/to email address data with anonymized user ids was extracted , without processing the email content . Data was extracted exclusively from users who opted in for such research .
In Constrained SPCA , we used a 3 levels deep , 1 , 733 node Pricegrabber taxonomy1 to categorize the domains . The
1http://wwwpricegrabbercom
Table 1 : Examples of resulting PCs
CSPCA results retail pc ekohlscom landsend.com sears.com gap.com jcrew.com vitamins pc vitacost.com games pc steampowered . gamestop.com thinkgeek.com playstation.net books pc half.com
SPCA results retail+rewards pc food+plus size grubhub.com sears.com citibank.com lanebryant.com bankofamerica.com catherines.com omacyscom ebncom travel+rewards pc food+games pc starwoodhotels.com github.com tdrewards.com tdbank.com expedia.com southwest.com jimmyjohns.com chipotle.com hunting+other pc cheaperthandirt.com potterybarn.com brownells.com kingsizedirect.com sportsmansguide.com americanexpress . usps.com swgas.com steampowered.com luckyvitamin.com adebooks.com playstation.net gamestop.com thinkgeek.com dominos.com furniture+other swansonvitamins biblio.com iherb.com walgreens.com christianbook.com outdoor pc rei.com backcountry.com greyhound.com enterprise.com airtran.com westelm.com containerstore.com campmor.com travel pc megabus.com thriftbooks.com alibris.com orvis.com usoutdoor.com choice of a distance for forming matrix D was weighted graph distance that takes into account the depth of the nodes in the hierarchy ; starting from weight 1 for the level one edges , it cuts the weight in half at every next level .
Table 1 shows examples of resulting PCs obtained by solving problems SPCA ( 1 ) and CSPCA ( 2 ) on the domain covariance matrix S . Target cardinality was set to 5 . It can be observed that SPCA may produce corrupted results , due to random noise , or connections between domains that are not useful for targeting , eg banks co occur with retail or travel domains , ie rewards or processing , and shipping companies co occur with shopping domains . DSPCA constraints handle these side effects better , producing much cleaner results . We studied the performance of SPCA and DSPCA based targeting recommendations compared to the baseline selfretargeting in 138 advertising campaigns . Similarly to [ 1 ] we show offline evaluation based on the logs of user activities . Recommendations were generated using the 1 st month data X , and tested on user email profiles and conversions collected during the 2 nd ( following ) month . The goal was to determine how many more converters would be found during the 2 nd month if targeting included the recommended domains found using SPCA vs . SPCA with Constraints .
Performance was measured in terms of the yield rate , Y R = #conversions In our setting , the counts of ad im#impressions . pressions in self retargeting was less than the counts of ad impressions in SPCA or DSPCA based targeting . To make the denominator in Y R equal in both cases , we added random users to the self retargeting segment . Compared to the self retargeting , the DSPCA approach improves Y R by 4.24 % , averaged over all 138 campaigns , while the SPCA approach improvement was 258 % This justifies the use of constraints in domain suggestions for email retargeting . We omitted the results in which the performance was averaged by advertiser category . These results showed that CSPCA outperformed SPCA in most categories , such as retail and travel . There some were exceptions , such as fast food , indicating that the potentially offensive rules help in targeting .
4 . REFERENCES [ 1 ] M . Aly , A . Hatch , V . Josifovski , and V . K . Narayanan . Web scale user modeling for targeting . In WWW , 2012 . [ 2 ] A . d’Aspremont , L . El Ghaoui , M . I . Jordan , and G . R .
Lanckriet . A direct formulation for sparse pca using semidefinite programming . SIAM review , 49(3 ) , 2007 .
[ 3 ] M . Grbovic , C . R . Dance , and S . Vucetic . Sparse principal component analysis with constraints . In AAAI , 2012 .
