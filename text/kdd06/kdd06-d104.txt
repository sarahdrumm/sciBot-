Supervised Probabilistic Principal Component Analysis
Shipeng Yu1,2 , Kai Yu2 , Volker Tresp2 , Hans Peter Kriegel1 , Mingrui Wu3
1Institute for Computer Science , University of Munich , Germany
2Siemens AG , Corporate Technology , Information and Communications , Munich , Germany
3MPI for Biological Cybernetics , T¨ubingen , Germany spyu@dbsifilmude , kaiyu@siemenscom , volkertresp@siemenscom , kriegel@dbsifilmude , mingruiwu@tuebingenmpgde
ABSTRACT Principal component analysis ( PCA ) has been extensively applied in data mining , pattern recognition and information retrieval for unsupervised dimensionality reduction . When labels of data are available , eg , in a classification or regression task , PCA is however not able to use this information . The problem is more interesting if only part of the input data are labeled , ie , in a semi supervised setting . In this paper we propose a supervised PCA model called SPPCA and a semi supervised PCA model called S2PPCA , both of which are extensions of a probabilistic PCA model . The proposed models are able to incorporate the label information into the projection phase , and can naturally handle multiple outputs ( ie , in multi task learning problems ) . We derive an efficient EM learning algorithm for both models , and also provide theoretical justifications of the model behaviors . SPPCA and S2PPCA are compared with other supervised projection methods on various learning tasks , and show not only promising performance but also good scalability .
Categories and Subject Descriptors H.3 [ Information Storage and Retrieval ] : Content Analysis and Indexing—Indexing methods
General Terms Algorithms , Theory , Measurement , Performance
Keywords Dimensionality reduction , Principal component analysis , Supervised projection , Semi supervised projection
1 .
INTRODUCTION
Data mining problems often suffer from the high dimensionality of the data , for the reason of learnability or computational efficiency . Therefore dimensionality reduction , which is also called feature transformation or document indexing , is of great importance and has been extensively studied ( see , eg , [ 8 , 2] ) . The most popular method is probably the principal component analysis ( PCA ) , which performs a singular value decomposition ( SVD ) to the data matrix and obtains the sub eigenspace with large singular values [ 10 ] .
Traditional dimensionality reduction methods are unsupervised , ie , they only focus on observations or input data . However , in discriminant analysis where the prediction value or output is available , it would be more helpful to incorporate this information into the mapping and derive a supervised projection for input data . Since this projection is designed for the specific prediction problem , it could be substantially different from unsupervised projection . A more interesting setting is semi supervised projection where we have only part of input data labeled , along with a large number of unlabeled data . This is often true in real world problems because labeling is expensive , or unlabeled data are very easy to obtain . An ideal projection method should be able to take into account both the observed labeling information and the unlabeled inputs . There exist many supervised projection algorithms in the literature such as linear discriminative analysis ( LDA ) , partial least squares ( PLS ) and many others ( see , eg , [ 8 ] for an overview ) . However , these methods cannot incorporate the unlabeled data into the mapping , which will cause problems when we have only very few labeled points .
In this paper we propose a supervised PCA model called SPPCA , which extends the probabilistic PCA model [ 17 ] to incorporate label information into the projection . SPPCA takes into account not only the inter covariance between inputs and outputs , but also the intra covariance of both . More interestingly , the model can be further extended to model unlabeled data as well , which we call semi supervised PCA or S2PPCA . This model allows us to elegantly use all the available information to define the mapping . We derive an efficient EM learning algorithm for both models , and provide some theoretical justifications for the model behavior . Experimental results on various learning tasks show promising performance for both SPPCA and S2PPCA models .
This paper is organized as follows . After reviewing previous work in Section 2 , we formally introduce SPPCA and S2PPCA models in Section 3 and derive an EM learning algorithm in Section 4 . We then presents some theoretical justifications in Section 5 with further discussions . Finally Section 6 illustrates experimental results and Section 7 concludes the paper .
2 . PREVIOUS WORK
In this section we review some previous work on unsupervised and supervised projections . In what follows we consider a set of N objects ( eg , images ) , and each object n is described by an M dimensional feature vector xn ∈ X ⊂ RM . For dimensionality reduction we aim to derive a mapping Ψ : X 7→ Z which maps the input features into a K dimensional space ( K < M ) .
2.1 Unsupervised Projection
Probably the most popular unsupervised projection is principal component analysis ( PCA ) . Let X = [ x1 , . . . , xN ]> denote the input matrix after centralization , ie , we subtract the sample mean from each input . In PCA we want to find the principal components which illustrate the directions with maximal variances of the data . Let X = VDU> be the singular value decomposition ( SVD ) of X , where V and U are N × N and M × M column orthogonal matrices , respectively , and D is N × M diagonal matrix with singular values sorted in descending order along the diagonal . Then it is known that the first K columns of U , which we denote UK , defines the mapping Ψ . The projections of X onto the principal component space are given as VK DK , where VK contains the first K columns of V , and DK is the top left K × K sub matrix of D .
Unlike PCA which is maximizing the global covariance of the data , there also exist “ local ” projection algorithms such as locally linear embedding [ 15 ] , which tries to preserve the local structure of the data after projecting into a low dimensional space .
2.2 Supervised Projection When each data point n is associated with not only low level features xn but also some outputs yn ∈ Y ⊂ RL ( ie , classification or regression targets ) , unsupervised projection such as PCA may be not able to project the data into useful directions ( see Figure 2 ) . Therefore many supervised projection methods are introduced to make use of the output information . Linear discriminant analysis ( LDA ) focuses on multi class classification and finds projection directions that separate the data best ( see [ 4] ) . The number of projection dimensions is however limited by L−1 . Partial least squares ( PLS ) [ 18 ] originates from regression analysis and finds the directions of maximal covariance between inputs and outputs sequentially . It however ignores the intra covariance of either inputs or outputs , and its generalization performance on new dimensions of outputs is restricted ( see discussions in [ 6] ) . Other related works include [ 9 , 12 , 7 , 1 , 19 , 20 ] which consider this problem from different perspectives .
In the situations where we have few labeled points and a large amount of unlabeled data , all these supervised projection methods are however not able to use the unlabeled data . This is often the case in computer vision , information retrieval and bioinformatics , where labeling is expensive and unlabeled data are sufficient and cheap to obtain . We call this setting the semi supervised projection , and in the next section we will propose a model which can deal with semisupervised projection naturally .
3 . THE SPPCA MODEL
In this section we first review a probabilistic model for PCA in Section 3.1 , and then present our supervised models .
3.1 Probabilistic PCA ( PPCA )
While PCA originates from the analysis of data variances , in statistics community there exists a probabilistic explanation for PCA , which is called probabilistic PCA or PPCA in the literature [ 17 , 14 ] . PPCA is a latent variable model and defines a generative process for each object x as ( see Figure 1(a ) for an illustration ) x = Wxz + µx + x , where z ∈ RK are called the latent variables , and Wx is a M × K matrix called factor loadings . In this probabilistic model , latent variables z are conventionally assumed as a Gaussian distribution with zero mean and unit variance , ie , z ∼ N ( 0 , I ) , and x defines a noise process which also takes an isotropic Gaussian form as x ∼ N ( 0 , σ2 xI ) , with σ2 the noise level . Additionally , we have parameters µx ∈ RM x which allow non zero means for the data .
It is shown that PPCA has strong connections to PCA . x → 0 , the projections of data x onto In particular when σ2 the K dimensional principal subspace in PCA are identical to the latent variables z up to a rotation and scaling factor [ 17 ] . We summarize the related results in the following proposition without proof , since this is simply a corollary of Theorem 2 in Section 5 .
PN n=1(xn − µx)(xn − µx)> be the sample covariance matrix for data {xn}N n=1 , and λ1 ≥ . . . ≥ λM be its eigenvalues with eigenvectors u1 , . . . , uM , then if the latent space in PPCA model is K dimensional ,
Proposition 1 . Let Sx = 1 N
( i ) The maximum likelihood estimate of Wx is given as
Wx = UK ( ΛK − σ2 xI )
1 2 R , where ΛK = diag(λ1 , . . . , λK ) , UK = [ u1 , . . . , uK ] , and R is an arbitrary K × K orthogonal matrix .
( ii ) The mean projections z∗ for new input x∗ is given as
>,ΛK − σ2 xI 1
∗ z
= R
2 Λ
−1 K U
> K ( x
∗ − µx ) .
As a probabilistic framework , PPCA provides additional benefits over PCA such as a fast EM learning procedure , a principled way of handling missing entries , and a possibility of considering mixture of PCA models . PPCA is also closely related to factor analysis models , but the modeling perspectives are different ( see [ 17 ] for more discussions ) .
3.2 Supervised PPCA ( SPPCA )
The key point of PPCA model is that all the M dimensions of x are conditionally independent given the latent variables z , due to the isotropic property of the noise process . This indicates that the principal components in PPCA are the K latent variables which best explain the data covariance . When supervised information is available , each object x is associated with an output value y ∈ Y , eg , y ∈ R for regression task and y ∈ {+1,−1} for classification task . In general we believe there are covariances between input space X and output space Y ( since otherwise the supervised learning task is not learnable ) , and it is reasonable to extend PPCA to model this covariance as well . Furthermore , when there are more than one learning tasks ( ie , in a multi task learning setting [ 5] ) , the covariances between different tasks can also be modeled by latent variables .
( a ) PPCA
( b ) SPPCA
( c ) S2PPCA
Figure 1 : Illustrations of the three models PPCA , SPPCA and S2PPCA . X and Y denote respectively the input and output matrices , where each row is one data point . f 1 x are the M input features , and f 1 y , . . . , f L z are the K latent variables in each model . They are all in circles because they are variables in the probabilistic models . The arrows denote probabilistic dependency . y are the L outputs . On the top f 1 x , . . . , f M z , . . . , f K
We now formally describe our proposed model family which we call the supervised probabilistic principal component analysis ( SPPCA ) . Let the number of outputs be L , and each object x be associated with an output vector y = [ y1 , . . . , yL]> ∈ Y ⊂ RL . In SPPCA the observed data ( x , y ) is generated from a latent variable model as x = Wxz + µx + x , y = f ( z , Θ ) + y , where f ( z , Θ ) = [ f1(z , θ1 ) , . . . , fL(z , θL)]> encode the values of L deterministic functions f1 , . . . , fL with parameters Θ = {θ1 , . . . , θL} . Here z ∼ N ( 0 , I ) are the latent variables shared by both inputs x and outputs y , and the two noise models are independent to each other and both defined as isotropic Gaussians : x ∼ N ( 0 , σ2 yI ) . We use two noise levels σ2 y for inputs and outputs , respectively , and it is also straightforward to define different noise levels for different outputs if desired . See Figure 1(b ) for an illustration of the model . xI ) , y ∼ N ( 0 , σ2 x and σ2
In SPPCA model we keep the nice property of conditional independence , ie , all the input and output dimensions are conditionally independent to each other given the latent variables . If we integrate out the latent variables z , the likelihood of observation ( x , y ) is obtained as
P ( x , y|z)P ( z ) dz =
P ( x|z)P ( y|z)P ( z ) dz ,
P ( x , y ) = where z ∼ N ( 0 , I ) , and from the latent variable model , yI ) . xI ) , y|z ∼ N ( f ( z , Θ ) , σ2 x|z ∼ N ( Wxz + µx , σ2
P ( D ) =QN
After observing N pairs , the likelihood of all the observations D = {(xn , yn)}N n=1 , with iid assumption , is simply n=1 P ( xn , yn ) .
In the following we consider the simplest model in this family , ie , we assume each function f‘ , ‘ = 1 , . . . , L , is linear in z :
( 1 ) z + µ‘ f‘(z , θ‘ ) = w‘ y , y y} include the linear cowhere the parameters θ‘ = {w‘ y , µ‘ efficients and intercept . Then we can group all the f‘ ’s and
>
Z
Z write f ( z , Θ ) = Wyz + µy , y , . . . , wL y ]> and µy = [ µ1 a similar form as the generative model for x where Wy = y ]> . The reason why [ w1 we choose this form for f is that the EM learning is simple ( see the next section ) , and we have closed form solution ( see Section 5 ) . We will discuss other forms of f in Section 5.3 which may need special approximation techniques . y , . . . , µL
Let us denote
!
Wx Wy
!
µx µy
W =
,
µ =
,
Φ =
σ2 xI 0
0 σ2 yI
, then based on the model assumption , it is easily seen that ( x , y ) are jointly Gaussian distributed , with mean µ and covariance Φ + WW> . All the parameters for the SPPCA model are Ω := {Wx , Wy , µx , µy , σ2 3.3 Semi Supervised PPCA ( S2PPCA ) y} . x , σ2
In SPPCA model , we assume we observe both the inputs x and outputs y for every data point . In many real world problems , however , we may only observe the outputs for a small portion of data , and have many unlabeled data in which only inputs x are known . This may be because some measurements are unobservable , the labeling cost is too high , or simply we have a large amount of unlabeled data available . Learning in this situation is in general called semi supervised learning . For learning a projection , an ideal model would incorporate both the unlabeled inputs and the partially labeled outputs to define the mapping .
This can be easily done under the SPPCA framework . Let the number of labeled and unlabeled data points be N1 and N2 , respectively , with N = N1 + N2 . The whole observation is now D = D1 n0=N1+1 . The likelihood , with the independence assumption of all the data points , is calculated as
SD2 = {(xn , yn)}N1 n=1
S{xn0}N NY
P ( D ) = P ( D1)P ( D2 ) =
P ( xn , yn )
P ( xn0 ) , n0=N1+1
N1Y n=1 done using Bayes’ rule ∗|x ∗
P ( z
( 4 ) This turns out again to be a Gaussian N ( µz|x , Σz|x ) , with
) .
) ∝ P ( x
∗|z ∗
∗ )P ( z
µz|x = ( W Σz|x = σ2 x(W
> x Wx + σ2 xI ) > x Wx + σ2
−1W > x ( x −1 . xI )
∗ − µx ) ,
This result looks similar as that in PPCA model , but the projection is now supervised because the learning of Wx is influenced by those observed outputs . This is clarified in the next section and will be theoretically justified in Section 5 .
4 . LEARNING IN SPPCA MODELS
Learning in probabilistic models reduces to maximizing the data ( log ) likelihood with respect to all the model parameters . In case of SPPCA model , the log likelihood of the whole observation D is
NX
Z
L = log
P ( xn|zn)P ( yn|zn)P ( zn ) dzn . n=1
For SPPCA analytical solution exists , and we summarize it later in Theorem 2 . For S2PPCA model , however , there is no analytical solution since all the outputs for the unlabeled data are missing . Fortunately we can derive an EM algorithm [ 3 ] which is applicable to both models .
The EM algorithm iterates the two steps expectation ( Estep ) and maximization ( M step ) until convergence , and it is guaranteed to find a local minima of the data likelihood . In the E step , we fix the model parameters ( Ω for SPPCA models ) and calculate the expected distributions of latent variables ( all the zn ’s for SPPCA models ) , and in the Mstep we fix this distribution and maximize the complete data likelihood with respect to the model parameters . As will be discussed later , EM learning for SPPCA models is important because it can deal with very large data sets , and it has , in particular for SPPCA model with no unlabeled points , no local minima problem up to a rotation factor ( see Section 5 ) . For simplicity we only outline the update equations in the following and omit details ( see [ 17 ] for a similar derivation ) .
4.1 EM Learning for SPPCA
1
We first consider the SPPCA model without unlabeled data . In the E step , for each data point n we estimate the distribution of zn given observation ( xn , yn ) . This is done using ( 2 ) , and we calculate the sufficient statistics as y ( yn − µy ) > hzni = A hznz n i = A > ( 6 ) where h·i denotes the expectation with respect to the posterior distribution P ( zn|xn , yn ) given in ( 2 ) .
σ2 x −1 + hznihzni> x ( xn − µx ) + >
1 σ2 y
, ( 5 )
W
W
−1
,
In the M step , we maximize the complete log likelihood
P ( xn|zn)P ( yn|zn)P ( zn ) dzn
˜L =
P ( zn|xn , yn ) log
Z
NX n=1 with respect to the model parameters , holding P ( zn|xn , yn ) fixed from the E step . This can be done by setting the partial derivatives with respect to each parameter to be zero .
Figure 2 : Projection directions for a toy data . They are fully labeled on the left , and only partially labeled on the right .
P ( xn0 ) = R P ( xn0|zn0 )P ( zn0 ) dzn0 . Due to its applicabil where P ( xn , yn ) is calculated as in SPPCA model , and ity to semi supervised projection , we call it semi supervised PPCA or S2PPCA in this paper . Figure 1(c ) illustrates this model .
Under the additional assumptions that all the f‘ ’s are linear , it can be easily checked that all the likelihood terms in this product are Gaussians . This makes the model easy to learn . Other forms of f will be discussed in Section 53 When N2 = 0 , S2PPCA degrades to SPPCA which is purely supervised . This means one can view SPPCA as a special case of S2PPCA model with no unlabeled data . From the perspective of probabilistic modeling , S2PPCA can also be viewed as an SPPCA model where all the y ’s for the N2 unlabeled points are missing . Due to this close relationship , in the following we use SPPCA to denote both models unless clearly specified . 3.4 Projections in SPPCA Models
Analogous to the PPCA model , in SPPCA models the projection of data point x is directly given in the latent variables z . If we know all the parameters Ω , calculating this projection is simply an inference problem . To do this we can apply Bayes’ rule and calculate the a posteriori distribution of z . Therefore we can obtain not only the mean projection vector , but also the uncertainty of the projection .
341 Projection for Fully Observed Data
When both inputs x and outputs y are observed , we can calculate the a posteriori distribution of z given ( x , y ) as
P ( z|x , y ) ∝ P ( x , y|z)P ( z ) = P ( x|z)P ( y|z)P ( z ) .
( 2 )
1
−1
Since all the three terms on the right hand side are Gaussians , this distribution is also a Gaussian N ( µz , Σz ) , with x ( x − µx ) + >
1 σ2 y
σ2 x
W
µz = A where A is a K × K matrix defined as > y Wy + I .
> x Wx +
A =
W
W
W
, Σz = A
−1 ,
( 3 ) y ( y − µy ) >
1 σ2 x
1 σ2 y
This means that the projection is µz with uncertainty Σz . 342 Projection for Pure Input Data For a test data x∗ that has no output information , what are the most likely latent variables z∗ ? This can also be
Algorithm 1 Learning in SPPCA Model Primal Form Require : N data points {(xn , yn)}N n=1 with inputs xn ∈ RM and outputs yn ∈ RL . A desired dimension K < M . 1 : Calculate the sample means ( 7 ) and center the data via xn ⇐ xn − µx , yn ⇐ yn − µy . end for {M step}
Calculate sufficient statistics ( 5 ) and ( 6 ) ;
{E step} for n = 1 to N do
2 : Initialize model parameters Ω randomly . 3 : repeat 4 : 5 : 6 : 7 : 8 : 9 : Update Wx and Wy via ( 8 ) ; 10 : Update σ2 11 : until the change of Ω is smaller than a threshold . Output : Parameters Ω and projection vectors {zn}N which are obtained from E step . For test data x∗ , the x ( x∗ − µx ) . mean projection z∗ = ( W> y via ( 9 ) and ( 10 ) ; xI)−1W> x Wx + σ2 x and σ2 n=1
For means of x and y we have
NX n=1
˜µx =
1 N xn ,
˜µy =
NX n=1
1 N yn ,
( 7 ) which are just the sample means . Since they are always the same in all EM iterations , we can center the data by subtracting these means in the beginning and ignore these parameters in the learning process . So for simplicity we change the notations xn and yn to be the centered vectors in the following .
The mapping matrices Wx and Wy are updated as fWx = X
>
−1 , fWy = Y
>
−1 ,
ZC
ZC
( 8 ) where for clarity we use matrix notations X = [ x1 , . . . , xN ]> , Y = [ y1 , . . . , yN ]> and Z = [ hz1i , . . . ,hzNi]> . Matrix C is defined to be the sum of all second order sufficient statistics n i . Finally the noise levels # xfWxC ) − 2 tr(XfWxZ> ) # y fWyC ) − 2 tr(YfWyZ> ) of the data , ie , C =PN " NX kxnk2 + tr(fW " NX kynk2 + tr(fW n=1hznz> are updated as
( 10 ) x = y =
M N
( 9 )
˜σ2
˜σ2 n=1
>
>
1
1 LN n=1 where k · k denotes vector 2 norm , and tr(· ) denotes matrix trace . The whole algorithm is summarized in Algorithm 1 . 4.2 EM Learning for S2PPCA The log likelihood of the observations in S2PPCA model is a sum of two parts : L1 = log P ( D1 ) which contains all the labeled points , and L2 = log P ( D2 ) which includes all unlabeled points . Therefore in E step we need to deal with them differently . For a labeled points ( xn , yn ) ∈ D1 , the latent variables zn are estimated via ( 5 ) and ( 6 ) , the same as in SPPCA model . For an unlabeled point xn0 ∈ D2 , the distribution of zn0 is only conditioned on input xn0 , which can be calculated via ( 4 ) , with sufficient statistics ( the data are assumed centered already ) : hzn0i = ( W > x Wx + σ2 hzn0 z n0i = ( W > xI ) > x Wx + σ2
−1W xI )
> x xn0 ,
−1 + hzn0ihzn0i>
( 11 )
( 12 )
,
Algorithm 2 Learning in S2PPCA Model Primal Form Require : N1 labeled data points {(xn , yn)}N1 n=1 and N2 unlabeled points {xn0}N n0=N1+1 , with inputs x ∈ RM and observed outputs y ∈ RL . A desired dimension K < M . 1 : Calculate the sample means ( 7 ) and center the data via xn ⇐ xn − µx , yn ⇐ yn − µy , xn0 ⇐ xn0 − µx .
Calculate ( 5 ) and ( 6 ) for labeled data n ; end for for n0 = N1 + 1 to N do
{E step} for n = 1 to N1 do
Calculate ( 11 ) and ( 12 ) for unlabeled data n0 ;
2 : Initialize model parameters Ω randomly . 3 : repeat 4 : 5 : 6 : 7 : 8 : 9 : 10 : 11 : 12 : Update Wx and Wy via ( 13 ) and ( 14 ) ; 13 : Update σ2 14 : until the change of Ω is smaller than a threshold . Output : Parameters Ω and projection vectors {zn}N which are obtained from E step . For test data x∗ , the x ( x∗ − µx ) . mean projection z∗ = ( W> y via ( 15 ) and ( 16 ) ; end for {M step} xI)−1W> x Wx + σ2 x and σ2 n=1 where here h·i denotes the expectation with respect to the posterior distribution P ( zn0|xn0 ) given in ( 4 ) .
−1 ,
The M step is similarly obtained by setting the partial derivatives of the complete log likelihood with respect to each parameter to zero . For the two mapping matrices , we
> 2 Z2)(C1 + C2 )
> 1 Z1 + X > have the updatesfWx = ( X fWy = Y [ x1 , . . . , xN1 ]> , Z1 = [ hz1i , . . . ,hzN1i]> , C1 =PN1 where X1 , Z1 , C1 are defined for labeled data , ie , X1 = n=1hznz> n i , and X2 , Z2 , C2 are similarly defined for unlabeled data . It is seen that the update for Wx depends on both labeled data and unlabeled data , while Wy only depends on the labeled data . Updates for the noise levels are similar to those in SPPCA model , except that for σ2 x we need to consider both labeled data and unlabeled data :
( 13 )
( 14 )
−1 1 ,
Z1C
" NX " N1X n=1
> fW xfWx(C1 + C2 ) # fWx(Z> 1 X1 + Z> y fWyC1 ) − 2 tr(YfWyZ>
2 X2 )
>
,
( 15 )
#
1 )
.
−2 tr kynk2 + tr(fW
˜σ2 x =
1
M N kxnk2 + tr
1
˜σ2 y =
LN1 n=1
( 16 )
The whole algorithm is summarized in Algorithm 2 . When N2 = 0 , ie , we have no unlabeled data , the learning algorithm reduces to SPPCA learning . 4.3 EM Learning in Dual Form
It is known that when the number of data points is less than the number of features , ie , N < M , it is more efficient to consider the dual solution for PCA in which we perform SVD to the Gram matrix K = XX> . The canonical PCA is sometimes called the primal solution . For SPPCA we have a similar dual solution , and it can be directly derived from the
Algorithm 3 Learning in S2PPCA Model Dual Form Require : N1 labeled data points {(xn , yn)}N1
1 : Calculate Gram matrix K with Kij = x> n=1 and N2 unlabeled points {xn0}N n0=N1+1 , with inputs x ∈ RM and observed outputs y ∈ RL . A desired dimension K < M . i xj and center it using ( 27 ) . Center the outputs via yn ⇐ yn − µy . 2 : Initialize Z , C and model parameters Ω randomly . 3 : repeat {The EM step} 4 : 5 : 6 : Update σ2 7 : until the change of Ω is smaller than a threshold . Output : Parameters Ω and projection vectors {zn}N
Calculate Z1 and C1 using ( 21 ) and ( 22 ) ; Calculate Z2 and C2 using ( 23 ) and ( 24 ) ;
C,Z>KZ + σ2 n=1 . The mean projection z∗ for test data x∗ is z∗ = Z>k(X , x∗ ) where k(X , x∗ ) = xC2 −1 y via ( 25 ) and ( 26 ) ; x and σ2
[ x>
1 x∗ , . . . , x>
N x∗]> and is centered via ( 28 ) .
EM learning in previous subsections . To avoid the tedious mathematics in the main text , we put the derivation details into Appendix and summarize the algorithm in Algorithm 3 . Since SPPCA can be viewed as a special case of S2PPCA , here we only give the algorithm for S2PPCA model .
One important observation in the dual solution is that all the calculation involving input data X can be done via innerproduct , eg , in the Gram matrix K we have Kij = x> i xj . This motivates us to consider non linear PCA where we first map the data into a new feature space ( via , eg , basis functions ) , and then perform PCA in that space with a proper definition of inner product . This is the idea behind kernel PCA [ 16 ] , and we put detailed discussion into Appendix . 4.4 Computational Issues m the number of iterations.1 It is linear in the number of data points N and the input dimension M . The space complexity for both algorithms is O,m(M + L)N K , with complexity is O,(M + L)N , which is also linear in both N and the space complexity is O,N 2 . Both of them are now and M . The projection for a test data point is just a linear operation and costs O(M K ) time . In the dual form , the time complexity is O(mN 2K ) plus O(N 2M ) which is the one time calculation of Gram matrix ,
In the primal form ( ie , Algorithm 1 and 2 ) , the time quadratic in the number of data points N . The time for projecting a test data point is now O(N M ) . Similar to the case for PCA , in situations where M > N , ie , we have more features than the number of data points , the dual form is more efficient than the primal form .
5 . THEORETICAL JUSTIFICATION
In this section we provide some theoretical analysis for SPPCA model and show how the supervised information influences the projection . The proofs are given in Appendix . 5.1 Primal Form Solution
Recall that matrix Φ is a ( M + L ) × ( M + L ) diagonal matrix with all the noise levels in diagonal , ie , Φ = diag(σ2 y ) . For SPPCA model we obtain the following analytical solutions for mapping matrix Wx x , . . . , σ2 y , . . . , σ2 x , σ2
1Note that we only need to calculate the diagonal entries for matrix trace in the updates for noise levels . and Wy . This makes it easier to compare SPPCA with related models such as PCA .
Theorem 2 . Let S denote the normalized sample covari ance matrix for centered observations {(xn , yn)}N n=1 , ie ,
Φ
− 1
Φ
− 1 2
S =
1 N xn yn xn yn
Sxy Sy and λ1 ≥ . . . ≥ λ(M +L ) be its eigenvalues with eigenvectors u1 , . . . , u(M +L ) , then if the latent space in SPPCA model is K dimensional , the following results hold :
Sx Syx
2 =
σ2 x 1
σxσy
σxσy
1
1 σ2 y
!
!>
1
NX n=1
!
,
( i ) The maximum likelihood estimates of Wx and Wy are
Wx = σxUx(ΛK − I ) Wy = σyUy(ΛK − I )
1 2 R , 1 2 R ,
( 17 )
( 18 ) where ΛK = diag(λ1 , . . . , λK ) , Ux ( Uy ) contains the first M ( last L ) rows of [ u1 , . . . , uK ] , and R is an arbitrary K × K orthogonal rotation matrix .
( ii ) Projection z∗ for centered new input x∗ is given as U> x x∗ . x Ux + ( ΛK − I)−1i−1
R> ( ΛK − I)− 1 z∗ =
U> h
2
1 σx
Sx holds . Then ( 17 ) degrades to σxUx(ΛK − I )
In the special case that L = 0 , the model is unsupervised and 1 S = 1 2 R , σ2 x which recovers the PPCA solution . Ux is seen to be column orthogonal in this case , and the mapping z∗ of x∗ is ( scaled ) x → 0 and R = I . This standard PCA mapping when σ2 proves Proposition 1 which is a corollary of this theorem .
When L > 0 , SPPCA solutions explain not only the sample covariance of inputs Sx , but also the intra covariance of outputs Sy ( if L > 1 ) and the inter correlations between inputs and outputs , Sxy and Syx . Therefore , one column of Wx is the direction that best explains the whole system from the perspective of inputs , and thus are biased by the outputs . Unlike the case of PCA , the learned Wx in SPPCA needs not to be column orthogonal . This means we are only learning an affine mapping for x . If necessary , it is straightforward to find the orthogonal basis by performing SVD to matrix Wx .
In both SPPCA and PPCA the learned Wx has an arbitrary rotation factor R . This means the mapping is invariant under a rotation of latent space , as can be seen from the equation for z∗ . Therefore the SPPCA model can only find the latent principal subspace , which has been mentioned in [ 17 ] for PPCA . Thus the EM algorithm in Section 4 can find different mappings with different initializations , but they define the same subspace and do not change the structure of projected data . If necessary , this ambiguity can be removed by eigen decomposing
> x Wx + W
> y Wy = R
>
( ΛK − I)R
W and uncovering the rotation factor R .
A final comment is that Theorem 2 may be not applicable to large scale problems since we have to form a big square matrix of size M + L . This is however not necessary for the EM algorithm . 5.2 Dual Form Solution
In the dual form , we do not obtain the mapping matrix Wx , but the projected vectors directly . The following theorem gives the analytical solution in the dual form .
Theorem 3 . Let bK = 1
YY> , and λ1 ≥ . . . ≥ λN be its eigenvalues with eigenvectors v1 , . . . , vN , then if the latent space in SPPCA model is K dimensional , the following results hold:2
K + 1 σ2 y
σ2 x
( i ) The projection vectors of training data , which are en coded in rows of matrix Z , are calculated as
√ N VK D
1 2 R ,
Z = where D := I−N Λ −1 K , ΛK = diag(λ1 , . . . , λK ) , VK = [ v1 , . . . , vK ] , and R is an arbitrary K × K orthogonal rotation matrix .
( 19 )
−1
>
( ii ) Projection z∗ for new input x∗ is given as > ∗ K k(X , x
> K KVK + D
√ N R
∗ z with k(X , x∗ ) centered via ( 28 ) .
− 1 2
D
V
V
=
SPPCA , ie , bK = 1
It is seen from this theorem that when there is no output in K , SPPCA reduces to the dual form of PCA as desired . This theorem directly applies for non linear mappings if the inner product is defined in a reproducing kernel Hilbert space ( RKHS ) [ 16 ] , and leads to the kernel PCA solution when L = 0 .
σ2 x
Theorem 3 presents a nice explanation for SPPCA model : we just use the outputs to modify the Gram matrix of input data , and control the trade off via the ratio of noise levels . The model complexity remains the same ( ie , quadratic in N ) no matter how many output dimensions we have . Our previous work [ 20 ] shares this same property and derives the supervised projection via an eigenvalue problem . But it cannot be elegantly extended to semi supervised projections , and has problems to deal with large scale data sets . 5.3 Discussions
Previous two subsections give some theoretical results for SPPCA model . There exists however no such a closed form solution for S2PPCA . One can only empirically analyze the behavior of this model .
In the EM learning algorithm we are learning the maximum likelihood ( ML ) estimates for the two mapping matrices Wx and Wy . In the probabilistic framework we can also assign a prior to them to reduce overfitting . For instance , we can assign an isotropic Gaussian prior for each column of Wx , and if we consider the maximum a posteriori ( MAP ) estimate this prior corresponds to a smooth term in the update equations . For simplicity we do not consider this prior here .
6 . EXPERIMENTS
In this section we empirically investigate the performance of SPPCA models . The supervised tasks here are multiclass classification and multi label classification . Our basic setting is that we train a supervised projection model using the input features and label information , and then test the classification performance for test data using the projected features . Since the test data are assumed known in the training phase , for S2PPCA we will be able to use these unlabeled data to train the mapping . 2We use the same notation for eigenvalues as in Theorem 2 because it can be proved that they are identical up to a scaling factor of N .
Table 1 : Statistics of the multi class data sets ( top ) and multi label data sets ( bottom )
Category # Data # Dim # Class
Yale ORL PIE
YaleB
11 Tumors 14 Tumors
Lung Cancer 20Newsgroup
TDT2
Face Face Face Face Gene Gene Gene Text Text
165 400
11554 2414 174 308 203
19928 8692
1024 1024 1024 1024 12533 15009 12600 25284 35452
15 40 68 38 11 26 5 20 20
) ,
Category # Data # Dim # Class
Yeast RCV1
Gene Text
2417 23149
103
15500
14 103
6.1 Data Sets
We test the proposed model on 9 multi class and 2 multilabel classification problems . These problems include face recognition , gene classification and text categorization . Some statistics of these data sets are shown in Table 1 .
For face recognition we use four data sets Yale , ORL , PIE and YaleB ( the extended Yale Face Database B).3 The Yale data set contains 165 gray scale images in GIF format of 15 individuals . There are 11 images per subject , one per different facial expression or configuration such as center light , left light , happy or surprised . The ORL database contains 10 different images of each of 40 distinct subjects . For some subjects , the images were taken at different times with varying lighting and facial details . The PIE databases we use contains 170 images for each of 68 people . These images are the five near frontal poses under different illuminations and expressions . For YaleB we have 38 individuals and around 64 near frontal images under different illuminations per individual . All the face images are manually aligned , cropped and resized to 32× 32 pixels . We then normalize each image to have Euclidean distance 1 .
We consider three gene expression data sets 11 Tumors , 14 Tumors and Lung Cancer for gene classification.4 The 11 Tumors describes 11 various human tumor types , and 14 Tumors describes 14 tumor types with 12 normal tissue types . For Lung Cancer we need to classify 4 lung cancer types and normal tissues . The characteristic of these data is that the number of data points is small , but the input dimensionality is very high .
The two textual data sets we use are taken from 20Newsgroup and TDT2 . 20Newsgroup contains 20,000 news articles posted in 20 news groups . We remove the words that occur less than 5 times , and obtain 19,928 documents with 25,284 words . The TDT2 corpus we use consists of the documents collected during the first half of 1998 and taken from 6 sources , including 2 newswires ( APW , NYT ) , 2 radio programs ( VOA , PRI ) and 2 television programs ( CNN , ABC ) . It consists of 11,021 documents which are classified into 96 semantic categories . In our experiments , we keep the largest 20 categories and remove those documents that are assigned to more than one categories . This leaves us 8,692 documents with totally 35,452 words . For both of these data sets we 3See http://wwwewsuiucedu/∼dengcai2/Data/datahtml 4They are available at http://wwwgems systemorg
Table 2 : Results for Multi class Classification Tasks . Bold face indicates lowest error rate . Symbols ? indicate that the best method is significantly better than the competitors ( p value 0.01 in Wilcoxon rank sum test ) .
Task Yale ORL PIE
YaleB
11 Tumors 14 Tumors
Lung Cancer 20Newsgroup
TDT2
Full
0.5656 ± 0.0394 0.3308 ± 0.0347 0.6988 ± 0.0085 0.6360 ± 0.0160 0.3161 ± 0.0566 0.6084 ± 0.0360 0.3680 ± 0.1148 0.6135 ± 0.0155 0.1875 ± 0.0233
Task Yale ORL PIE
YaleB
11 Tumors 14 Tumors
Lung Cancer 20Newsgroup
TDT2
Full
0.5656 ± 0.0394 0.3308 ± 0.0347 0.6988 ± 0.0085 0.6360 ± 0.0160 0.3161 ± 0.0566 0.6084 ± 0.0360 0.3680 ± 0.1148 0.6135 ± 0.0155 0.1875 ± 0.0233
PLS
0.6440 ± 0.0383 0.5505 ± 0.0294 0.8781 ± 0.0058 0.9546 ± 0.0066
PCA
LDA
0.6690 ± 0.0333 0.5593 ± 0.0263 0.9325 ± 0.0032 0.9895 ± 0.0023 0.5409 ± 0.0490 0.7363 ± 0.0286 0.3768 ± 0.0939 0.9070 ± 0.0177 0.6664 ± 0.0657
0.6133 ± 0.0471 0.5302 ± 0.0444 0.7066 ± 0.0177 ?0.5328 ± 0.0251 0.4505 ± 0.0755 0.7161 ± 0.0481 0.3225 ± 0.1658 0.9140 ± 0.0208 0.7834 ± 0.0782
N/A N/A N/A N/A N/A ( a ) Projection dimension K = 5 .
LDA
PLS
0.5698 ± 0.0386 0.4048 ± 0.0349 0.8062 ± 0.0068 0.8762 ± 0.0108
PCA
0.5993 ± 0.0312 0.4049 ± 0.0293 0.8573 ± 0.0051 0.9308 ± 0.0046 0.3682 ± 0.0655 0.6868 ± 0.0288 0.3493 ± 0.0996 0.9039 ± 0.0172 0.5531 ± 0.0742
0.5279 ± 0.0460 0.3625 ± 0.0468 0.5496 ± 0.0185 ?0.3846 ± 0.0282 0.3926 ± 0.0667 0.6212 ± 0.0430 0.3225 ± 0.1658 0.8943 ± 0.0292 0.6878 ± 0.1068
N/A N/A N/A N/A N/A ( b ) Projection dimension K = 10 .
SPPCA
0.7007 ± 0.0402 0.5459 ± 0.0305 0.8780 ± 0.0116 0.9701 ± 0.0088 0.5226 ± 0.0636 0.7312 ± 0.0371 0.4287 ± 0.1338 0.9030 ± 0.0162 0.6236 ± 0.0739
S2PPCA
0.7121 ± 0.0393 0.5287 ± 0.0286 0.8452 ± 0.0037 0.9800 ± 0.0034 0.5130 ± 0.0491 0.7138 ± 0.0296 0.3896 ± 0.0923 0.9126 ± 0.0116 ?0.3686 ± 0.0349
SPPCA
0.6101 ± 0.0447 0.3832 ± 0.0409 0.7105 ± 0.0161 0.7976 ± 0.0242 0.3801 ± 0.0624 0.6322 ± 0.0363 0.6235 ± 0.1520 0.8931 ± 0.0242 0.5346 ± 0.0885
S2PPCA
0.5916 ± 0.0433 0.3509 ± 0.0287 0.6942 ± 0.0047 0.7986 ± 0.0117 ?0.3297 ± 0.0664 0.6120 ± 0.0331 0.3517 ± 0.1063 0.8548 ± 0.0138 ?0.2794 ± 0.0327
Task Yale ORL PIE
YaleB
11 Tumors 14 Tumors
Lung Cancer 20Newsgroup
TDT2
Full
0.5656 ± 0.0394 0.3308 ± 0.0347 0.6988 ± 0.0085 0.6360 ± 0.0160 0.3161 ± 0.0566 0.6084 ± 0.0360 0.3680 ± 0.1148 0.6135 ± 0.0155 0.1875 ± 0.0233
PCA
0.5437 ± 0.0414 0.3323 ± 0.0310 0.7999 ± 0.0060 0.8304 ± 0.0096 0.3267 ± 0.0635 0.6379 ± 0.0360 0.3584 ± 0.0953 0.9160 ± 0.0220 0.4582 ± 0.1441
LDA
0.5793 ± 0.0438 0.2944 ± 0.0398 0.4352 ± 0.0186 ?0.3004 ± 0.0227 0.3926 ± 0.0667 0.5822 ± 0.0388 0.3225 ± 0.1658 0.8001 ± 0.0425 0.1524 ± 0.0622
PLS
0.5216 ± 0.0435 0.3366 ± 0.0331 0.7454 ± 0.0092 0.7695 ± 0.0148
N/A N/A N/A N/A N/A
SPPCA
0.5093 ± 0.0391 0.3271 ± 0.0372 0.5912 ± 0.0146 0.5619 ± 0.0276 0.4470 ± 0.0691 0.5669 ± 0.0347 0.6487 ± 0.1540 0.6254 ± 0.0420 0.1566 ± 0.0509
S2PPCA
0.5001 ± 0.0589 0.2755 ± 0.0286 0.5361 ± 0.0090 0.5652 ± 0.0172 0.3012 ± 0.0582 0.5674 ± 0.0372 0.4092 ± 0.1107 0.6568 ± 0.0146 0.1520 ± 0.0210
( c ) Projection dimension K = 20 . use TF IDF features and normalize each document to have Euclidean distance 1 .
For multi label classification we use Yeast and RCV1 . The Yeast data set is formed by micro array expression data and phylogenetic profiles with 2,417 genes in total and 103 input dimensions . There are 14 groups and each gene can belong to multiple groups . The other data is a subset of the RCV1v2 text data set , provided by Reuters and corrected by Lewis et al . [ 11 ] . We use the training set provided by Lewis , which contains 103 labels , 23,149 documents with 15,500 words after we remove words that occur less than 5 times . We also extract TF IDF features and normalize each document to have Euclidean distance 1 . 6.2 Experimental Setting
For the multi class classification tasks , we randomly pick up a small number of labeled data points for training ( 2 for those data sets with less than 500 data points , and 5 for the others ) , and test the classification error rate on the unlabeled data . We will in general compare the following six algorithms if applicable :
• PCA : Unsupervised projection . Note that we use both the training and test data to derive the mapping .
• LDA : Linear discriminant analysis . • PLS : Partial least squares . • SPPCA : Supervised probabilistic PCA . • S2PPCA : Semi supervised probabilistic PCA . We allow S2PPCA to use the test data to train the mapping .
• Full : All the features are used without projection .
For all the projection methods , we project the data into a space of 5 , 10 and 20 dimensions , and train a nearestneighbor classifier for the test points using new features with Euclidean distance . For Full we directly train the nearestneighbor classifier using original features . For PLS , SPPCA and S2PPCA , we translate the one column output to the “ One of C ” setting , ie , each class has one column with binary labels .
For multi label classification , we pick up 5 positive examples from each label to obtain the training data . For all projection methods we project to 5 , 10 and 20 dimensions , and then train a linear SVM classifier for each label . The comparison metrics are F1 Macro , F1 Micro and AUC ( Area Under ROC Curve ) score . The candidate algorithms are almost the same as multi class setting , except LDA which is not applicable to this task . The C in SVM is fixed as 100 , and from our experience it is not sensible for all algorithms . In all these comparisons , the iteration number for SPPCA x and σ2 and S2PPCA is set to 1000 . Both the noise levels σ2 y are set to 10−5 initially . It turns out that PLS gets memory problems when applied to large dimensions . We repeat each experiments 50 times independently,5 and the results are illustrated in . 6.3 Analysis of Results
The first observation is that in most cases the supervised
5For the four face recognition tasks we use the split versions available from the web site .
Table 3 : Results for Multi label Classification Tasks . Bold face indicates best performance .
K
Model
5
10
20
Full PCA PLS
SPPCA S2PPCA
Full PCA PLS
SPPCA S2PPCA
Full PCA PLS
SPPCA S2PPCA
F1 Macro
0.3813 ± 0.0102 0.2318 ± 0.0354 0.3432 ± 0.0231 0.3823 ± 0.0120 0.3927 ± 0.0134 0.3813 ± 0.0102 0.3113 ± 0.0304 0.3756 ± 0.0154 0.3924 ± 0.0117 0.3985 ± 0.0103 0.3813 ± 0.0102 0.3723 ± 0.0171 0.3799 ± 0.0123 0.3859 ± 0.0133 0.3976 ± 0.0142
Yeast
F1 Micro
0.5161 ± 0.0154 0.5600 ± 0.0220 0.5795 ± 0.0233 0.5332 ± 0.0188 0.5890 ± 0.0126 0.5161 ± 0.0154 0.5916 ± 0.0146 0.5517 ± 0.0177 0.5459 ± 0.0180 0.5914 ± 0.0106 0.5161 ± 0.0154 0.5537 ± 0.0204 0.5208 ± 0.0158 0.5517 ± 0.0151 0.6012 ± 0.0190
AUC
0.5571 ± 0.0094 0.5279 ± 0.0108 0.5556 ± 0.0094 0.5641 ± 0.0087 0.5842 ± 0.0104 0.5571 ± 0.0094 0.5493 ± 0.0101 0.5610 ± 0.0095 0.5685 ± 0.0084 0.5896 ± 0.0107 0.5571 ± 0.0094 0.5614 ± 0.0097 0.5585 ± 0.0102 0.5640 ± 0.0097 0.5921 ± 0.0119
F1 Macro
N/A
0.2796 ± 0.0055 0.0467 ± 0.0063 0.1155 ± 0.0071 0.1312 ± 0.0118 0.2796 ± 0.0055 0.0843 ± 0.0124 0.1797 ± 0.0112 0.1956 ± 0.0110 0.2796 ± 0.0055 0.1320 ± 0.0086 0.2297 ± 0.0119 0.2536 ± 0.0117
N/A
N/A
RCV1
F1 Micro
N/A
0.5053 ± 0.0095 0.3540 ± 0.0106 0.4433 ± 0.0089 0.4620 ± 0.0236 0.5053 ± 0.0095 0.4003 ± 0.0162 0.4474 ± 0.0124 0.4735 ± 0.0198 0.5053 ± 0.0095 0.4419 ± 0.0095 0.4690 ± 0.0126 0.4921 ± 0.0102
N/A
N/A
AUC
N/A
0.6030 ± 0.0063 0.5208 ± 0.0072 0.5568 ± 0.0079 0.5762 ± 0.0162 0.6030 ± 0.0063 0.5347 ± 0.0072 0.5872 ± 0.0087 0.6012 ± 0.0098 0.6030 ± 0.0063 0.5504 ± 0.0061 0.6044 ± 0.0054 0.6090 ± 0.0076
N/A
N/A
PCA model is better than unsupervised PCA model . This means by using the output information , we are able to derive a more meaningful projection for the supervised tasks . When the dimensionality is larger ( eg , 20 ) , SPPCA and S2PPCA obtain the best results for most of the tasks .
When we compare SPPCA model with other supervised projection methods , SPPCA is consistently better than PLS , but in some tasks worse than LDA ( eg , for YaleB ) . The reasons may be that SPPCA models are still based on the PCA assumptions for input features , so the mapping is strongly biased by PCA . When PCA projection directions are almost useless for classification , like for YaleB dataset , the SPPCA projections are also not informative enough . In this case discriminative methods like LDA can often do a good job . In other situations where PCA does help , SPPCA can in general be better than pure discriminative methods .
When we compare SPPCA and S2PPCA , in most cases S2PPCA gets better results . For some tasks the difference is very big ( eg , for TDT2 ) . This indicates that by incorporating the unlabeled data we can learn a better mapping . But S2PPCA is in general slower than SPPCA because it has to consider all the test data in the training phase . In this case 1000 iterations may be not enough to get the algorithm converge . This may also be part of the reason why S2PPCA is inferior to other methods for some tasks like PIE .
Most of the supervised projection methods can get a better performance than Full even if they only project the data into a very low dimensional space . This is important because we can not only speed up the system , but also improve the performance . PCA in our experiments uses the input features of both labeled and unlabeled data , thus it sometimes can get better results than Full method ( eg , for Yale and Lung Cancer ) .
The results for multi label classification show that S2PPCA is consistently better than other methods . S2PPCA also shows very good scalability in our experiments , since for 20Newsgroup and RCV1 it need to handle 20,000 documents with more than 15,000 features . Most of the other algorithms fail on these large data sets .
7 . CONCLUSION
We proposed a supervised PCA and a semi supervised PCA in this paper , and derived an efficient EM algorithm for model learning . Empirical results show that the proposed model obtains good performance and scales well for large data sets .
In this paper we mainly focus on the Gaussian noise model for the outputs y . One can define other likelihood models for specific tasks , eg , the probit likelihood for classification , but then we lose the nice closed form solutions as described in Theorem 2 and 3 . This is because in E step of the EM learning the a posteriori distribution of z is no longer a Gaussian ( see ( 2) ) . To solve this problem we can apply the expectation propagation ( EP ) [ 13 ] algorithm to sequentially approximate each likelihood term P ( y‘|z ) as a Gaussian for z . Then the approximated a posteriori distribution of z is still a Gaussian , and the EM algorithm can still be applied to find the optimal projection matrices . Empirically comparing this algorithm with the basic ones would be part of the future work .
8 . REFERENCES [ 1 ] E . Bair , T . Hastie , D . Paul , and R . Tibshirani . Prediction by supervised principal components . Technical report , 2004 .
[ 2 ] S . C . Deerwester , S . T . Dumais , T . K . Landauer , G . W . Furnas , and R . A . Harshman . Indexing by latent semantic analysis . Journal of the American Society of Information Science , 41(6):391–407 , 1990 .
[ 3 ] A . P . Dempster , N . M . Laird , and D . B . Rubin .
Maximum likelihood from incomplete data via the EM algorithm ( with discussion ) . Journal of the Royal Statistical Society B , 39:1–38 , 1977 .
[ 4 ] R . O . Duda , P . E . Hart , and D . G . Stork . Pattern
Classification . Wiley , 2000 .
[ 5 ] T . Evgeniou and M . Pontil . Regularized multi task learning . In Proceedings of SIGKDD , 2004 .
[ 6 ] K . Fukumizu , F . R . Bach , and M . I . Jordan .
Dimensionality reduction for supervised learning with reproducing kernel Hilbert spaces . Journal of Machine Learning Research , 5(Jan):73–99 , 2004 .
[ 7 ] T . Hastie and R . Tibshirani . Discriminant analysis by
Gaussian mixtures . Journal of the Royal Statistical Society series B , 58:158–176 , 1996 .
[ 8 ] T . Hastie , R . Tibshirani , and J . Friedman . The
Elements of Statistical Learning . Springer Verlag , 2001 .
[ 9 ] H . Hotelling . Relations between two sets of variables .
Biometrika , 28:321–377 , 1936 .
[ 10 ] I . T . Jolliffe . Principal Component Analysis . Springer
Verlag , 2002 .
[ 11 ] D . D . Lewis , Y . Yang , T . Rose , and F . Li . RCV1 : A new benchmark collection for text categorization research . Journal of Machine Learning Research , 5:361–397 , 2004 .
[ 12 ] R . G . Miller . Beyond Anova : Basics of Applied
Statistics . John Wiley , 1986 .
[ 13 ] T . P . Minka . A family of algorithms for approximate
Bayesian inference . PhD thesis , Massachusetts Institute of Technology , 2001 .
[ 14 ] S . Roweis and Z . Ghahramani . A unifying review of linear Gaussian models . Neural Computaion , 11(2):305–345 , 1999 .
[ 15 ] S . Roweis and L . Saul . Nonlinear dimensionality reduction by locally linear embedding . Science , 2000 . [ 16 ] B . Sch¨olkopf and A . J . Smola . Learning with Kernels .
MIT Press , 2002 .
[ 17 ] M . E . Tipping and C . M . Bishop . Probabilistic principal component analysis . Journal of the Royal Statisitical Scoiety , B(61):611–622 , 1999 .
[ 18 ] H . Wold . Soft modeling by latent variables ; the nonlinear iterative partial least squares approach . Perspectives in Probability and Statistics , Papers in Honour of MS Bartlett , 1975 .
[ 19 ] J . Ye , R . Janardan , Q . Li , and H . Park . Feature extraction via generalized uncorrelated linear discriminant analysis . In Proceedings of ICML , 2004 .
[ 20 ] K . Yu , S . Yu , and T . Volker . Multi label informed latent semantic indexing . In Proceedings of 27th Annual International ACM SIGIR Conference , 2005 .
APPENDIX A . DERIVATION OF DUAL FORM and
X =
!
!
X1 X2
We only focus on S2PPCA model here . Let C = C1 + C2 ,
! then ( 13 ) can be written as fWx = X>ZC−1 . This leads to xfWx = C fW
−1 , fW
X1X> X2X>
> x x = C k(X , x ) , ( 20 )
, K = XX
K1 K2
−1Z
−1Z
!
Z1 Z2
, Z =
KZC
=
=
>
>
>
> which are the building blocks for the dual form . The matrix K = XX> has each entry the inner product of data points of corresponding row and column , Kij = x> i xj , and k(X , x ) = Xx is a N dimensional column vector with the i th entry x> i x . In the E step , we first rewrite A as −1 1 Z
−1 1 + I .
> 1 YY
−1 +
−1Z
KZC
Z1C
C
C
>
>
1 σ2 y
Applying ( 20 ) in sufficient statistics ( 5 ) , we get
1 σ2 x eA = eZ1 =
1 eA
−1
−1 +
1 σ2 y
>
−1 Z1C 1
σ2 x
K1ZC
( 21 ) by collecting hzni in columns and transposing it . Sufficient statistics ( 6 ) can be written in terms of C1 :
YY
, n i = N1eA
−1
+eZ
1eZ1 .
> hznz >
( 22 ) eC1 =
N1X n=1
Similarly , we obtain the following two updates for unlabeled
1
σ2 x data:eZ2 = eC2 = N2
1 σ2 x
1
σ2 x
−1
K2ZC
−1Z
C
>
KZC
−1 + I
−1Z
C
>
KZC
−1 + I h h tr(K ) − tr(eZ ) − tr(eZ
>
> tr(YY
KeZeC
−1
>
YY
−1
+eZ i >eZeC
)
,
˜σ2 x =
˜σ2 y =
1
M N
1 LN
−1 2eZ2 .
>
,
( 23 )
( 24 ) i
)
,
( 25 )
( 26 )
−1
In M step , we only need to update variances σ2 x and σ2 y as which can be easily verified from ( 9 ) and ( 10 ) .
Therefore , it is seen that all interesting terms in the EM algorithm take input data into account only via the innerproduct . This nice property allows us to extend the linear SPPCA model to non linear mappings by first mapping the input data into a new feature space ( via , eg , basis functions ) and then performing SPPCA in that space . This can also be done via kernel trick for which we only need to define a kernel function κ(·,· ) for each pair of input data [ 16 ] .
Since we are now working on centered data in the feature eK = K − 1 space , we can achieve this by modifying K as > 1 N 2 11
K − 1 N
K11
11
N
+
>
>
>
K11
,
( 27 ) where 1 denotes the all one column vector of length N [ 16 ] . For kernel vector k(X , x∗ ) , it can also be centered by
˜k = k − 1 N
>
11 k − 1 N
K1 +
> 1 N 2 11
K1 .
( 28 )
B . PROOF OF THEOREM 2
W>
W> x , 1 σy
We give a sketch here . The mapping matrices are obtained by finding a fixed point in the EM algorithm in Section 4 . y )> , For this proof we use notation W := ( 1 σx and ( 3 ) can be rewritten as A = W>W + I . Plugging this and ( 5 ) , ( 6 ) into ( 8 ) yields an update equation only related to W : fW = SW.W>SW + W>W + Ifi−1,W>W + I .
At the fixed point , this simplifies to SW = WW>W + W . Let W = UDV> be the SVD of W . Then each column u of U satisfies dSu = ( d + d3)u , with d the corresponding singular value . Therefore solving an eigenvalue problem for S gives the mapping matrix W , and plugging them into ( 4 ) gives the mapping z∗ for x∗ . fi
( 21 ) and ( 22 ) using only B . This leads to N B
C . PROOF OF THEOREM 3
We give a sketch here . We define B = ZC−1 and rewrite =
I + B>bKB bKB . To solve B we denote the SVD of B>bKB as QDQ> , we have U>U = I and U>bKU = N ( I + D ) . This clearly defines a SVD for bK , so by definition we have Λ = N ( I + D ) . U,I − N Λ−1 1/2 Q> . This recovers ( 19 ) with R = Q> ,
−1 Q> after some then we can obtain B>B = 1 √ N D−1/2 ( I + D)1/2 , mathematics . Then define U := BQ
Then we can solve for B from U and Λ , which yields B = 1√ N and the update equation for new test data can be easily obtained . fi
N QD ( I + D )
