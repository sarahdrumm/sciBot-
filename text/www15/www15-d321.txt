PTHMM : Beyond Single Specific Behavior Prediction
Suncong Zheng , Hongyun Bao , Guanhua Tian , Yufang Wu , Bo Xu , Hongwei Hao
{suncongzheng,hongyunbao,guanhuatian,yufangwu,boxu,hongweihao}@iaaccn
Institute of Automation Chinese Academy of Sciences
Beijing , 100190 , China
ABSTRACT Existing works on user behavior analysis mainly focus on modeling a single behavior and predicting whether a user will take an action or not . However , users’ behaviors do not always happen in isolation , sometimes , different behaviors may happen simultaneously . Therefore , in this paper , we try to analyze the combination of basic behaviors , called behavioral state here , which can describes users’ complex behaviors comprehensively . We propose a model , called Personal Timed Hidden Markov Model ( PTHMM ) , to settle the problem by considering time interval information of users’ behaviors and users’ personalization . The experimental result on sina weibo demonstrates the effectiveness of the model . It also shows that users’ behavioral state is affected by their historical behaviors , and the influence of historical behaviors declines with the increasing of historical time .
Categories and Subject Descriptors H.0 [ Information Systems ] : General
Keywords User behavior ; User modeling ; Microblogging ; Sequential model ; Social Media
1 .
INTRODUCTION
With the rise of social media , people are given more opportunities to exhibit different behaviors on internet such as sharing , posting , commenting , and befriending . Among the various successful social media , the microblogging service is one of the most popular social media and has great wealth of both textual and behavioral data . It provides us with a good platform to analyze users’ diverse behaviors .
Motivating Example . People on microblogging platform s can either share information or interact with each other . They can even experience different behaviors simultaneously . For example , Figure 1 illustrates the phenomenon in Sina Weibo . When user “ RainBowSun1 ” reposts a piece of
Copyright is held by the International World Wide Web Conference Committee ( IW3C2 ) . IW3C2 reserves the right to provide a hyperlink to the author ’s site if the Material is used in electronic media . WWW 2015 Companion , May 18–22 , 2015 , Florence , Italy . ACM 978 1 4503 3473 0/15/05 . http://dxdoiorg/101145/27409082742465 tweet from “ BBCWorld ” , he also interacts with his friend “ zsc ” simultaneously and takes part in the topic of “ The Missing Malaysia plane ” . How should we describe RainBowSun1 ’s behaviors and what is RainBowSun1 ’s real intention ? In order to depict RainBowSun1 ’s such complex behaviors , we define the behavioral state as the combination of basic behaviors , which can describes users’ complex behaviors comprehensively . However , existing works on user behavior
Figure 1 : Example of behavioral state ( the combination of basic behavioral information ) analysis mainly focus on modeling the specific behavior and predicting whether a user will take an action or not[1 , 4 , 5 ] . Different from these works , the task , in this paper , is to analyze users’ various combinations of basic behaviors and to predict users’ behavioral states in future .
Model Description . Many potential factors affect users’ behavioral states , which may be users’ habit , current mood , environmental events or others . These factors are cyclical and invisible , but they can trigger users’ specific behaviors and are reflected from users’ behavioral data . Thus , modeling users’ historical behaviors based on a latent variable is beneficial to understand users’ behavioral characteristics and predict future behaviors . We call the latent variable as behavioral pattern and it can represent these periodic factors . Besides , users’ actions have strong time relationship with their historical behaviors[4 ] and everyone has its own personality when using the microblogging service . Motivated by these intuitions , we propose an unsupervised model , Personal Timed Hidden Markov Model ( PTHMM ) , to predict users’ behavioral states . We first train a global model called THMM based on all users’ behavioral data . When predicting users’ behavioral state , we take a personal strategy to fine tune the global model to make it more adaptable for all kinds of users . Different from classical HMM model , PTHMM not only captures chronological information of behavioral sequences but also considers the time interval information between two adjacent behaviors and users’ personalization .
829 2 . BEHAVIORS ANALYSIS
The task in this paper is to analyze users’ complex behaviors and to predict users’ behavioral states . Therefor , the first work we need to determine is the basic behaviors selected to represent users’ behavioral states in microblogging . The basic behaviors should have following characteristics : 1 ) Typical : All basic behaviors emphasize different aspects of users’ behaviors and reflect one of typical characteristics of behavior ; 2 ) Elementary : Each basic behavior must be as simple as possible ; 3 ) Comprehensive : The combinations of basic behaviors should cover most of behaviors in microblogging .
Java et al.[2 ] and Zhang et al.[6 ] have analyzed the characteristics of users’ behaviors and classified them into three main categories in microblogging . These categories can be summarized as following : sharing , interaction and mention oneself . The basic behaviors meet the constraint of “ typical ” , when choosing from these three categories .
Sharing Because of the property of “ self media ” , sharing information is the most common behaviors in microblogging platform . When user share information , he can either publish informative tweets or just re tweet informative tweets from others . Hence , we divide sharing information into two parts : one is posting original informative tweets which reflects users’ initiative to share information and the other is reposting other ’s tweets which reflect user ’s passive to share information . Besides , we can easily judge whether a user is sharing information or not in microblogging . Because a piece of informative tweet always contains URL,video or picture and it also can attract many users’ attention to repost it or comment it .
Interaction Microblogging also has the property of social network . Users in microblogging usually interact with their friends or participate in group topics . Microblogging provides various mechanisms for users to interact with each other . Therefore , based on different kinds of interaction behaviors , we subdivide interaction behaviors into three parts : the first one is to use symbol ’@’ to attract friends’ attention ; the second is to repost or comment the tweet of friends ; the third is to participate in topic group . Among them , the former two are both interacting with friends : one is initiative to seek friends conservation , the other is just to response to friends . The last one is interacting with a group of people . Mention oneself Many users like to post tweets to talk about their daily routine or what they are doing and feeling currently in microblogging . A tweet about mentioning oneself is always the plain text generated by the user , and the tweet may also contains the information of location check in . However , due to the diversity of users’ behaviors in microblogging , the above three categories of behaviors can not cover all kinds of behaviors . Apart from these , we append “ the others ” category to denote a kind of special behavioral state . We sum up the dataset which contains 4,018,012 tweets and obtain the distribution of the all basic behaviors shown in Table 1 . It shows that the three categories cover most behaviors in microblogging and the remainder only occupy 8 % , which means the choose behaviors can meet the requirement of comprehensive . Each behavioral state is represented by a 6 dimension vector , and each dimension of the vector represents one of the six behaviors . Accordingly , the behavior state of “ the others ” is a 6 dimension vector with all dimension equal to zero . Therefore , users’ behavioral state in microblogging is fully depicted .
Table 1 : Distribution of all basic behaviors .
Basic behavior post information repost information seek conversation response to friends . participate in group
Category sharing sharing interaction interaction interaction
Ratio 6.64 % 36.26 % 10.48 % 4.63 % 12.27 21.72 8.00 % mention oneself mention oneself
—– the others
3 . PERSONAL TIMED HIDDEN MARKOV
MODEL
In this section , we formulate the problem of predicting users’ behavioral states based on their historical data .
3.1 Notation
For the convenience of description , we firstly give the no tations of model elements : Behavioral state B : A behavioral state is be obtained by parsing its corresponding tweet content , and it is denoted as a 6 dimension vector : B = {b1 , b2b6} When bi = 1 means current tweet contains the basic behavior bi else not . Users U : The behavioral data of each user is represented by two sequences : one is behavioral state sequence and the other is time sequence accordingly . We denote user m as following form : Um = {Um(B ) , Um(t)} , where Um(B ) = {B1 , B2 , Bn} and Um(t ) = {t1 , t2 , tn} , n is the total tweets’ number of user m . Behaviors pattern Z : To describe users’ periodic factors that can affect users’ behavioral states , we introduce a latent variable named behavioral pattern . The set of behavioral patterns shared by all users is denoted as Z = {z1 , z2 , zk} , where k is the number of behavior patterns . Model parameters Θ : PTHMM ’s parameters are the same as HMM . It concludes : transfer probability of behavioral patterns p(zj|zi ) , the relationship between behavioral patterns and behavioral states P ( Bi|zk ) and the probability distribution of behavioral pattern P ( Z ) .
3.2 The Framework of PTHMM
The framework of PTHMM is shown in Figure 2 , and it contains two main procedures : global training and personal inference . In the stage of global training , we take advantage of all users’ behavioral data to train the global model : THMM , which is reflect the general behavioral characteristics that all users shared . However , each person has his own personality . When predicting user m ’s state , we take a personal strategy to fine tune the global model to make it more adaptable for all kinds of users and the personal inference process will be detailed in section 322
321 Training of THMM In this section , we present the global training procedure of our approach . As all we know , HMM is the classical model for inferring hidden state sequences from observed variables[3 ] . However users’ behaviors have strong relationship with the time interval . Classical HMM only takes sequences’ chronological information into consideration , which can’t not fully capture the law of users’ behavior . Therefore , the proposed THMM can make up this problem by taking time interval information into consideration .
830 L l=1
P ( Bi|zk ) =
γl(k ) × δ(Bl , Bi )
L l=1
γl(k )
( 7 )
322 Personal Inference THMM captures the common behavioral rules that all people shared . However , each user has his own personalities . In order to combine the commonness and personalities , we take the personalized strategy to fine tune the global THMM . When predicting user m ’s behavioral state , we use m ’s historical behavior data P ( H(Um(B) ) ) to re estimate the behavioral pattern distribution Pm(Z ) of m and behavior |zl patterns transformation law Pm(zl+1 i ) based on formula 1 to 6 . At last , a user ’s behavioral state at time L + 1 can be computed as : j
BL+1 = argm B ax
Pm(zL i ) · Pm(zL+1 j
|zL i ) · P ( B|zL+1 j
)
K
K j=1 i=1
( 8 ) Where P ( zL i ) means the probability of behavioral pattern at time L . It can be calculated by decoding behavior state sequences with the help of viterbi algorithm[3 ] .
4 . EXPERIMENTS 4.1 Data Set and Experimental Setup Dataset We constructed the dataset based on the SinaWeibo platform , one of the most popular microblogging in China . The data used in this experiment is randomly choose from the ordinary accounts and filtered out the users who post less than 50 tweets . For each user , we craw all of his tweets which can describe their behavioral track in SinaWeibo completely . Finally , the dataset consists of 3500 users with 4,018,012 tweets . For evaluation , we randomly choose 500 users as the test set and the left 3000 users as the train set . Metric The final task is to predict the combinations of basic behaviors . Based on the characteristics of the problem , we focus on the similarity between predicted state and actual state . Therefore , the evaluation metric we used is acc@w , where w refers to the wrong number we make and acc means the accuracy of predicted results . For example , acc@0 means the precision when we predict all behaviors correctly . Accordingly acc@1 means the precision when we miss to predict one of the 6 behaviors . The smaller of w , the more similar between prediction state and actual behavior state . In this paper , we just consider the results of acc@0 and acc@1 , which are more useful and insightful . Baselines Because of the unsupervised properties of the task , supervised sequential models such as CRF is invalid . To evaluate the performance of PTHMM , we consider three common unsupervised methods as baselines :
TF is the term frequency , which is wildly used in text retrieval . Here , it just account the behaviorial state frequency information . We choose the most common behaviorial state of user to represent his future behaviorial state .
MM is the markov model . Compared with TF , MM considers the chronological information of behavioral sequence . HMM have been proven to be effective in a variety of sequences applications . Different from the above models , it takes user ’s hidden behavioral pattern into consideration .
Figure 2 : The Framework of PTHMM
We use γl(zk ) to denote the distribution of behavioral pattern zk at time l and ξl(zi , zj ) to denote the joint distribution of two successive behavioral patterns , which means behavioral pattern is zi at time l and zj at time l+1 . Similar to the HMM , THMM also can be naturally cast in the framework of Expectation Maximization(EM ) , and the difference is about updating γl(zk ) and ξl(zi , zj ) . We take the time interval factor into account . The smaller the two adjacent time interval is , the stronger influence the former behavior has on the later .
E step : fix Θ , then update γl(zk ) and ξl(zi , zj ) . In order to update the parameters , we take the Baum Welch algorithm[3 ] and ξl(zi , zj ) is computed as following : |Θ , U ( B ) , U ( t ) ) , U ( B)|Θ , U ( t ) )
ξl(zi , zj ) = P ( zl P ( zl j i , zl+1 i , zl+1 P ( U ( B)|Θ , U ( t ) ) , U ( B)|Θ , U ( t ) ) j i , zl+1 j
P ( zl i , zl+1 j
, U ( B)|Θ , U ( t ) )
= k=K
=
P ( zl j=K k=1 j=1 where P ( zl i , zl+1 j
, U ( B)|Θ , U ( t ) ) = P ( B1 , Bl , zl · P ( Bl+1|zj ) · P ( Bl+1Bn|zl+1 i ) · P ( zj|zi ) ) · P ( tl , tl+1 ) j
Especially , P ( tl , tl+1 ) capture the influence of time interval by modifying two adjacent behaviors’ relationship and we define the time interval factor as :
P ( tl , tl+1 ) = exp((tl+1 − tl)/Tmax )
( 3 ) where Tmax is the largest time interval in the sequence . After computing ξl(zi , zj),we just sum up ξl(zi , zj ) to get the variable of γl(zk ) as following :
γl(zk ) =
ξl(zi , zk )
( 4 )
( 1 )
( 2 )
( 5 )
( 6 )
M step : fix γl(zk ) and ξl(zi , zj ) , then update Θ . When giving γl(zk ) and ξl(zi , zj ) , the parameter Θ is computed as following : zi∈Z
P ( zk ) = γl(zk )
L−1 L−1 l=1 l=1
ξl(zi , zj )
γl(k )
P ( zj|zi ) =
UTweets Behaviors ParserU1U2Umt1t2tnB1B2Bnt1t2tnB1B2Bnt1t2tnB1B2BnBtTHMMGlobal TrainingPersonal InferencePTHMMUmt1t2tnB1B2BnBn iBn 1BnBn831 4.2 Prediction performance
The predicted results are reported in Table 2 . The sequential models achieve better results than TF that does not consider chronological information . Besides , these models that apply the latent factor of behavioral pattern such as HMM,THMM and PTHMM can bring substantial performance improvement to MM , which neglects the mechanism behind behaviors . THMM outperforms the classical HMM that does not consider the information of time interval . It suggests that time interval information is an important factor when analyzing users’ behaviors . Finally , the PTHMM shows a better result than THMM by considering user ’s own personality . It means that PTHMM is more adaptable for different kinds of people .
Table 2 : The predict results of different methods acc@0( % ) acc@1( % )
TF MM HMM THMM PTHMM 41.8 57.0
50.0 62.0
49.4 61.5
48.2 61.2
48.8 60.7
4.3 Analysis on time correlation
PTHMM is based on the intuition that user ’s action has a strong time relationship with his historical behaviors . When predicting behavioral state , we apply the viterbi algorithm to decode the latest historical behavioral sequences . The length of decoded sequence means the number of historical behaviors considered in the model when predicting future behavioral state . Figure 3 shows that both acc@0 and acc@1 rise with the increasing of predict length and achieve stability at last . The results reflect that users’ behavioral state is affected by their historical behaviors , and the influence of historical behaviors declines with the increasing of historical time , then it tend to be stable finally .
Figure 3 : Effect of Predict Length
Besides , we also compute the similarity between current behavioral state and its former N behavioral states . The statistical result , shown in Figure 4 , shows that users’ current behavioral states are most similar to the nearest behavioral state , and the similarity decreases with the time distance increasing , then achieves stability at last . The result of Figure 4 demonstrates the same behavioral property as Figure 3 does , which also strongly support the assumption of our model . 5 . CONCLUSIONS
In this paper , we formally formulate the problem of users’ behavioral states , which are the different combinations of
Figure 4 : The similarity between historical behavioral states and current behavioral state basic behavior information . Then we choose six basic behaviors to represent all kinds of behavioral states based on the analysis of users’ behaviors in Sina Weibo . We propose an unsupervised model called PTHMM to settle the problem by considering time interval information of behaviors and users’ personality . The experimental result on sina weibo demonstrates the effectiveness of PTHMM , and it also shows that users’ current behavioral state is affected by their historical behaviors , where the influence of the historical behaviors declines with the increasing of historical time . In future , we plan to examine the scalability of our method and experiment on more large scale datasets . Besides , we also need further analysis of tweets’ textual information to improve the representation of users’ behavioral states . 6 . ACKNOWLEDGMENTS
This research work was funded by the National Natural Science Foundation of China under Grant No.Y3FE191D61 , No.2015AA015402 , No.71402178 and No61303172 7 . REFERENCES [ 1 ] C . Budak and R . Agrawal . On participation in group chats on twitter . In Proceedings of the 22nd international conference on World Wide Web , pages 165–176 . International World Wide Web Conferences Steering Committee , 2013 .
[ 2 ] A . Java , X . Song , T . Finin , and B . Tseng . Why we twitter : understanding microblogging usage and communities . In Proceedings of the 9th WebKDD and 1st SNA KDD 2007 workshop on Web mining and social network analysis , pages 56–65 . ACM , 2007 .
[ 3 ] L . Rabiner . A tutorial on hidden markov models and selected applications in speech recognition . Proceedings of the IEEE , 77(2):257–286 , 1989 .
[ 4 ] C . Tan , J . Tang , J . Sun , Q . Lin , and F . Wang . Social action tracking via noise tolerant time varying factor graphs . In Proceedings of the 16th ACM SIGKDD international conference on Knowledge discovery and data mining , pages 1049–1058 . ACM , 2010 .
[ 5 ] Z . Xu , Y . Zhang , Y . Wu , and Q . Yang . Modeling user posting behavior on social media . In Proceedings of the 35th international ACM SIGIR conference on Research and development in information retrieval , pages 545–554 . ACM , 2012 .
[ 6 ] J . Zhang , Y . Qu , J . Cody , and Y . Wu . A case study of micro blogging in the enterprise : use , value , and related issues . In Proceedings of the SIGCHI Conference on Human Factors in Computing Systems , pages 123–132 . ACM , 2010 .
01020304050046048050056057058059060061062acc@0Predict LengthPTHMMacc@1 PTHMM020406080100000001002003004005006007008SimilarityDistance Previous Behaviors832
