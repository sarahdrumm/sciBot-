Repeat Consumption Recommendation Based on Users
Preference Dynamics and Side Information
Dimitrios Rafailidis
Aristotle University of Thessaloniki
Thessaloniki , Greece draf@csdauthgr
Alexandros Nanopoulos
Catholic University of Eichstät Ingolstadt
Ingolstadt , Germany alexandrosnanopoulos@kude
ABSTRACT We present a Coupled Tensor Factorization model to recommend items with repeat consumption over time . We introduce a measure that captures the rate with which the preferences of each user shift over time . Repeat consumption recommendations are generated based on factorizing the coupled tensor , by weighting the importance of past user preferences according to the captured rate . We also propose a variant , where the diversity of the side information is taken into account , by higher weighting users that have more rare side information . Our experiments with real world datasets from last.fm and MovieLens demonstrate that the proposed models outperform several baselines .
Categories and Subject Descriptors H28 [ Database Applications ] : Miscellaneous
Keywords Repeat consumption ; preference dynamics ; coupled tensor factorization
1 .
INTRODUCTION
User preferences can be fairly dynamic , since users tend to exploit a wide range of items and modify their taste accordingly over time . Temporal collaborative filtering with matrix [ 4 , 7 ] and tensor factorization techniques [ 3 ] can generate accurate recommendation , since they can capture the drifts in the rating behavior and the changes of user preference over time in a collaborative filtering fashion . However , users may repeatedly interact with items over time in several applications [ 2 ] ; for instance , visiting the same web sites , buying retail items from Amazon or implicitly interacting , such as artist listenings on last.fm or movie viewing from a specific genre on MovieLens . To account also for the fact that users’ side information , such as demographics , can improve the recommendation accuracy [ 5 ] , we present a basic CTF model and its variant W CTF , where the diversity of the side information is taken into account , by higher weighting the users that have more rare side information .
2 . THE PROPOSED CTF MODEL
Our basic CTF model [ 6 ] captures the shared latent factors across the time varying user preference data and the side information about the users . CTF consists of the following steps :
Modeling User Preferences and Side Information : Given the sets U , I and T of users , items and tags , as well as a tensor X 2 RjUjjIjjTj , each non empty tensor cell X ( u ; i ; t ) contains the number of interactions of user u to item i at the time period t . The time period can be days , months , or whole years , corresponding to the jTj different time slices jUj . jIj t of tensor X , with t 2 1 : : :jTj . The test time period , eg , the test month where the personalized recommendations have to be generated , is included in the last time slice jUj . jIjjTj , eg , the current 6 month period , of the tensor X . With respect to the users’ side information the u th , u 2 U , row of the auxiliary matrix Y corresponds In case of numerito the set D of attributes of user u . cal attributes , eg , age , we perform an equal width binning , where for each numerical entry in the matrix Y we store the respective number of the bin . In the case of categorical attributes , such county and gender , we calculate the c distinct categorical values and then we create a binary vector ci 2 Rc.1 , where 1 denotes the categorical attribute of user ui . Finally , we append the transformed numerical and categorical attributes to generate the final jDj attributes in matrix Y .
Down weighting past preferences : Given ( i ) a test period t within the current/last time slice jUj . jIjjTj of the tensor X ; cur I,the set of items that user u has interacted at the ( ii ) I u current/last time slice jUj . jIjjTj of X ; and ( iii ) I u prev I the set of items that user u has interacted at all the previous t , with t = 1 : : :jTj , 1 ; for each user u time slices jUj . jIj we calculate its User Preference Dynamic ( U P Du ) value : cur \ I u U P Du = 1 , jI u jI u cur [ I u prevj prevj where a high U P Du value indicates that u has significantly shifted his current preferences . Then , we calculate a personalized smoothing factor sfu = 1 , U P Du and for each user u 2 U we downweigh his past preferences X ( u ; i ; t ) := sfu fi X ( u ; i ; t ) , with t = 1 ; : : : ;jTj , 1 and i 2 I u prev .
Coupled Tensor Factorization : To generate the final topk recommendations we calculate the low rank R approximation of tensor X by minimizing the objective function f ( A ; B ; C ; V ) = jjX , [ A ; B ; C]jj2 + jjY , AV Tjj2 F , where jj jj2 F indicates the Frobenius norm ; matrices A 2 RjUj.R , B 2 RjIj.R and C 2 RjTj.R are the factor matrices of X , extracted by CANDECOMP/PARAFAC decomposition ; matrices A and V 2 RjDj.R are the factor matrices extracted from matrix Y ( with users’ side information ) by a matrix factorization technique . Hence , we calculate the matrices A ; B ; C and V by minimizing the approximation error with the help of the CMTF OPT algorithm [ 1 ] , which also handles missing values . W CTF : In the first step of CTF , the modeling of users’ side information with the jDj attributes in the coupled matrix Y may negatively affect the performance of the model , ie Y ( u ; d ) = 1 , if user u has an attribute d 2 D and 0 otherwise ; for instance , users that have a unique attribute that rarely appears in set D , are not considered in the calculation of coupled matrix Y . To handle this problem we propose a variant of CTF , namely W CTF . Given a subset C D of attributes , that indicate the same demothe set of the jCj distinct counties , 8 graphic data , eg d 2 C the initial jUj weights Y ( u ; d ) are recalculated as Y ( u ; d ) := Y ( u ; d ) fi jUj=f ( d ) and then are normalized to [ 0 1 ] , where jUj is the number of distinct users and f ( d ) is the number of users that have 1s for the d th attribute in the initial Y matrix . In doing so , we higher weigh the users that have more rare side information in the d th attribute . Provided that W CTF follows a collaborative filtering strategy , in the extreme case of f ( d)=1 , we filter out the d th attribute , since in this case there is only one user with the d th attribute , and consequently the model cannot identify any other user to base the recommendation according to the side information of the d th attribute .
3 . EXPERIMENTS
Datasets : In our experiments , we used the last.fm 1K [ 9 ] and MovieLens 1M [ 10 ] datasets . Last.fm contains 992 users , 176,948 artists , and 19,150,868 listening events over 54 months . The side information includes users’ age , gender and county . We split the dataset into 9 different 6 month periods , each represented as a tensor slice . Given a set of training months the goal is to perform artist recommendation for a user at a test month . We used a time window equal to 6 months , where as training set we considered all the past months of the previous periods and the first five months of the current period . The goal is to predict the artists that each user is going to listen at the last ( 6 th ) test month of the current period . MovieLens 1M has 1,000,209 ratings of 3,952 movies of 6,040 users over 36 months , where we also split the data set into 6 month periods . The side information includes users’ age , gender and occupation type . Each movie can belong to more than one movie genre ( 18 in total ) . In our case of repeat consumptions , we consider how many times a user has watched a movie of a specific movie genre within the time slot . The goal is to predict the genres of movies that each user is going to watch at the last ( 6 th ) test month of the current ongoing period . More details for both datasets and the evaluation protocol can be found in Section 1 of our online technical report [ 8 ] .
Results : In Figures 1(a) (b ) , we compare the proposed CTF and W CTF models against TF [ 3 ] and a baseline method , where we recommend the most popular artists/moviegenres for each user within the training months . The pro posed models outperform TF and the baseline , because both capture users’ preference dynamics in a personalized way and also incorporate users’ side information . An important observation is that after the critical point of 18 months ( see Figure 3 at [ 8] ) , where users start to significantly shift their preferences in last.fm , the accuracy of TF starts to decrease fast , even lower than the baseline method . This happens because TF neither handles the users’ personalized preference dynamics nor use auxiliary information . Finally , W CTF achieves higher recommendation accuracy than CTF , by considering the diversity of the side information and higher weighting the users that have more rare side information . In Table 1 at [ 8 ] , we evaluate the performance of the examined methods on 3 users U P D groups and observe that W CTF outperforms CTF . For instance , for group U P D 0:75 at the 54 th and 36 th months in last.fm and MovieLens , WCTF achieves accuracy [ 0:55 0:07 ; 0:50 0:03 ] , while CTF [ 0:43 0:09 ; 0:48 0:04 ] .
( a ) Accuracy ( last.fm )
( b ) Accuracy ( MovieLens )
Figure 1 : Experimental results .
4 . CONCLUSIONS
We proposed the CTF and W CTF models for recommendation of items with repeat consumption , by capturing the rate with which the current preferences of each user shift over time and by exploiting side information in a coupled tensor factorization technique . Future work includes the incorporation of items’ inherent quality of attractiveness into our models , which may increase the recommendation accuracy according to the analysis of the dynamics of repeat consumption by Anderson et al . in [ 2 ] .
5 . REFERENCES
[ 1 ] E . Acar , T . G . Kolda , and D . M . Dunlavy . All at once optimization for coupled matrix and tensor factorizations . CoRR , abs/1105.3422 , 2011 .
[ 2 ] A . Anderson , R . Kumar , A . Tomkins , and S . Vassilvitskii . The dynamics of repeat consumption . In WWW , pages 419{430 , 2014 .
[ 3 ] D . M . Dunlavy , T . G . Kolda , and E . Acar . Temporal link prediction using matrix and tensor factorizations . TKDD , 5(2):10 , 2011 .
[ 4 ] Y . Koren . Collaborative filtering with temporal dynamics . In
KDD , pages 447{456 , 2009 .
[ 5 ] A . Narita , K . Hayashi , R . Tomioka , and H . Kashima . Tensor factorization using auxiliary information . In ECML/PKDD , pages 501{516 , 2011 .
[ 6 ] D . Rafailidis and A . Nanopoulos . Modeling the dynamics of user preferences in coupled tensor factorization . In RecSys , pages 321{324 , 2014 .
[ 7 ] C . Zhang , K . Wang , H . Yu , J . Sun , and E . Lim . Latent factor transition for dynamic collaborative filtering . In SDM , pages 452{460 , 2014 .
[ 8 ] https://githubcom/drafail/docs/raw/master/TechReportpdf [ 9 ] wwwdticupfedu/~ocelma/MusicRecommendationDataset
[ 10 ] http://grouplensorg/datasets/movielens
61218243036424854002040608monthsAccurary BaselineTFCTFW−CTF61218243036025030350404505monthsAccuracy BaselineTFCTFW−CTF
