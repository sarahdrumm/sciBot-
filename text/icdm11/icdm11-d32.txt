2011 11th IEEE International Conference on Data Mining
Identifying Differentially Expressed Genes via Weighted Rank Aggregation
Qiong Fang
Jianlin Feng
Wilfred Ng
Dept of Computer Science and Engineering
School of Software
Dept of Computer Science and Engineering
HKUST
Hong Kong , China fang@cseusthk
Sun Yat Sen University
Guangzhou , China fengjlin@mailsysueducn
HKUST
Hong Kong , China wilfred@cseusthk
Abstractâ€”Identifying differentially expressed genes is an important problem in gene expression analysis , since these genes , exhibiting sufficiently different expression levels under distinct experiment conditions , could be critical for tracing the progression of a disease . In a microarray study , genes are usually sorted in terms of their differentiation abilities with the more differentially expressed genes being ranked higher in the list . As more microarray studies are conducted , rank aggregation becomes an important means to combine such ranked gene lists in order to discover more reliable differentially expressed genes .
In this paper , we study a novel weighted gene rank aggregation problem whose complexity is at least NP hard . To tackle the problem , we develop a new Markov chain based rank aggregation method called Weighted MC ( WMC ) . The WMC algorithm makes use of rank based weight information to generate the transition matrix . Extensive experiments on the real biological datasets show that our approach is more efficient in aggregating long gene lists . Importantly , the WMC method is much more robust for identifying biologically significant genes compared with the state of the art methods .
Keywords differential expression ; rank aggregation ; Markov chain ; ordering disagreement ; existence disagreement ;
I . INTRODUCTION
Identifying genes that exhibit sufficiently different expression levels under distinct experiment conditions ( eg , diseased vs . normal tissues ) is an important problem in gene expression analysis . Such differentially expressed genes are critical for studying the progression of a disease , since the difference indicates that the functionalities of the genes may have been altered at a particular disease stage .
As microarray technologies advance , extensive studies have been done to identify differentially expressed genes for various diseases [ 1]â€“[5 ] . However , due to different experimental platforms , biological techniques , and many other factors , even when the experiments are designed for achieving the same research goal ( eg for studying the same disease ) , the identified differentially expressed genes may vary from study to study . The high variability of the experiment results obtained from different studies motivates researchers to combine the studies in order to obtain more â€œ reliable â€ findings [ 6 ] , [ 7 ] . While it is well recognized that combining the raw gene expression data is too difficult due to the incomparability of the measurements of gene expression across studies , the ranked gene lists produced by different studies in terms of the differentiation abilities of genes are more comparable [ 8 ] . Motivated by this observation , DeConde et al . [ 6 ] first formulated the problem of identifying differentially expressed genes as a rank aggregation problem , which takes the ranked gene lists obtained from individual microarray studies as input and generates an aggregated gene list . The extended Kendall â€™s tau distance for top ğ‘˜ lists [ 9 ] is adopted to measure the distance between two gene lists . Later , Lin [ 7 ] , [ 10 ] also studied the problem of using rank aggregation to identify differentially expressed genes , and adopted the same formulation as that in [ 6 ] .
The gene list obtained from a single microarray study usually contains up to thousands of genes . However , due to the complexity of biological validation , only the toprated genes will be further checked to see whether or not they are biologically significant [ 6 ] , [ 11 ] , ie , validated to be important for a certain disease . Therefore , through combining the gene lists from different studies , we expect that the aggregated gene list be more â€œ reliable â€ than every input one , in the sense that more top rated genes in the aggregated gene list are biologically significant . From this viewpoint , we can say that a gene list that minimizes its disagreement with the gene lists of individual studies , especially among the top rated genes , is a more â€œ reliable â€ result .
However , the extended Kendall â€™s tau distance adopted in [ 6 ] , [ 7 ] , [ 10 ] only counts the number of discordant gene pairs between two gene lists but ignores the ranks of the genes in the lists . Therefore , the disagreements among the top rated genes and among the low rated genes are treated with equal importance . In order to overcome the limitations of the above distance measure , we define two new distance functions , respectively called weighted Kendall â€™s tau and weighted Spearman â€™s footrule , both of which regard the disagreements among the top rated genes to be more critical than those among the low rated genes . Accordingly , we formulate the weighted rank aggregation problem ( WRA ) by adopting the proposed weighted distance functions . Using the weighted Kendall â€™s tau distance , the WRA problem can be shown to be at least NP hard .
Various rank aggregation methods have been applied
1550 4786/11 $26.00 Â© 2011 IEEE DOI 101109/ICDM201177
1038 w t h g i e
W
1
0.8
0.6
0.4
0.2
0
Î± = 0.01 Î± = 0.05 Î± = 0.10 Î± = 0.15
1
20
40 60 Rank r
80
100
Figure 1 . The rank based weight function realize the following two goals .
Goal 1 : The disagreement among top rated items should be more critical than the disagreement among lowrated items .
Goal 2 : The consistency among top rated items should be more important than the consistency among lowrated items .
Before proposing the weighted distance functions , we first define a rank based weight function as follows :
ğ‘¤(ğ‘Ÿ ) =
ğ‘’âˆ’ğ›¼ğ‘Ÿ ğ‘’âˆ’ğ›¼
= ğ‘’âˆ’ğ›¼(ğ‘Ÿâˆ’1 ) ,
( 1 ) where ğ‘Ÿ is the rank of item in the order and ğ›¼ is a small positive constant that controls how rapidly the weight ğ‘¤ decreases as ğ‘Ÿ increases . The weight function is monotonically decreasing , and is normalized by the largest value ğ‘’âˆ’ğ›¼ . Figure 1 show ğ‘¤(ğ‘Ÿ ) with different ğ›¼ values . A . Weighted Kendall â€™s tau
We make use of the above rank based weight function to define the penalties for all the disagreements between two incomplete linear orders , and accordingly propose our new weighted Kendall â€™s tau distance function .
We consider two types of disagreements between two orders : the ordering disagreement and the existence disagreement . An item pair , existing in both orders , is said to cause an ordering disagreement if their ordering relationships in two orders disagree . An item existing in one order but not in the other is said to cause an existence disagreement . We define the penalties for these two types of disagreements as follows . Suppose there are two linear orders ğ‘‚1 and ğ‘‚2 with the associated itemsets respectively to be ğ‘‡1 and ğ‘‡2 . Let ğ‘‡ be the union of ğ‘‡1 and ğ‘‡2 , ie , ğ‘‡ = ğ‘‡1 âˆª ğ‘‡2 . âˆ™ Ordering disagreement ( ğ’¦ğ‘œ ) : For a pair of items ğ‘¡ğ‘– , ğ‘¡ğ‘— âˆˆ ( ğ‘‡1 âˆ© ğ‘‡2 ) , if the ordering relationships between ğ‘¡ğ‘– and ğ‘¡ğ‘— are different in ğ‘‚1 and ğ‘‚2 , the penalty caused by ( ğ‘¡ğ‘– , ğ‘¡ğ‘— ) is given by
ğ’¦ğ‘œ ğ‘–,ğ‘—(ğ‘‚1 , ğ‘‚2 ) = ğ‘¤(ğ‘Ÿâˆ— ) , to aggregate gene lists in order to identify differentially expressed genes [ 6 ] , [ 7 ] . Among them , the Markov Chain ( MC ) based methods have shown their advantages in aggregating very few but long lists [ 12 ] , which well conforms to the nature of the gene rank aggregation problem . DeConde et al . [ 6 ] considered two MC based methods to aggregate the ranked gene lists , which lead to the identification of several biologically significant genes . We also take advantage of the MC technique , and propose a new MC based method called Weighted MC ( WMC ) . The WMC method essentially determines the transition probability from one gene to another by incorporating rank based information , so that it better facilitates the effect of the weighted distance functions . Extensive experiments on real biological datasets show that the WMC method is more efficient in aggregating long gene lists , and it is also more robust for identifying biologically significant genes in the sense that these genes are constantly top rated in the aggregated orders .
The rest of the paper is organized as follows . We first define some concepts and notations in Section II . Then , we propose the new weighted distance functions and formulate the WRA problem in Section III . An efficient MC based method called WMC is presented in Section IV . Extensive experimental studies using the real biological datasets are conducted in Section V . We present related work in Section VI , and finally conclude the paper in Section VII .
II . PRELIMINARIES
We now introduce the basic notations that are used throughout the paper . Definition 2.1 : ( Linear Order ) Given a set of items ğ‘‡ = {ğ‘¡1 , . . . , ğ‘¡ğ‘›} , a linear order ğ‘‚ of ğ‘‡ is a binary relation on ğ‘‡ , where the relation satisfies the properties of antisymmetry , â‰» â‹…â‹…â‹… â‰» transitivity and totality . We simply write ğ‘‚ = [ ğ‘¡ğ‘–1 ] , where the ordered pair â€œ ğ‘¡ğ‘˜ â‰» ğ‘¡ğ‘  â€ means that ğ‘¡ğ‘˜ is ğ‘¡ğ‘–ğ‘› preferred to ğ‘¡ğ‘  .
We call ğ‘‡ the associated itemset of ğ‘‚ and denote by ğ‘‚(ğ‘¡ğ‘– ) the rank of item ğ‘¡ğ‘– in ğ‘‚ . In particular , the rank of the most preferred item in ğ‘‚ , ie , ğ‘¡ğ‘–1 , is 1 , which we express ) = 1 . Suppose there is a set of linear orders by ğ‘‚(ğ‘¡ğ‘–1 {ğ‘‚1 , . . . , ğ‘‚ğ‘š} , and their corresponding associated itemsets are ğ‘‡1 , . . . , ğ‘‡ğ‘š , which are not necessarily identical . A union ğ‘– ğ‘‡ğ‘– . As ğ‘‡ğ‘– âŠ‚ ğ‘‡ , we say that ğ‘‚ğ‘– itemset is given by ğ‘‡ = is an incomplete linear order with respect to ğ‘‡ . In practice , different microarray experiments usually monitor different sets of genes [ 6 ] . Let ğ‘‡ represent the union gene set which contains all the genes that appear in at least one ranked gene list produced by a particular study . A single gene list thus may not contain all the genes in ğ‘‡ , and it can be regarded as an incomplete linear order with respect to ğ‘‡ .
âˆª
III . WEIGHTED DISTANCE FUNCTIONS
In this section , we define the new weighted Kendall â€™s tau and weighted Spearman â€™s footrule distance functions to
1039
2 where ğ‘Ÿâˆ— = min{ğ‘‚1(ğ‘¡ğ‘–),ğ‘‚1(ğ‘¡ğ‘— )}+min{ğ‘‚2(ğ‘¡ğ‘–),ğ‘‚2(ğ‘¡ğ‘— )} . The disagreement is emphasized by setting the weight using the smaller ranks of the pair of items in the orders . If the ordering relationships between ğ‘¡ğ‘– and ğ‘¡ğ‘— are the same in ğ‘‚1 and ğ‘‚2 , the penalty is 0 . This idea can be uniformly represented as : ğ’¦ğ‘œ ğ‘–,ğ‘—(ğ‘‚1 , ğ‘‚2 ) = ğ‘¤(ğ‘Ÿâˆ—)ğ¼[(ğ‘‚1(ğ‘¡ğ‘– ) âˆ’ ğ‘‚1(ğ‘¡ğ‘—))(ğ‘‚2(ğ‘¡ğ‘– ) âˆ’ ğ‘‚2(ğ‘¡ğ‘— ) ) < 0 ] , where ğ¼[â‹… ] is the indicator function . If the ordering disagreement happens among genes with smaller ranks , the ğ‘Ÿâˆ— value will be smaller and accordingly a larger penalty is counted , which satisfies Goal 1 . âˆ™ Existence disagreement ( ğ’¦ğ‘’ ) : For an item ğ‘¡ğ‘– âˆˆ ( ğ‘‡ âˆ’ ( ğ‘‡1 âˆ© ğ‘‡2) ) , since it exists in one order but is absent in the other , we define the penalty for its existence disagreement as follows : ğ’¦ğ‘’ ğ‘– ( ğ‘‚1 , ğ‘‚2 ) = ğ‘¤(ğ‘‚1(ğ‘¡ğ‘–))ğ¼[ğ‘¡ğ‘– âˆˆ ğ‘‡ âˆ’ ğ‘‡2 ] + ğ‘¤(ğ‘‚2(ğ‘¡ğ‘–))ğ¼[ğ‘¡ğ‘– âˆˆ ğ‘‡ âˆ’ ğ‘‡1 ] . If ğ‘¡ğ‘– gets a smaller rank in one order , ie , top rated , a larger penalty should be counted for its absence in the other order . Counting a large penalty for the existence disagreement of an item with small rank encourages the items that appear in both orders be ranked higher , which conforms to Goal 2 .
âˆª ğ‘‡ğ‘– , we aim to find a linear order ğ‘‚âˆ— of ğ‘‡ such that âˆ‘ğ‘š ğ‘–=1 ğ’Ÿ(ğ‘‚âˆ— , ğ‘‚ğ‘– ) is minimized , where ğ’Ÿ is the distance function , and it can either be the weighted Kendall â€™s tau ğ’¦ or be the weighted Spearman â€™s footrule ğ’® . Complexity Note . If the weighted Kendall â€™s tau distance is adopted with the weight function to be a constant , say ğ‘¤(ğ‘Ÿ ) = 1 , and all the input orders contain the same set of items , the WRA problem is reduced to the Kendall optimal rank aggregation problem , which is known to be NP hard [ 12 ] . In this case , the WRA problem is at least NP hard .
IV . ALGORITHM
In this section , we propose a new Markov chain based method called Weighted Markov Chain ( WMC ) , which takes both the ordering relationship and the rank based weight of items to construct the transition matrix .
A . Constructing Transition Matrices
Summing up the penalties of all possible disagreements , the weighted Kendall â€™s tau distance between ğ‘‚1 and ğ‘‚2 , denoted as ğ’¦(ğ‘‚1 , ğ‘‚2 ) , is defined as : ğ’¦ğ‘œ ğ’¦(ğ‘‚1 , ğ‘‚2 ) = ğ‘–,ğ‘—(ğ‘‚1 , ğ‘‚2)+ ğ‘¡ğ‘–,ğ‘¡ğ‘—âˆˆ(ğ‘‡1âˆ©ğ‘‡2 )
ğ’¦ğ‘’ ğ‘– ( ğ‘‚1 , ğ‘‚2 ) . ğ‘¡ğ‘–âˆˆ(ğ‘‡âˆ’(ğ‘‡1âˆ©ğ‘‡2 ) )
âˆ‘
âˆ‘
B . Weighted Spearman â€™s footrule
We similarly consider the ordering disagreement and the existence disagreement , and define the weighted Spearman â€™s footrule distance function between two linear orders ğ‘‚1 and ğ‘‚2 , which is denoted as ğ’®(ğ‘‚1 , ğ‘‚2 ) . âˆ™ Ordering disagreement ( ğ’® ğ‘œ ) : For an item ğ‘¡ğ‘– âˆˆ ( ğ‘‡1 âˆ©
ğ‘‡2 ) , the penalty is defined as
ğ‘– ( ğ‘‚1 , ğ‘‚2 ) = ğ‘¤(ğ‘Ÿâˆ—)âˆ£ğ‘‚1(ğ‘¡ğ‘– ) âˆ’ ğ‘‚2(ğ‘¡ğ‘–)âˆ£ , ğ’® ğ‘œ where ğ‘Ÿâˆ— = min{ğ‘‚1(ğ‘¡ğ‘– ) , ğ‘‚2(ğ‘¡ğ‘–)} . âˆ£ğ‘‚1(ğ‘¡ğ‘– ) âˆ’ ğ‘‚2(ğ‘¡ğ‘–)âˆ£ is the difference between the ranks of ğ‘¡ğ‘– in ğ‘‚1 and ğ‘‚2 , which is additionally weighted by the rank of ğ‘¡ğ‘– in the orders . The smaller rank ğ‘¡ğ‘– has in either of the orders , a larger weight is counted . âˆ™ Existence disagreement ( ğ’® ğ‘’ ) : For an item ğ‘¡ğ‘– âˆˆ ğ‘‡ âˆ’ ( ğ‘‡1 âˆ© ğ‘‡2 ) , we define the penalty for its existence disagreement to be the same as ğ’¦ğ‘’
ğ‘– ( ğ‘‚1 , ğ‘‚2 ) , ie ,
ğ‘– ( ğ‘‚1 , ğ‘‚2 ) = ğ’¦ğ‘’ ğ’® ğ‘’
ğ‘– ( ğ‘‚1 , ğ‘‚2 ) .
Figure 2 shows a procedure called TRANSMATRIX , which constructs the transition matrix from a set of input linear orders . Given a set of orders , and the weight parameter ğ›¼ğ‘¤ used for computing the weight by Equation ( 1 ) , we construct a âˆ£ğ‘‡âˆ£ by âˆ£ğ‘‡âˆ£ transition matrix â„³ , where ğ‘‡ consists of all the items appearing in the input orders , and each entry â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘— ) corresponds to the probability that the Markov chain process transfers from state ( ie , item ) ğ‘¡ğ‘– to state ğ‘¡ğ‘— ( Lines 1 2 ) . The construction of the transition matrix can be accomplished by the following three steps . Step One : We first impose on â„³ the probability induced from the ordering relationship between every pair of items ( Lines 3 6 ) . For a pair of items ğ‘¡ğ‘– and ğ‘¡ğ‘— which co occur in at least one input order , the probability that ğ‘¡ğ‘– transfers to ğ‘¡ğ‘— should intuitively be proportional to the weight with which the ordering relationship â€œ ğ‘¡ğ‘— â‰» ğ‘¡ğ‘– â€ is supported by the input orders . For a specific order ğ‘‚ğ‘˜ , the weight with which ğ‘‚ğ‘˜ supports â€œ ğ‘¡ğ‘— â‰» ğ‘¡ğ‘– â€ is ğ‘¤(ğ‘‚ğ‘˜(ğ‘¡ğ‘—) ) . Thus , the overall weight with which â€œ ğ‘¡ğ‘— â‰» ğ‘¡ğ‘– â€ is supported is ( Line 4 ) :
â„³âˆ—(ğ‘¡ğ‘– , ğ‘¡ğ‘— ) =
âˆ‘
ğ‘¤(ğ‘‚ğ‘˜(ğ‘¡ğ‘—) ) .
Then , the entry â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘— ) is determined by ( Line 5 )
ğ‘˜:ğ‘‚ğ‘˜(ğ‘¡ğ‘— )<ğ‘‚ğ‘˜(ğ‘¡ğ‘– )
â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘— ) =
â„³âˆ—(ğ‘¡ğ‘– , ğ‘¡ğ‘— )
â„³âˆ—(ğ‘¡ğ‘– , ğ‘¡ğ‘— ) + â„³âˆ—(ğ‘¡ğ‘— , ğ‘¡ğ‘– )
.
Step Two : We consider the probability that every item should stay in its own state during the transition , ie , â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘– ) for ğ‘¡ğ‘– âˆˆ ğ‘‡ . We compute a rank based weight for each item , and the larger the weight is , the more probable the item is to transfer to itself ( Lines 7 14 ) . We first obtain the set of ranks that ğ‘¡ğ‘– has in the input orders , and call the set the rank profile of ğ‘¡ğ‘– , denoted as ğ‘ƒ ( ğ‘¡ğ‘– ) ( Line 8 ) . To combat the influence of noise that ğ‘¡ğ‘– is placed with exceptional ranks in some orders , we take the median of the ranks in ğ‘ƒ ( ğ‘¡ğ‘– ) , denoted as ğ‘Ÿğ‘š(ğ‘¡ğ‘– ) , and set the weight of
1040
Summing up the penalties of all possible disagreements , the weighted Spearman â€™s footrule distance ğ’®(ğ‘‚1 , ğ‘‚2 ) is defined as : ğ’®(ğ‘‚1 , ğ‘‚2 ) =
ğ’® ğ‘œ ğ‘– ( ğ‘‚1 , ğ‘‚2 ) +
ğ’® ğ‘’ ğ‘– ( ğ‘‚1 , ğ‘‚2 ) . ğ‘¡ğ‘–âˆˆ(ğ‘‡âˆ’(ğ‘‡1âˆ©ğ‘‡2 ) )
ğ‘¡ğ‘–âˆˆ(ğ‘‡1âˆ©ğ‘‡2 )
âˆ‘
âˆ‘
C . Weighted Rank Aggregation
Having defined the weighted distance functions , we now formulate the weighted rank aggregation problem as follows . Definition 3.1 : ( Weighted Rank Aggregation ( WRA) ) : Given a set of linear orders {ğ‘‚1 , . . . , ğ‘‚ğ‘š} with ğ‘‡ =
TRANSMATRIX Algorithm Input : A set of orders {ğ‘‚1 , . . . , ğ‘‚ğ‘š} ; weight para ğ›¼ğ‘¤ . Output : The transition matrix â„³ . Variables : ğ’ª(ğ‘¡ğ‘–) the set of orders containing ğ‘¡ğ‘– .
âˆªğ‘š
8 : 9 :
âˆ‘
ğ‘–=1 ğ‘‡ğ‘–
1 : ğ‘‡ = 2 : Initialize the âˆ£ğ‘‡âˆ£ by âˆ£ğ‘‡âˆ£ matrix â„³ to be 0 . 3 : for ğ‘¡ğ‘– , ğ‘¡ğ‘— âˆˆ ğ‘‡ with ğ‘¡ğ‘– âˆ•= ğ‘¡ğ‘— and ğ’ª(ğ‘¡ğ‘–)âˆ©ğ’ª(ğ‘¡ğ‘— ) âˆ•= ğœ™ do 4 : â„³âˆ—(ğ‘¡ğ‘– , ğ‘¡ğ‘— ) = 5 : â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘— ) = 6 : end for 7 : for ğ‘¡ğ‘– âˆˆ ğ‘‡ do
ğ‘˜:ğ‘‚ğ‘˜(ğ‘¡ğ‘— )<ğ‘‚ğ‘˜(ğ‘¡ğ‘– ) ğ‘¤(ğ‘‚ğ‘˜(ğ‘¡ğ‘— ) ) â„³âˆ—(ğ‘¡ğ‘–,ğ‘¡ğ‘— )
â„³âˆ—(ğ‘¡ğ‘–,ğ‘¡ğ‘— )+â„³âˆ—(ğ‘¡ğ‘— ,ğ‘¡ğ‘– )
ğ‘ƒ ( ğ‘¡ğ‘– ) = {ğ‘‚ğ‘˜(ğ‘¡ğ‘–)âˆ£ğ‘¡ğ‘– âˆˆ ğ‘‡ğ‘˜} Set ğ‘Ÿğ‘š(ğ‘¡ğ‘– ) to be the median of ranks in ğ‘ƒ ( ğ‘¡ğ‘– ) 10 : â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘– ) = âˆ£ğ‘ƒ ( ğ‘¡ğ‘–)âˆ£âˆ—ğ‘¤(ğ‘Ÿğ‘š(ğ‘¡ğ‘– ) ) for ğ‘¡ğ‘— âˆˆ ğ‘‡ do end for
â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘—)+ = 1
ğ‘š ( 1 âˆ’ â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘– ) )
11 : 12 : 13 : 14 : end for 15 : for ğ‘¡ğ‘– âˆˆ ğ‘‡ do 16 : â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘— ) = 17 : end for 18 : for ğ‘¡ğ‘– , ğ‘¡ğ‘— âˆˆ ğ‘‡ do 19 : â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘— ) = ( 1 âˆ’ ğœ–)â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘— ) + ğœ–/âˆ£ğ‘‡âˆ£ 20 : end for Figure 2 . TRANSMATRIX for constructing the transition matrix of WMC
ğ‘¡ğ‘˜âˆˆğ‘‡ â„³(ğ‘¡ğ‘–,ğ‘¡ğ‘˜ ) for all ğ‘¡ğ‘— âˆˆ ğ‘‡ â„³(ğ‘¡ğ‘–,ğ‘¡ğ‘— )
âˆ‘
ğ‘š
ğ‘¡ğ‘– to be ğ‘¤(ğ‘Ÿğ‘š(ğ‘¡ğ‘–) ) . The rank based weight of ğ‘¡ğ‘– is further weighted by the frequency that ğ‘¡ğ‘– appears in the input orders , and thus the entry â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘– ) is
â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘– ) =
âˆ£ğ‘ƒ ( ğ‘¡ğ‘–)âˆ£
ğ‘š
ğ‘¤(ğ‘Ÿğ‘š(ğ‘¡ğ‘–) ) .
We then uniformly distribute the remaining probability ( 1âˆ’ â„³(ğ‘¡ğ‘– , ğ‘¡ğ‘– ) ) to all the items in ğ‘‡ . This implies that , regardless of any other factors , the probability that ğ‘¡ğ‘– transfers to any state in ğ‘‡ is equal ( Lines 11 13 ) . Step Three : â„³ is first normalized such that the sum of every row is 1 ( Lines 15 17 ) . Then , in order to guarantee that the transition matrix be ergodic , all the entries are multiplied by ( 1âˆ’ ğœ– ) and then added with ğœ–/âˆ£ğ‘‡âˆ£ ( Lines 18 20 ) , where ğœ– is a small positive number . In practice , we choose ğœ– = 015
B . Markov Chain Process
Having the transition matrix constructed , the WMC algorithm sets the initial probability of every item to be equal and starts the Markov chain process . After each iteration , items are ordered in decreasing order of their updated probabilities . When the order becomes stable , the Markov chain process stops , and this order is output as the aggregated order .
C . Comparisons with MC4 and MCT
The MC4 and MCT algorithms were adopted by DeConde et al . [ 6 ] for gene rank aggregation . Both MC4 and MCT
1041 determine the transition probability merely by the ordering relationships of item pairs and disregard the location where a certain ordering relationship is . When long lists are aggregated , the local similarity like the similariy among toprated items may be sacrificed in order to pursue the overall similarity . Thus , when the similarity of the top rated items in the aggregated order is more important , they usually truncate the input orders and only keep the top ğ‘˜ lists .
In contrast , our WMC method makes use of the rankbased information to determine the transition matrix , which emphasizes the similarity of top rated items and does not need to truncate the input orders . Suppose there is a pair of items ğ‘ and ğ‘ , and the relationship â€œ ğ‘ â‰» ğ‘ â€ prevails in a few , say ğ‘™ , orders with small ranks . The relationship â€œ ğ‘ â‰» ğ‘ â€ also appears in ğ‘™ + 1 other orders , but with very large ranks . In this case , if the full lists are aggregated , both MC4 and MCT algorithms prefer the transition from ğ‘ to ğ‘ . However , since the weight of â€œ ğ‘ â‰» ğ‘ â€ , which is associated with very small ranks , may still be very much larger than the weight of â€œ ğ‘ â‰» ğ‘ â€ , which is associated with large ranks , the WMC algorithm still prefers the transition from ğ‘ to ğ‘ .
V . EXPERIMENTS
In this section , we study the effectiveness of our proposed weighted distance functions and evaluate the performance of the WMC algorithm using the real data from five prostate cancer microarray studies [ 1]â€“[5 ] .
We adopt the methods introduced in [ 6 ] to generate the ranked gene list from each study . Then , we vary ğ‘š to be {300 , 600 , . . . , 2100} , and respectively take the top ğ‘š genes of each gene list to form a set of five input orders with length ğ‘š . The seven datasets of different lengths are used to evaluate our WMC method , and two other MC based methods , MC4 and MCT . We also compare with a statistical method for discovering differentially expressed genes from multiple studies , which is proposed by Rhodes et al . [ 11 ] and denoted as RHODES . All the experiments are conducted on a Macbook Pro with 2.53GHZ CPU and 4G memory .
As the top 100 genes in the ranked gene lists are more important for further scientific investigation [ 6 ] , we need to ensure that enough penalties are counted for the disagreement happened among the top 100 results . Thus , according to Figure 1 , we fix the ğ›¼ value for computing the weighted distance functions to be 0.05 , denoted as ğ›¼ğ‘‘ = 005
A . Efficiency of WMC
We first study the efficiency of the three MC based to the length of the input orders . methods with respect The running time of each method is shown in Figure 3 . For WMC , we run it by setting ğ›¼ğ‘¤ to be 0.01 , 0.05 , and 0.09 , which correspond to the series â€œ WMC ( 0.01 ) â€ , â€œ WMC ( 0.05 ) â€ , and â€œ WMC ( 0.09 ) â€ in the figure .
While the running time of the three methods are very close on small datasets , the running time of WMC under
) c e s ( e m i t g n i n n u R
WMC(0.01 ) WMC(0.05 ) WMC(0.09 ) MC4 MCT
100
80
60
40
20
0 300
600
900
1200
1500
1800
2100
Length of input orders Figure 3 . Running time all ğ›¼ğ‘¤ values becomes apparently shorter than those of MC4 and MCT when the dataset gets larger . The reason is that , when the input dataset gets larger , both MC4 and MCT need more iterations to converge , while less number of iterations are needed by WMC . As more time will be used for one iteration based on the transition matrix induced from a larger dataset , the WMC method becomes more efficient than MC4 and MCT for the large datasets . The reason why our WMC method consumes less number of iterations to converge on large datasets can be explained as follows . When a small dataset gets larger with more items appended at the end of each order , the ordering relationships between the appended items and other highly ranked ones reinforce the probabilities of transferring to the highly ranked items from them . Moreover , since the rank based weight of the newly appended items is small due to their large ranks , the weight contributes little to the transition probabilities that other items may transfer to the appended items . Thus , comparing to the transition matrix constructed from the smaller dataset , the transition matrix constructed from the larger one makes the Markov chain process more quickly to converge .
B . Comparison of Distance Functions
We then study the effectiveness of the weighted distance functions . Figures 4(a ) and 4(b ) show the sum of the distance between the aggregated order and the input orders when the weighted Kenall â€™s tau distance and the weighted Spearman â€™s footrule distance are respectively taken .
The weighted Kendall â€™s tau distance of WMC is smaller the datasets . The than those of MC4 and MCT for all reason is that , the ordering disagreements ( OD ) between the aggregated order of WMC and the input orders usually happen among items with larger ranks , and thus the penalties caused by OD are much smaller . It implies that , comparing to MC4 and MCT , WMC tends to generate the aggregated orders that better preserve the ordering relationship among top rated items . The weighted Spearman â€™s footrule distance counts for each OD the penalty of the rank based weight multiplied by the rank difference of the item causing the disagreement , which even amplifies the advantage of WMC in reducing OD . Thus , the weighted Spearman â€™s footrule distance of WMC is even smaller , as shown in Figure 4(b ) .
C . Biological Significance
Identifying differentially expressed genes are critical for tracing the progression of a disease . [ 6 ] lists the following u a t s â€™ l l a d n e K d e t h g i e
W
4000
3000
2000
1000
0 300
600
900
WMC(0.01 ) WMC(0.05 ) WMC(0.09 ) MC4 MCT 1500
1200
1800
2100
Length of input orders e l u r t o o f s â€™ n a m r a e p S d e t h g i e
W
WMC(0.01 ) WMC(0.05 ) WMC(0.09 ) MC4 MCT
8E+04
6E+04
4E+04
2E+04
0E+00
300
600
900
1200
1500
1800
2100
Length of input orders
( a ) Weighted Kendall â€™s tau
( b ) Weighted Spearman â€™s footrule
Figure 4 . Effects of the distance function eight differentially expressed genes : HPN , AMACR , FASN , GUCY1A3 , STRA13 , CCT2 , CANX , and TRAP1 , which have already been verified to be clinically important for tracing the development of the prostate cancer .
In order to evaluate the quality of aggregation , we collect the ranks of these genes in the aggregated orders generated by the four methods , and check whether these genes are also â€œ successfully â€ identified . We adopt the benchmark defined by [ 6 ] : a gene is said to be successfully identified if its rank in an aggregated order is smaller than 100 . Since the setting of ğ›¼ğ‘¤ of WMC does not influence much the ranks of the genes , we only show the result when ğ›¼ğ‘¤ = 0.01 for clarity . Due to space limit , we only show the rank distributions of genes HPN , AMACR , FASN , and CANX in Figure 5 . In Table I , the average ranks of the eight genes over the seven datasets are listed for three MC based methods . RHODES performs bad on small datasets , and thus we show its best results acquired based on the input orders of length 2100 . Comparing WMC , MC4 and MCT , all the genes except HPN get much smaller average ranks when the WMC method is adopted , and the average ranks of six out of eight genes , ie , HPN , AMACR , FASN , GUCY1A3 , STRA13 , and CANX , are smaller than 100 . In contrast , only HPN and AMACR get the average ranks smaller than 100 if either MCT or MC4 is adopted . Four genes get the ranks smaller than 100 when RHODES is adopted . However , the accuracy of RHODES is achieved by running a large number of permutation testing for every single gene , which is time consuming . According to the settings in [ 11 ] , RHODES spends 506 seconds for permutation testing on the input orders of length 2100 , which is 12 times longer than the time consumed by WMC .
In addition , when WMC is adopted , the ranks of these genes remain quite stable , no matter which dataset is taken for aggregation , while the ranks of these genes chang a lot if either MC4 or MCT is adopted . The instability of the ranks of the genes over different datasets makes it a difficult problem for the MCT and MC4 methods to determine the proper length of input orders so that more
THE AVERAGE RANKS OF GENES OVER SEVEN DATASETS
Table I
HPN
AMACR
FASN
GUCY1A3 STRA13 CCT2 CANX TRAP1
WMC 2.1 1.1 51.1 17.9 97.7 111.3 10.3 165.4
MC4 1.0 9.7 194 589.3 139.4 207.6 276.9 215.4
MCT 1.0 7.86 202 595.6 140.6 200.3 253.7 216.1
1042
RHODES
1 7 554 27 662 282 3072
3
WMC MC4
MCT Rhodes
HPN
5
4
3
2
1 s e n e g f o k n a R
0 300
600
900
1200 1500 1800 2100
Length of input orders
50
40
30
20
10 s e n e g f o k n a R
0 300
AMACR
FASN
800
600
400
200 s e n e g f o k n a R
600
900
1200
1500
1800
2100
Length of input orders
0 300
600
900
1200
1500
1800
2100
Length of input orders
Figure 5 . Stability of the ranks of four identified prostate cancer genes
CANX s e n e g f o k n a R
600
500
400
300
200
100
0
400 600 800 1000 1200 1400 1600 1800 2000
Length of input orders significant genes can be ranked reasonably high . However , as we have explained in the first set of experiments , the items with very large ranks in the input orders may only reinforce the probabilities that those highly ranked items can be transferred to , and thus the datasets with longer orders are always perferred by WMC .
VI . RELATED WORK
A few representative gene rank aggregation methods are : Borda â€™s method [ 7 ] , MEDRANK method [ 13 ] , Thurstone â€™s order statistic method [ 6 ] , and Markov chain based methods [ 6 ] . Both Borda â€™s method and MEDRANK are positional rank aggregation methods , which are simple and efficient . However , their performance in optimizing some distance criteria , like Kendall â€™s tau , may not be good enough when incomplete orders are aggregated . Thurstone â€™s method assumes that each item follows a normal distribution , and items are ordered in terms of their estimated mean values , which leads to the aggregated order . However , for the gene rank aggregation problem considered in this paper , Thurstone â€™s method may suffer from the problem that the samplings ( ie , input orders ) are usually too few , which may affect the accuracy of parameter estimation . The MC based methods , ie , MC1 to MC4 [ 12 ] and MCT [ 6 ] , have shown their advantage in aggregating few number of long top ğ‘˜ lists , which well conforms to the gene rank aggregation problem . However , none of the five MC based methods makes use of rank based information , and the generated aggregated orders do not favor the accuracy of top rated items either .
VII . CONCLUSIONS
In this paper , we study a novel weighted rank aggregation problem , which aims to identify more reliable differentially expressed genes by combining the results obtained from different microarray studies . We propose two new distance functions , the weighted Kendall â€™s tau and the weighted Spearman â€™s footrule , which measure the difference between gene lists by incorporating rank based weight . The distance functions emphasize the similarities as well as the disagreements among top rated items , which better favor the domain specific need that the reliable differentially expressed genes are expected to be top rated .
We develop a new Markov chain based rank aggregation method called WMC . The WMC method makes use of the rank based information to determine the transition from one state to another . Our experiments based on the real biological
1043 datasets show that the WMC method better facilitates the effect of the weighted distance functions , comparing with two other MC based methods . The WMC method is also more efficient in aggregating long ranked gene lists . Importantly , by checking the rank of eight well identified differentially expressed genes in the datasets , we confirm that WMC is far more robust in identifying truly differentially expressed genes than its counterparts , in the sense that most of such genes are constantly top rated in the aggregated orders .
ACKNOWLEDGMENT
This work is partially supported by Hong Kong RGC GRF under project number 617610 and China NSF Grant 60970043 .
REFERENCES
[ 1 ] S . Dhanasekaran , T . Barrette , D . Ghosh , R . Shah , and et al . , â€œ Delineation of prognostic biomarkers in prostate cancer , â€ Nature , vol . 412 , pp . 822â€“826 , 2001 .
[ 2 ] J . Luo , D . Duggan , Y . Chen , J . Sauvageot , and et al . , â€œ Human prostate cancer and benign prostatic hyperplasia : Molecular dissection by gene expression profiling , â€ Cancer Research , vol . 61 , pp . 4683â€“4688 , 2001 .
[ 3 ] D . Singh , P . G . Febbo , K . Ross , D . G . Jackson , and et al . , â€œ Gene expression correlates of clinical prostate cancer behavior , â€ in Cancer Cell , vol . 1 , pp . 203â€“209 , 2002 .
[ 4 ] L . True , I . Coleman , S . Hawley , C Y Huang , and et al . , â€œ A molecular correlate to the gleason grading system for prostate adenocarcinoma , â€ Proc Natl Acad Sci USA , vol . 103 , no . 29 , pp . 10 991â€“10 996 , 2006 .
[ 5 ] J . Welsh , L . Sapinoso , A . Su , and et al . , â€œ Analysis of gene expression identifies candidate markers and pharmacological targets in prostate cancer , â€ Cancer Research , vol . 61 , 2001 . [ 6 ] R . P . DeConde , S . Hawley , S . Falcon , and et al . , â€œ Combining results of microarray experiments : A rank aggregation approach , â€ Stat Appl Genet Mol Biol , vol . 5 , no . 1 , 2006 .
[ 7 ] S . Lin , â€œ Rank aggregation methods , â€ Wiley Interdisciplinary Reviews : Computational Statistics , vol . 2 , pp . 555â€“570 , 2010 . [ 8 ] T . Yuen , E . Wurmbach , R . Pfeffer , B . Ebersole , and et al . , â€œ Accuracy and calibration of commerical oligonucleotide and custom cdna microarrays , â€ Nucleic Acids Res . , 2002 .
[ 9 ] R . Fagin , R . Kumar , and D . Sivakumar , â€œ Comparing top k lists , â€ in SODA â€™03 , pp . 28â€“36 , 2003 .
[ 10 ] S . Lin , â€œ Space oriented rank based data integration , â€ Stat Appl
Genet Mol Biol , vol . 9 , no . 1 , 2010 .
[ 11 ] D . R . Rhodes , T . R . Barrette , and et al . , â€œ Meta analysis of micorarrays : Interstudy validation of gene expression profiles reveals pathway dysregulation in prostate cancer , â€ Cancer Research , vol . 62 , no . 15 , pp . 4427â€“4433 , 2002 .
[ 12 ] C . Dwork , R . Kumar , M . Naor , and D . Sivakumar , â€œ Rank aggregation methods for the web , â€ in WWWâ€™ 01 , 2001 .
[ 13 ] R . Fagin , R . Kumar , and D . Sivakumar , â€œ Efficient similarity search and classification via rank aggregation , â€ in SIGMOD â€™03 , pp . 301â€“312 , 2003 .
