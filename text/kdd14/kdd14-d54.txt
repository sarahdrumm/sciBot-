FUNNEL : Automatic Mining of Spatially Coevolving Epidemics
Yasuko Matsubara† , Yasushi Sakurai† , Willem G . van Panhuis§ , Christos Faloutsos‡
† Dept . of Computer Science and Electrical Engineering , Kumamoto University ,
§ Dept . of Epidemiology , University of Pittsburgh , ‡ Dept . of Computer Science , Carnegie Mellon University
{yasuko,yasushi}@cskumamoto uacjp , wav10@pitt.edu , christos@cscmuedu
ABSTRACT
Given a large collection of epidemiological data consisting of the count of d contagious diseases for l locations of duration n , how can we find patterns , rules and outliers ? For example , the Project Tycho provides open access to the count infections for US states from 1888 to 2013 , for 56 contagious diseases ( eg , measles , influenza ) , which include missing values , possible recording errors , sudden spikes ( or dives ) of infections , etc . So how can we find a combined model , for all these diseases , locations , and time ticks ?
In this paper , we present FUNNEL , a unifying analytical model for large scale epidemiological data , as well as a novel fitting algorithm , FUNNELFIT , which solves the above problem . Our method has the following properties : ( a ) Sense making : it detects important patterns of epidemics , such as periodicities , the appearance of vaccines , external shock events , and more ; ( b ) Parameter free : our modeling framework frees the user from providing parameter values ; ( c ) Scalable : FUNNELFIT is carefully designed to be linear on the input size ; ( d ) General : our model is general and practical , which can be applied to various types of epidemics , including computer virus propagation , as well as human diseases .
Extensive experiments on real data demonstrate that FUNNELFIT does indeed discover important properties of epidemics : ( P1 ) disease seasonality , eg , influenza spikes in January , Lyme disease spikes in July and the absence of yearly periodicity for gonorrhea ; ( P2 ) disease reduction effect , eg , the appearance of vaccines ; ( P3 ) local/state level sensitivity , eg , many measles cases in NY ; ( P4 ) external shock events , eg , historical flu pandemics ; ( P5 ) detect incongruous values , ie , data reporting errors .
Categories and Subject Descriptors : H28 [ Database management ] : Database applications–Data mining
Keywords : Epidemics ; Time series ; Automatic mining
1 .
INTRODUCTION
Given a huge collection of co evolving epidemic time series , such as measles and influenza , how can we find typical patterns or anomalies , and statistically summarize all the epidemic sequences ? In this paper , we present a unifying model , namely FUNNEL , which provides a good description of large collections of epidemiological data . 1 Intuitively , the problem we wish to solve is as follows :
INFORMAL PROBLEM 1 . Given a large collection of epidemiological data , which consists of d diseases in l locations of duration n , with missing values and recording errors , we want to
• find basic patterns of diseases ( eg , seasonality ) • find extra patterns ( eg , outbreaks , sudden drops ) • detect anomalies ( ie , possible errors ) Uncovering the mechanisms and patterns of contagious diseases is an important and challenging task for public health scientists and policy makers . In this paper , we study a publicly available resource of epidemiological data : Tycho [ 32 ] , which contains the count of infections of 56 diseases in the U.S , covering over 125 years on a weekly basis . 2 Preview of our results . Figure 1 ( a ) shows the number of measles cases in the United States from 1928 to 1982 , as gray circles , and our fitted model , as a solid red line . The sequence has a clear yearly periodicity , but also characteristic bi and triennial patterns resulting in alternating large ( 1941 , 1958 ) and small ( 1940 , 1947 ) epidemic years [ 22 ] , which is known as “ skip ” phenomena [ 29 ] . It should also be noted that the number of cases suddenly dropped in 1965 . This was achieved because of the vaccination program that started in 1963 . Figure 1 ( b ) shows the potential population of susceptibles for measles for each state in the US The top three states in this respect are , NY , PA , and CA .
Figure 1 ( c ) shows a scatter plot of the seasonality strength vs . the peak season for each disease . We determined four categories of diseases in terms of ( 1 ) the strength of annual periodicity ( radius ) and ( 2 ) their phase difference , ie , the month in which they peak ( angle ) . For example , we found previously characterized epidemic peaks for influenza in January February and for respiratory childhood diseases ( eg , measles ) in the spring [ 27 ] , and for tick borne diseases ( eg , Lyme disease ) peaks in the summer [ 28 ] ; There is no periodicity for sexually transmitted diseases , ( eg , gonorrhea ) .
We can capture these important patterns in epidemic data with our proposed model , simply by changing its parameters . More importantly , our method is fully automatic , that is , it provides a good description of a large collection of epidemiological data , without user intervention , prior training , or parameter tuning . Contrast with competitors . Table 1 illustrates the relative advantages of our method . Only our approach has checks against all entries , while ,
• The SI model ( and SIR , SIRS , etc . ) can compress the data into a fixed number of parameters , and capture the dynamics of epidemiological data , however , it cannot describe periodic patterns , and is incapable of forecasting .
1Available at http://wwwcskumamoto uacjp/~yasuko/softwarehtml 2Project Tycho at University of Pittsburgh : http://wwwtychopittedu/ x 104
1930
1940
1950
Year
Vaccination
Original I(t )
1960
1970
1980
Original S(t ) I(t ) V(t ) t n u o C
6
4
2
0
105
) g o l ( t n u o C
1930
1940
1950
1960
1970
1980
Year
( a ) Fitting result of FUNNELFIT ( measles )
May ( 5 )
April ( 4 )
0.5
Measles
0.4
March ( 3 )
Rubella
June ( 6 )
Smallpox
Rocky mountain spotted fever
July ( 7 )
Lymedisease
0.3
Mumps
0.2
Chickenpox
0.1
Influenza
February ( 2 )
January ( 1 )
Streptococcal sore throat
Gonorrhea
August ( 8 )
Typhus fever
Typhoidfever
Cryptosporidiosis
December ( 12 )
September ( 9 )
November ( 11 )
October ( 10 )
( b ) Potential population of susceptibles ( measles )
( c ) Seasonality strength ( radius ) vs . peak season ( angle )
Figure 1 : Modeling power of FUNNELFIT : ( a ) the original number of measles cases ( gray dots ) , and our model ( red lines ) . It captures the yearly cycle , external spikes , and vaccination starting in 1963 , as well as ( b ) the local sensitivity ( eg , many patients in NY , PA , CA , TX ) ; ( c ) the scatter plot of the seasonality strength vs . the peak season ( angle ) : the peak month for each disease and ( radius ) : the strength of the fluctuation , eg , influenza peaks every winter , measles in the spring , and no periodicity for gonorrhea .
Table 1 : Capabilities of approaches . Only our approach meets all specifications .
Compression Domain knowledge Missing values Periodicity Forecasting Parameter free
√
SIRS AR/PLiF √ √ √
√ √
PARAFAC
√
FUNNELFIT
√ √ √ √ √ √
• The auto regression ( AR ) model and PLiF [ 15 ] have the ability to compress and forecast sequences , but they are fundamentally unsuitable for epidemic data , and cannot capture the non linear patterns of virus propagation .
• Our epidemic data can be turned into a tensor . PARAFAC is capable of compression , but it cannot handle missing values , periodicity , or forecasting .
Most importantly , none of above are parameter free methods . Contributions . Our method has the following desirable properties :
1 . Sense making : thanks to our modeling framework , our method can provide an intuitive explanation for epidemics , such as the seasonality of diseases , vaccination , and external shocks . It matches the behavior of various types of contagious diseases , such as measles , influenza , and smallpox .
2 . Automatic : it is fully automatic , requiring no human intervention . Our algorithm is theoretically founded on the idea of minimizing the cost of the resulting modeling .
3 . Scalable : it scales linearly with the input size . 4 . Generality : it includes earlier patterns and models as special cases ( eg , SIRS ) , and it can be applied to various types of epidemic data including computer virus infections .
Outline . The rest of the paper is organized in the conventional way : Next we describe related work , followed by our proposed model and algorithms , experiments , discussion and conclusions .
2 . RELATED WORK
We provide a survey of the related literature , which falls broadly into two categories : ( 1 ) epidemiology , and ( 2 ) pattern discovery in time series .
Epidemiology . The canonical textbook for epidemiological models including SI/SIR is Anderson and May [ 2 ] . Grenfell et al . [ 9 ] studied the recurrent travelling waves for measles , while the work in [ 8 ] explained the complex dynamical transitions in epidemics . Stone et al . [ 29 ] studied the seasonal dynamics of recurrent epidemics including measles , and identified a new threshold for predicting the occurrence of either a future epidemic , or a ‘skip’ ( ie , a year in which an epidemic fails to initiate ) . Van Panhuis et al . [ 32 ] digitized the entire history of weekly Nationally Notifiable Disease Surveillance Reports for the US from 1888 to 2013 . Pattern discovery in time series . In recent years , there has been an explosion of interest in mining time series [ 4 , 6 , 21 , 16 ] . Traditional approaches applied to data mining include auto regression ( AR ) , linear dynamical systems ( LDS ) , Kalman filters ( KF ) and their variants [ 10 , 15 , 31 ] . Similarity search and pattern discovery in time sequences have also attracted huge interest [ 33 , 13 , 30 , 26 , 7 ] . Regarding large scale time series mining , TriMine [ 18 ] is a scalable method for forecasting co evolving multiple ( thousands of ) sequences , while , [ 17 ] developed a fully automatic mining algorithm for co evolving time sequences . Rakthanmanon et al . [ 25 ] proposed a similarity search algorithm for “ trillions of time series ” under the DTW distance . Recently , analyses of epidemics , social media , propagation and the cascades they create have attracted much interest [ 24 , 12 , 14 , 23 , 19 ] .
However , none of these methods specifically focused on auto matic mining of non linear dynamics in coevolving epidemics .
3 . PROPOSED MODEL
In this section we present our proposed model .
3.1 Design philosophy of FUNNEL Data description . The Project Tycho [ 32 ] covers more than a century of weekly surveillance reports of nationally notifiable diseases ( 56 diseases in total ) for all 50 states in the U.S , from 1888 to the present , with 87,950,807 reported individual cases for diseases .
This dataset consists of tuples of the form : ( disease , location , timestamp ) . We then have a collection of entries with d unique diseases , and l states , with duration n ( on a weekly basis ) . We can
105
) g o l ( s e s a c f o
#
100
105
) g o l ( s e s a c e r u
100 100
40
60
Temperature ( F )
80
1942 1943 1944 1945 1946 t a r e p m e T
50
0
1942 1943 1944 1945 1946
Year
104
102
) g o l ( s e s a c f o
#
) g o l ( s e s a c
104 102 100 100 e r u
50
0 t a r e p m e T
CA TX VA
20
40
60 Temperature ( F )
80
1931 1932 1933 1934 1935
CA NY PA
1931 1932 1933 1934 1935
Year
( a ) Influenza ( in CA , TX , VA )
( b ) Measles ( in CA , NY , PA )
Figure 2 : The air temperature vs . # of cases : ( a ) influenza is completely anti correlated with the air temperature ( ie , peaking in the winter ) , while , ( b ) measles also has strong periodicity , but it peaks in the spring ( ie , with a phase shift ) . treat this set of d × l epidemic sequences as a 3rd order tensor , ie , X ∈ Nd×l×n , where the element xij(t ) of X shows the total number of entries of the i th disease in the j th state at time tick t . For example , ( ‘measles’ , ‘PA’ , ‘April 1 7 , 1931’ ; 4740 ) , means that the number of cases due to ‘measles’ in ‘PA’ on ‘April 1 7 in 1931’ is ‘4740’ . count of the i th disease at time tick t , ie , ¯xi(t ) = Pl
We refer to each sequence of the i th disease in the j th state : xij = {xij(t)}n t=1 , as a “ local/state ” level epidemic sequence . Similarly , we can turn these local sequences into “ global/country ” level epidemics : ¯xi = {¯xi(t)}n t=1 , where ¯xi(t ) shows the total j=1 xij(t ) . Preliminary observations . Here , we provide the reader with several important observations . Figure 2 shows the scatter plots ( top ) and sequence plots ( bottom ) of the original local level sequences of influenza and measles counts in three states , versus the average air temperature for five years . In Figure 2 ( a ) , influenza cases are strongly anti correlated with the air temperature , corresponding to influenza epidemics in colder seasons . On the other hand , for measles ( Figure 2 ( b) ) , the scatter plot exhibits characteristic loop shapes , which indicates that there is a phase shift of measles vs . temperature actually , measles peaks in the spring . As shown in Figure 1 ( c ) , there are several groups of infectious diseases with specific seasonal patterns , including children ’s diseases ( eg , measles , mumps ) in the spring , and tick borne diseases ( eg , Lyme disease ) in the summer . Consequently we have :
3
OBSERVATION 1
( DISEASE SEASONALITY ) . Many diseases have yearly cycles with different phases , that is , they are correlated with air temperature and the seasons .
The next observation refers to the abrupt decline of several diseases . Luckily , many diseases have been eradicated or significantly reduced over the last century , through various factors including vaccination , sanitation and antibiotics . For example , in Figure 1 ( a ) , the number of measles cases has been decreasing since the vaccination program was introduced in 1963 . We will collectively refer to such abrupt declines as disease reduction effects .
OBSERVATION 2
( DISEASE REDUCTION EFFECT ) . Many infectious diseases have been reduced or eliminated through vaccination programs , antibiotics , sanitation , etc .
Next , let us look at the topic from a local point of view .
In Figure 2 , three local sequences are correlated with each other , but with different fractions of patients , which correspond to the number of susceptible people in each state . For example , measles mainly affects children , and so , the more children there are , the more cases of measles there will be ( see , NY , PA , CA , TX , in Figure 1 ( b) ) . 3 National climate data center : http://wwwncdcnoaagov/cag/
Table 2 : Symbols and definitions
Symbol Definition d l n X xij ¯xi Sij ( t ) Iij ( t ) Vij ( t ) B
Number of diseases Number of states ( ie , locations ) Duration of sequences 3rd order tensor ( X ∈ Nd×l×n ) Local level epidemic sequence of disease i in state j Global level epidemic sequence of disease i Count of susceptibles of disease i in state j at time t Count of infectives of disease i in state j at time t Count of vigilants of disease i in state j at time t Base matrix ( d × 6 ) ie , B = {b1 , . . . , bd} Disease reduction matrix ( d × 2 ) Geo disease matrix ( d × l ) External shock tensor ie , E = {E(D ) , E(T ) , E(S)} Mistake tensor ie , M = {mij ( t)}d,l,n Complete set of FUNNEL ie , F = {B , R , N , E , M } ie , N = {Nij}d,l i,j,t=1 i,j=1 ie , R = {r1 , . . . , rd}
R
N
E
M
F OBSERVATION 3
( AREA SPECIFICITY AND SENSITIVITY ) . For each disease , neighbors are correlated with different sensitivity .
The last two observations are the extra properties of epidemics . Figure 1 ( a ) shows large outbreaks of measles in 1941 and 1958 , while Figure 2 ( a ) shows two large flu pandemics in 1944 and 1946 .
OBSERVATION 4
( EXTERNAL SHOCK EVENTS ) . There are some extreme spikes , representing major events such as historical flu pandemics .
Basically , real world datasets are subject to quality constraints such as typing errors and incorrect reports ( we refer to them as “ mistakes ” ) .
OBSERVATION 5
( MISTAKES ) . There are some implausible spikes , which are completely independent of the dynamics of epidemic patterns . Summary . In this paper , we propose a new model , namely , FUNNEL , which tries to incorporate all the above important properties that we observed in the real epidemic data . Consequently , we would like to capture the following properties :
• ( P1 ) : yearly periodicity • ( P2 ) : disease reduction effects • ( P3 ) : area specificity and sensitivity • ( P4 ) : external shock events • ( P5 ) : mistakes , incorrect values
For simplicity , let ’s focus on a simple step first , where ( a ) we assume that we are given a single epidemic sequence , say , the number of measles cases in NY . We then ( b ) extend our model to multiple co evolving epidemics , that is , to capture the individual patterns of d diseases in l states .
3.2 FUNNEL with a single epidemic
We begin with the simplest case , where we assume that we are given a single epidemic sequence .
321 Base model FUNNEL BASE
The model we propose has nodes ( =people ) of three classes : • Susceptible : nodes in this class can get infected by any neigh boring node who is infectious .
• Infected : nodes who have been infected and are capable of transmitting the infection to those in the susceptible class .
• Vigilant ( ie , recovered/immune ) : nodes in this class cannot get infected nor can they cause infections .
Figure 3 ( a ) shows a diagram of our base model , where , β(t ) represents the rate of effective contacts between infected and susceptible individuals ; δ is the rate at which infected individuals recovered ; γ is the immunization loss probability for a recovered or
γ
!!
"!
β(t )
#!
δ
ε(t )
!!
γ
θ(t )
"!
β(t )
#!
δ
( a ) FUNNEL BASE
( b ) FUNNEL RE
Figure 3 : FUNNEL diagrams : there are three classes susceptible ( ie , healthy , but can get infected ) , infected ( ie , capable of transmission ) , vigilant ( ie , healthy , and cannot get infected ) . vigilant individual . 4 More importantly , to handle the first property of epidemics : ( P1 ) , we assume that the infection rate β(t ) is a periodic function of time t . We refer to it as FUNNEL BASE .
MODEL 1
( FUNNEL BASE ) . Let S(t ) , I(t ) , V ( t ) be the number of susceptible , infected , vigilant people at time tick t . Our base model is governed by the following equations :
S(t + 1 ) = I(t + 1 ) =
S(t ) − β(t)S(t)I(t ) + γV ( t ) I(t ) + β(t)S(t)I(t ) − δI(t )
V ( t + 1 ) =
V ( t ) + δI(t ) − γV ( t )
( 1 ) where β(t ) = β0 · 1 + Pa · cos , 2π
Pp and , we have the invariant N = S(t ) + I(t ) + V ( t ) , with initial conditions S(1 ) = N − 1 , I(1 ) = 1 , V ( 1 ) = 0 .
( t + Ps) , Pp = 52 , 5
Consequently , FUNNEL BASE consists of a set of the following parameters : b = {N , β0 , δ , γ , Pa , Ps} , specifically ,
• N : Potential population of the disease . N is composed of susceptible , infected and vigilant individuals .
• β0 : Rate of effective contacts between infected and suscepti ble individuals averaged over the year .
• δ : Healing rate of the disease . • γ : Forgetting rate of the diseases . • Pa : Amplitude of the fluctuation , specifically , it gives the relative value of the peak/off season . • Ps : Phase shift of the seasonal cycle .
322 With disease reduction FUNNEL R
With respect to the second property : ( P2 ) , we also introduce an essential concept , namely , the “ disease reduction ” effect .
MODEL 2
( FUNNEL R ) . We add a disease reduction rate : θ(t ) , to capture the effect of the disease reduction program , that is , S(t + 1 ) = S(t ) − β(t)S(t)I(t ) + γV ( t ) − θ(t)S(t )
I(t + 1 ) = I(t ) + β(t)S(t)I(t ) − δI(t ) V ( t + 1 ) = V ( t ) + δI(t ) − γV ( t ) + θ(t)S(t )
( 2 ) where , the disease reduction program started at time tθ and θ(t ) is defined as : θ(t ) = fl 0
θ0
( t < tθ ) ( t ≥ tθ )
The model is identical to FUNNEL BASE , with the addition of the disease reduction factor , θ(t ) , which corresponds to the direct immunization probability when susceptible ( see Figure 3 ( b) ) . Note that this effect is due to vaccination , antibiotics and any other antidisease factors . Hereafter , we simply say the “ disease reduction effect ” , unless otherwise specified .
In addition to the base parameters b , FUNNEL R requires a set of two parameters , r = {tθ , θ0} , where ,
• tθ : Starting time of the disease reduction effect . • θ0 : Diffusion rate of the disease reduction effect .
4 This factor also incorporates the birth and mortality rate . 5We have 52 time ticks ( weeks ) in one year .
323 With external shocks FUNNEL RE
Next , with respect to the property : ( P4 ) , we assume that there are external shock events , such as flu pandemics . So how do we go about capturing such unexpected patterns ? Assume that there is a swine flu pandemic . In this situation , many more people in the susceptible class would become infected than in previous years .
An elementary concept we need to introduce is the temporal susceptible rate : ǫ(t ) . Figure 3 ( b ) describes how this is done . The idea is that the number of susceptibles S(t ) is the count of victims available for infection , and if there is an external shock event at time tick t , the virus attacks are much stronger than usual , and , each victim attack pair would lead to a new victim , and will eventually cause a major pandemic .
MODEL 3
( FUNNEL RE ) . Our full model can be described as the following equations :
S(t + 1 ) = S(t ) − β(t)ǫ(t)S(t)I(t ) + γV ( t ) − θ(t)S(t )
I(t + 1 ) = I(t ) + β(t)ǫ(t)S(t)I(t ) − δI(t ) V ( t + 1 ) = V ( t ) + δI(t ) − γV ( t ) + θ(t)S(t )
( 3 )
In addition , we introduce the temporal susceptible rate , ǫ(t ) , which is defined as follows :
ǫ(t ) = 1+ k
Xi=1 f ( t ; e
( T ) i
) , f ( t ; e(T ) ) = fl ǫ0
0
( tµ − tσ < t < tµ + tσ ) ( else ) where , k is the number of shocks , and if k = 0 , then ǫ(t ) = 1 . Here , each external shock consists of e(T ) = {tµ , tσ , ǫ0} , ie ,
• tµ : Central time point of the external shock event . • tσ : Duration of the event . • ǫ0 : Strength of the external shock effect .
3.3 FUNNEL with multi evolving epidemics So far we have seen how FUNNEL captures the dynamics of a single epidemic sequence . The next question is , “ how can we apply FUNNEL to multiple co evolving epidemics in X , and capture the individual behavior of d diseases in l states ? ”
We want to estimate the parameter set of FUNNEL , for each individual epidemic sequence in X . The straightforward solution would be that we consider a set of ( d × l ) sequences of length n generated from X : {xij}d,l i,j=1 , ( i.e , “ local level ” epidemic sequences ) , and estimate parameter set : {b , r , e(T )} for each sequence . However , some of the ( disease , state ) pairs have very sparse sequences ( eg , Lyme disease in Alaska ) , which derails the fitting result . Also , we are interested in capturing global/countrylevel patterns , as well as local/state level trends . So how can we deal with this issue ? We thus propose “ sharing ” the global level parameters for all l states , to achieve much better modeling . FUNNEL full model parameter set . Our goal is to extract the main trends and external patterns of co evolving epidemics X ∈ Nd×l×n , and make a good representation of X . Figure 4 shows our modeling framework . Given epidemic data X , we try to find important patterns with respect to the following five aspects , ( P1 ) B : base properties of diseases , ( P2 ) R : disease reduction effects , ( P3 ) N : locations vs . diseases , ( P4 ) E : external shock events , and ( P5 ) M : mistake values . The first two are global/countrylevel parameter sets , and the third is a local/state level parameter set , and the last two are used for describing extra trends in X .
DEFINITION 1
( COMPLETE SET OF FUNNEL ) . Let F be a complete set of parameters ( namely , F = {B , R , N , E , M } ) that describe the global/local/extra patterns of epidemics in X .
Next , we will see each property in detail .
( P1 ) , ( P2 ) Global/country view . Basically , we assume that the following parameters are the same for all l states .
( P1 , P2 ) : global/country view! ( P3 ) : local/state view! ( P4 , P5 ) : extra view E : shocks & M : mistakes!
N,β0,δ,γ , P a , P s
θ0 , t
θ
B
6
, d
R
2 d
, l
E d l
N
, l
M d
, n
( a ) FUNNEL structure ( ie , F = {B , R , N , E , M } )
= d time!
( ek)!
( S ) e 2
( T ) e 2
+
+
( S ) e k
( T ) e k
= l
E( S ) l
( S ) e 1 n
( T ) e 1
+
= d
( e2)! n k
µ , t t
σ,ε0 E(T ) k
! s l t e a d s t ! s e s a e s i d
X n l
E d
( e1)! n
( D ) e 1
( e1)!
( D ) e 2
( e2)!
( D ) e k
( ek)!
( b ) External shock tensor ( ie , E = {E(D ) , E(T ) , E(S)} ) e( D )
E( D )
1
3 k
Figure 4 : Illustration of FUNNEL structure : ( a ) we extract the important behavior of epidemics from an original tensor X , ( ie , the base matrix B , disease reduction matrix R , geo disease matrix N , external shock tensor E , and mistake tensor M ) ; Also , ( b ) the external shock tensor E can be described as a set of matrices ie , {E(D ) , E(T ) , E(S)} , for disease , state , time .
DEFINITION 2
( BASE MATRIX B ( d × 6) ) . Let B be a set of base parameters of d diseases , ie , B = {b1 , . . . , bd} where bi is the parameter set of the i th disease .
For example , the infection/healing rate of measles should be the same for NY and FL . Similarly , once the measles vaccine has been introduced , ( ie , the disease reduction effect ) , it could be immediately spread all over the country , that is , the starting time of the disease reduction effect would be the same for all locations .
DEFINITION 3
( DISEASE REDUCTION MATRIX R ( d × 2) ) . Let R be a parameter set of the reduction of d diseases , ie , R = {r1 , . . . , rd} where ri is the parameter set of the i th disease . ( P3 ) Local/state view . We also want to analyze and explain localspecific patterns and trends in X . So , what is the difference between measles in NY and in FL ? Our answer is : they are exactly the same , except for the “ local sensitivity ” of the disease . The idea is that we share the parameters of the global level matrices for all l states with but one exception , local sensitivity , Nij , which describes the potential population of the disease i in the j th state . Specifically , we set the invariant , Nij = Sij(t ) + Iij(t ) + Vij(t ) in Model 3 . This parameter corresponds to the fraction of individuals who are likely to be infected by the disease . For example , NY has more measles patients than FL , because it mainly affects children ( ie , there were more children in NY than FL , in the last century ) .
DEFINITION 4
( GEO DISEASE MATRIX N ( d × l) ) . Let N be a parameter set of the potential population of d diseases and l states , ie , N = {Nij}d,l i,j=1 , where Nij is the potential population of susceptibles of the i th disease in the j th state . ( P4 ) Extra view external shocks . Consider that in 1946 a serious flu pandemic spread throughout the country . We want to describe this external shock event in terms of three aspects , ( disease , state , time ) , eg , ( e1 ) “ influenza , country wide , 1946 ” . Similarly , there was a community wide outbreak of cryptosporidiosis in Utah , in 2007 . ie , ( e2 ) “ cryptosporidiosis , Utah , 2007 ” . To describe these external shock events , we create a new parameter set , namely external shock tensor E , which consists of a set of k external shock events , as described in Figure 4 ( b ) .
The external shock tensor E can be also decomposed into threeaspect matrices , {E(D ) , E(S ) , E(T)} , each of which shows the patterns in terms of disease , state , time . A single external shock event can be described as triplet vectors {e(D ) , e(S ) , e(T )} , where ,
• The shock ( disease ) vector e(D ) shows the assignment of the external shock to the disease ID ( ie , 1 ≤ e(D ) ≤ d ) .
10000
Original I(t )
Original I(t )
15000
10000
5000
0
) g o l ( t n u o C
100
Original 2007 2008 2009 2010 2011 2012 S(t ) I(t ) V(t )
Year
2007 2008 2009 2010 2011 2012
5000
0
105
) g o l ( t n u o C
100
( a ) External shock fitting
Year
2007 2008 2009 2010 2011 2012 Original S(t ) I(t ) V(t )
2007 2008 2009 2010 2011 2012 ( b ) Mistake fitting
Figure 5 : External shock vs . mistake for giardiasis in 2007 : ( a ) the model ( ie , red line ) is greatly influenced by the large distance of the outlier from the original sequence , while ( b ) it filters out the mistake point , and fits the sequence very well .
• The shock ( state ) vector e(S ) describes the participation strength of each state for each external shock event .
• The shock ( time ) vector e(T ) shows the temporal pattern of the external shock event .
Specifically , e(T ) is the global level parameters , as described in subsubsection 323 , and e(S ) is the local level parameters , ie , e(S ) = {e(S ) j=1 , where , we change ǫ0 in Model 3 to describe the strength of the external shock for l individual locations . That is , the strength of the shock effect in the j th state is , ǫ0 · e(S ) . Consequently , we have the following : j }l j
DEFINITION 5
( EXTERNAL SHOCK TENSOR E ) . Let E be a 3rd order tensor of k external shock events , ie , E = {E(D ) , E(S ) , E(T)} , where triplet matrices show the parameters in terms of three aspects , namely , “ disease ” , “ state ” , and “ time ” . ( P5 ) Extra view Mistakes . Basically , real datasets contain many errors such as incorrect reports . FUNNEL should detect and filter them out as outliers . We thus introduce an additional concept .
DEFINITION 6
( MISTAKE TENSOR M ) . Let M be a 3rd order tensor of mistake data points , where , the element mij(t ) of M shows the entry of the i th disease in the j th state at time tick t . Note that M is very sparse , and very often mij(t ) = 0 .
Figure 5 compares the fitting results of the external shock vs . mistake for the giardiasis cases , which contains an incongruous point in 2006 ( approximately , 10 , 000 ) . In this case , the point should be treated as ( b ) a mistake value , instead of ( a ) an external shock event ; in figure ( a ) , the model ( red line ) is strongly influenced by the extreme point , while in ( b ) , it successfully captures the real patterns of the original sequence .
4 . OPTIMIZATION ALGORITHM
In this section , we describe our fitting algorithm , FUNNELFIT . Our goal is to extract the important patterns of epidemics from X . More specifically , the problem that we want to solve is as follows :
PROBLEM 1 . Given a tensor X of ( disease , state , time ) triplets ,
Find a compact description that best summarizes X , that is , F = {B , R , N , E , M } .
We want to find a good representation F to solve the problem . The essential questions are : ( a ) How can we estimate the parameter set that best captures the dynamics and patterns in X ? ( b ) How should we decide the number of external shocks k ? ( c ) How can we ignore mistake ( ie , outlier ) values in X ?
4.1 Model quality and data compression
We provide a new intuitive coding scheme , which is based on the minimum description length ( MDL ) principle . In short , it follows the assumption that the more we can compress the data , the more we can learn about its underlying patterns . Model description cost . The description complexity of model parameter set consists of the following terms ,
• The number of diseases d , states l , and time ticks n require log∗(d ) + log∗(l ) + log∗(n ) bits . 6
• The model parameter set of the base ( B ) , reduction ( R ) , geodisease ( N ) matrices require d × 6 , d × 2 , d × l parameters , respectively , ie , CostM ( B)+CostM ( R)+CostM ( N ) = cF · d(6 + 2 + l ) , where cF is the floating point cost7 .
Similarly , the model description cost of the external shock tensor E = {E(D ) , E(S ) , E(T)} ) consists of the following :
• The number of external shocks k requires log∗(k ) bits . • The shock disease matrix E(D ) requires k log(d ) . • The shock time parameter set e(T ) = {tµ , tσ , ǫ0} in E(T ) requires log(n ) , log(n ) , cF , respectively .
• The shock state matrix E(S ) requires cF · kl .
Consequently , the model cost of the external shock tensor E is
CostM ( E ) = log∗(k ) + k,log(d ) + 2 log(n ) + cF · ( 1 + l) .
The model cost of mistake tensor M consists of
• The number of non zero elements in M requires log∗(|M | ) • The location of each non zero element and its value , mij(t ) require log(d),log(l),log(n ) , log∗(mij(t) ) , respectively .
Thus , CostM ( M ) = log∗(|M | ) +P|M | mij ( t)>0(log(d ) + log(l ) + log(n ) + log∗(mij(t)) ) , where , |M | is the number of non zero elements in M . Data coding cost . Once we have decided the full parameter set F , we can encode the data X using Huffman coding [ 3 ] , ie , a number of bits is assigned to each value in X , which is the logarithm of the inverse of the probability of the values ( here , we use a Gaussian distribution ) . The encoding cost of X given F Gauss(µ,σ)(xij(t ) − mij(t ) − Iij(t) ) , where , xij(t ) , mij(t ) are the elements in X and the mistake tensor M , respectively , and Iij(t ) is the estimated count of infections ( ie , Model 3 ) . Also , µ and σ are the mean and variance of the distance between the original and estimated values . 8 Putting it all together . Consequently , the total code length for X with respect to a given parameter set F can be described as follows : is : CostC ( X |F ) = Pd,l,n i,j,t=1 log2 p−1
6Here , log∗ is the universal code length for integers . 7We used 4 × 8 bits in our setting . 8 Here , µ , σ need 2cF bits , but we can eliminate them because they are constant values and independent of our modeling .
CostT ( X ; F ) = log∗(d ) + log∗(l ) + log∗(n ) +CostM ( B ) + CostM ( R ) + CostM ( N ) +CostM ( E ) + CostM ( M ) + CostC ( X |F )
( 4 )
Thus our next goal is to minimize the above function .
4.2 Multi layer optimization
Until now , we have seen how we can measure the goodness of the representation of X , if we are given a candidate parameter set F . The next question is , how to find an optimal solution of the full parameter set : F = {B , R , N , E , M } .
As described in subsection 3.3 , our FUNNEL model consists of multiple parameter sets , each of which explains either the local or global pattern of epidemics in X . For example , the base and reduction matrices B , R explain the global level behavior of each disease , while the geo disease matrix N describes the local level trends . Also , the extra tensors E , M consist of both the global and local level parameters . More specifically , the external shocks consists of E = {E(D ) , E(S ) , E(T)} ) , where , the first two are the global level , and the last one is the local level . Similarly , the mistake tensor can also be describes by the triplet matrix M = {M(D ) , M(S ) , M(T)} ) , each of which describes the location of the mistake values in terms of disease , state , time . So , how can we efficiently estimate these model parameters ?
We propose a multi layer optimization algorithm , to search for the optimal solution in terms of both the global and local level parameters . The idea is that we split parameter set F into two subsets , ie , FG and FL , each of which corresponds to a global/local level parameter set , and try to fit the parameter sets separately . Our algorithm consists of the following two phases :
• GLOBALFIT : find good global level parameters for { ¯xi}d i=1 , ie , FG = {B , R , E(D ) , E(T ) , M(D ) , M(T)}
• LOCALFIT : find good local level parameters : for {xij}d,l i,j=1 , ie , FL = {N , E(S ) , M(S)}
Here , the global epidemic sequence of the i th disease : ¯xi can be described as the sum of the l local sequences , ie , ¯xi(t ) = xij(t ) . Algorithm 1 shows an overview of FUNNELFIT .
Given a tensor X , it finds the full set of FUNNEL parameters . j=1
Pl
Algorithm 1 FUNNELFIT ( X ) 1 : Input : Tensor X ( d × l × n ) 2 : Output : Complete set of parameters , ie , F = {B , R , N , E , M } 3 : /* Parameter fitting for global level sequences */ 4 : {FG} =GLOBALFIT ( X ) ; 5 : /* Parameter fitting for local level sequences */ 6 : {FL} =LOCALFIT ( X , FG ) ; 7 : return F = {FG , FL} ;
421 Global level parameter fitting
Given a tensor X , our sub goal is to find the optimal global level parameter set : FG , to minimize the cost function ( ie , Equation 4 ) . We want to fit the basic parameters of each disease ( ie , the base and reduction matrices ) , and estimate the appropriate number of external shocks and mistake values , simultaneously . Finding the appropriate number of external shocks/mistakes is a particular issue here , because the parameter fittings are very sensitive to outliers , as described in Figure 5 ( a ) . To find a good basic parameter set for X , we have to filter out the external shocks and mistakes appropriately . Simultaneously , a good external shock/mistake filter requires a well estimated base model . We escape this circular dependency by applying an iterative method that employs externalshocks/mistakes detection and filtering , and basic model fitting in an alternating way until the cost function reaches a minimum value .
Algorithm 2 GLOBALFIT ( X ) 1 : Input : Tensor X 2 : Output : Set of global level parameters FG 3 : for i = 1 : d do 4 : 5 : 6 : E 7 : 8 : while improving the cost do
( T ) i = M
CostC ( ¯xi|b′ bi = arg min i = ∅ ;
( T )
Create ¯xi from X ; /* Global sequence ¯xi of i th disease */ /* Initialize external shocks and mistake values for disease i */ ( D ) i = E
( D ) i = M
( T ) i
) ; /* Base */ i , ri , E
( T ) i
, M b′ i ri = arg min r′ i
CostC ( ¯xi|bi , r′ i , E
( T ) i
, M
( T ) i
) ; /* Reduction */
9 :
10 : 11 : 12 : 13 :
14 :
( D ) i = E
( T ) i = M
( D ) i = M
E /* Find external shocks and mistakes for disease i */ while improving the cost do i = ∅ ; /* Initialize values */
( T ) e(T ) = arg min
CostC ( ¯xi|bi , ri , {E
( T ) i ∪ e′(T )} , M
( T ) i
) ; e′(T ) m(T ) = arg min m′(T )
CostC ( ¯xi|bi , ri , E
( T ) i
, {M
( T ) i ∪m′(T )} ) ;
;
( T )
( T )
( T )
( D )
( D )
( T ) i
( T ) i
( D ) i
( D ) i
( D ) i
( D ) i end while
∪ i} ; E
∪ i} ; M i = {E i = {M i = {M i ∪ m(T )} ;
; E(T ) = E(T ) ∪ E end while /* Update parameter set of i th disease */
/* Compare external shock vs . mistake */ if CostT ( ¯xi ; e(T ) ) < CostT ( ¯xi ; m(T ) ) then
/* External shock wins treat as an external shock */ i ∪ e(T )} ; i = {E E else /* Mistake wins treat as a mistake value */ ( T ) M end if
15 : 16 : 17 : 18 : 19 : 20 : 21 : 22 : 23 : 24 : 25 : 26 : B = B ∪ bi ; R = R ∪ ri ; 27 : E(D ) = E(D ) ∪ E ; 28 : M(D ) = M(D ) ∪ M ; M(T ) = M(T ) ∪ M 29 : end for 30 : return FG = {B , R , E(D ) , E(T ) , M(D ) , M(T)} ; External shock vs . mistake . There is also an important issue regarding the external shock vs . the mistake value . We want to distinguish automatically between an external shock event and a typing error . For example , in Figure 5 , there is a clear “ typo ” , rather than an external shock event . Our coding scheme enables us to provide the answer . The idea is that we try to fit the parameters by treating the data as both an external shock event and a mistake value , and then compare the cost of the two alternatives . For Figure 5 , the cost of ( b ) is less than ( a ) , thus the algorithm determines that there is a mistake value in 2007 . Algorithm . Algorithm 2 is a detailed algorithm of the global level fitting . Given a tensor X , it creates a set of d global sequences : { ¯xi}d i=1 . It tries to fit the global level parameter set , as well as find the appropriate number of external shocks/mistakes . We use the Levenberg Marquardt ( LM ) algorithm to minimize the cost function . Note that the extra tensors E and M consist of an entry ( disease , state , time ) , but this algorithm can find only the globallevel entry , which consists of ( disease , time ) . The local level entries E(S ) and M(S ) can be computed by local level parameter fitting , as shown next in Algorithm 3 . Also , the cost function ( Equation 4 ) includes the cost of local level parameters such as N , but these terms are independent of the global model fitting . Hence , we can simply consider them to be constant .
422 Local level parameter fitting
Given a set of d × l local level sequences , {xij}d,l i,j=1 ∈ X , and a set of global level parameters , FG , our next goal is to fit the individual parameters of each disease in each state , that is , FL = {N , E(S ) , M(S)} . We propose an iterative optimization algorithm ( see Algorithm 3 ) . Our algorithm searches for the optimal solution with respect to ( a ) the geo disease matrix N , ( b ) the local level
Algorithm 3 LOCALFIT ( X , B , R , E(D ) , E(T ) , M(D ) , M(T ) ) 1 : Input : ( a ) Tensor X , ( b ) global level parameter set FG 2 : Output : Set of local level parameters , ie , FL 3 : while improving the cost do 4 : 5 : 6 : 7 :
/* For each local sequence xij of i th disease in j th state */ for i = 1 : d do
CostC ( xij |B , R , N ′ for j = 1 : l do
Nij = arg min ij , E , M ) ;
N ′ ij end for end for end for
Update e(S ) to minimize the cost /* Local participation rate */ for each mistake ( m(D ) , m(S ) , m(T ) ) ∈ M do for each external shock ( e(D ) , e(S ) , e(T ) ) ∈ E do
8 : 9 : 10 : 11 : 12 : 13 : 14 : 15 : end for 16 : end while 17 : return FL = {N , E(S ) , M(S)} ; external shocks E(S ) , and ( c ) the local level mistake values M(S ) , so that the total coding cost is minimized .
Update m(S ) to minimize the cost /* Mistake value */
LEMMA 1 . The computation time of FUNNELFIT is O(dln ) .
PROOF . To create the global level sequences from X , the algorithm requires O(dln ) time . For global level parameter fitting , it needs O(#iter · ( k + |M | ) · dn ) time , where #iter is the number of iterations , k and |M | show the number of external shocks and non zero values in M , respectively . Similarly , for the local level parameter fitting , it needs O(#iter · ( k + |M | ) · dln ) time to fit the parameters . Note that #iter , k and |M | are small constant values that are negligible . Thus , the complexity is O(dln ) .
5 . EXPERIMENTS
In this section we demonstrate the effectiveness of FUNNEL with real epidemic data . The experiments were designed to answer the following questions :
Q1 Sense making : Can our method help us understand the given input epidemic data ?
Q2 Accuracy : How well does our method match the data ? Q3 Scalability : How does our method scale in terms of compu tational time ?
5.1 Matching co evolving epidemic patterns
We demonstrate how effectively FUNNEL can learn important patterns given a large collection of epidemics . Figure 6 shows the results of model fitting on 15 typical diseases . We show the original sequences ( ie , black dots ) and estimated sequences : I(t ) ( ie , red line ) in linear linear ( top ) and linear log ( bottom ) scales . In the log log scale , we also show the susceptible S(t ) and vigilant V ( t ) counts . We made several important observations , which correspond to the five properties of the epidemic sequences . ( P1 ) Disease seasonality . As we have already seen in the introduction section ( Figure 1(c) ) , we identified four categories ie ,
• Influenza has very strong periodic spikes , in January February . • Children ’s diseases ( eg , measles , mumps , chickenpox ) also have strong periodicity , but they peak in spring [ 27 ] .
• Tick borne diseases ( eg , Lyme disease ) , and cryptosporidiosis ( ie , water borne disease ) have strong periodicity , peaking in the summer , related to vector and human behavior and climate factors [ 28 ] .
• Gonorrhea , ie , sexually transmitted disease ( STD ) has no periodicity .
( P2 ) Disease reduction effects . FUNNEL is capable of automatically detecting the disease reduction impact . For example , in Figure 6
Er= 1.35e+02 ( 2.0e+04 , 0.54 , 0.45 , 0.13 ) , P=(0.1 , 12 ) , ( 1509 , 0.03 ) , k=16
World war II ( 1945 )
Original I(t )
3000 t n u o C
2000
1000
0
1930
1940
1950
Year
1960
1970
105 t n u o C
Original S(t ) I(t ) V(t )
1930
1940
1950
Year
1960
1970
( a ) Diphtheria ( P1 ) , ( P2 ) , ( P4 )
Er= 1.30e+02 ( 3.3e+04 , 0.55 , 0.46 , 0.09 ) , P=(0.2 , 45 ) , ( 3173 , 0.02 ) , k=8
Original I(t )
World War II
10000 t n u o C
5000
Original I(t )
8000
6000
4000
2000 t n u o C
Er= 2.23e+02 ( 7.0e+04 , 0.52 , 0.47 , 0.13 ) , P=(0.1 , 50 ) , ( 3329 , 0.01 ) , k=8
Original I(n )
0
1930
1935
1940
1945
1950
Year
1955
1960
1965
0
1970
1980
Year
1990
2000
Original S(t ) I(t ) V(t )
105 t n u o C
Original S(t ) I(t ) V(t )
1955
1960
1965
100
1970
1980
Year
1990
2000
1930
1935
1940
1945
1950
Year
( b ) Scarlet fever ( P1 ) , ( P2 ) , ( P4 )
( c ) Mumps ( P1 ) , ( P2 ) , ( P4 )
Er= 3.47e+02 ( 5.0e+04 , 0.52 , 0.45 , 0.13 ) , P=(0.0 , 34 ) , ( 2081 , 0.02 ) , k=32
Er= 9.27e+02 ( 8.8e+04 , 0.64 , 0.52 , 0.12 ) , P=(0.2 , 45 ) , ( 4889 , 0.03 ) , k=0
Original I(t )
10000
Vaccination t n u o C
5000
1970
1975
1980
1985
Year
1990
1995
2000
0
1975
1980
1985
Original S(t ) I(t ) V(t )
105 t n u o C
1990
1995
Year
2000
2005
2010
0
1940
1950
1960
Original S(t ) I(t ) V(t )
105 t n u o C
1970
1980
Year
1975
1980
( Missing values ) 2000
1990
1995
1985
Year
2005
2010
100
1940
1950
1960
1970
1980
Year
( e ) Chickenpox ( P1 ) , ( P2 )
( f ) Whooping cough ( P1 ) , ( P2 ) , ( P4 )
Original I(t )
1990
2000
2010
Original S(t ) I(t ) V(t )
1990
2000
2010 t n u o C
4000
3000
2000
1000
0
105 t n u o C
100 x 105
3
2
1 t n u o C
105 t n u o C
100
10000 t n u o C
5000 t n u o C
105
100 t n u o C
800
600
400
200
0 t n u o C
100
300
200
100 t n u o C
1970
1975
1980
1985
Year
1990
1995
2000
( d ) Rubella ( P1 ) , ( P2 ) , ( P4 )
Er= 7.04e+03 ( 8.8e+05 , 0.53 , 0.49 , 0.05 ) , P=(0.5 , 9 ) , ( 1821 , 0.00 ) , k=8
Original I(t )
Er= 1.07e+02 ( 1.9e+04 , 0.58 , 0.44 , 0.09 ) , P=(0.1 , 47 ) , ( 1041 , 0.03 ) , k=8
Smallpox epidemics in 1937 39
Original I(t )
2000
1500
1000
500 t n u o C
0
1930
1935
1940 Year
105 t n u o C
1945
1950
0
1930
Original S(t ) I(t ) V(t )
1935
Year
1940
1945
Original S(t ) I(t ) V(t )
1930
1935
1940 Year
1945
1950 t n u o C
800
600
400
200
0 t n u o C
100
( g ) Influenza ( P1 ) , ( P4 )
Er= 2.95e+01 ( 3.4e+03 , 0.51 , 0.46 , 0.12 ) , P=(0.2 , 27 ) , ( 4889 , 0.00 ) , k=1
Outbreak in Utah
Original I(t )
2007
2008
2009 Year
2010
2011
2012
Original S(t ) I(t ) V(t )
2007
2008
2009 Year
2010
2011
2012
( j ) Cryptosporidiosis ( P1 ) , ( P3 ) , ( P4 )
15000
10000
5000 t n u o C
0
105 t n u o C
100
Er= 1.24e+03 ( 2.0e+05 , 1.17 , 0.55 , 0.10 ) , P=(0.0 , 12 ) , ( 4785 , 0.09 ) , k=0
Original I(t )
2007
2008
2009 Year
2010
2011
Original S(t ) I(t ) V(t )
2007
2008
2009 Year
2010
2011
1930
1935
1940
1945
Year
( h ) Smallpox ( P1 ) , ( P2 ) , ( P4 )
Er= 7.76e+01 ( 2.7e+03 , 0.99 , 0.47 , 0.11 ) , P=(0.4 , 18 ) , ( 4889 , 0.03 ) , k=0
Original I(t )
2007
2008
2009 Year
2010
2011
2012 Original S(t )
I(t ) V(t )
2007
2008
2009 Year
2010
2011
2012
( k ) Lyme disease ( P1 )
Er= 2.33e+01 ( 1.7e+03 , 0.88 , 0.50 , 0.11 ) , P=(0.1 , 37 ) , ( 2289 , 0.05 ) , k=4
Original I(t )
0
1950
1960
1970
1980 Year
1990
2000
2010 t n u o C
100
1950
Original S(t ) I(t ) V(t )
1960
1970
1980 Year
1990
2000
2010
1500
1000
500 t n u o C
0
1930
105 t n u o C
100
1930
Er= 4.26e+01 ( 1.2e+04 , 0.59 , 0.48 , 0.11 ) , P=(0.2 , 24 ) , ( 2081 , 0.02 ) , k=16
Mistake
Original I(t )
1940
1950
1960
Year
1970
1980
Original S(t ) I(t ) V(t )
1940
1950
1960
Year
1970
1980
( i ) Typhoid fever ( P1 ) , ( P2 ) , ( P4 ) , ( P5 ) t n u o C
300
200
100
0 t n u o C
Er= 2.39e+01 ( 1.6e+03 , 1.15 , 0.51 , 0.10 ) , P=(0.2 , 15 ) , ( 1613 , 0.05 ) , k=0
Original I(t )
1943
1944 Year
1945
Original S(t ) I(t ) V(t )
100
1943
1944 Year
1945 t n u o C
200
150
100
50
0 t n u o C
100
( l ) Typhus fever ( P1 )
Er= 9.09e+00 ( 1.7e+03 , 0.62 , 0.47 , 0.10 ) , P=(0.0 , 23 ) , ( 2081 , 0.03 ) , k=8
Original I(t )
1950
1955
1960
1965
Year
1970
1975
1980
Original S(t ) I(t ) V(t )
1950
1955
1960
1965
Year
1970
1975
1980
( m ) Gonorrhea
( n ) Rabies in animals ( P1 ) , ( P2 ) , ( P4 )
( o ) Brucellosis ( P1 ) , ( P2 ) , ( P4 )
Figure 6 : Fitting results of FUNNEL for 15 diseases ( global level counts ) , shown in ‘lin lin’(top ) and ‘lin log’(bottom ) scales .
Figure 7 : The year of vaccine licensure [ 32 ] vs . detection .
Disease Measles Mumps Whooping cough ( pertussis ) Rubella licensure detected
1963 1967 1948 1969
1965 1975 1951 1972
1500
1000
E S M R
500
10000
5000
0
1930
105
100
1930
10000
Original I(t )
5000
Original I(t )
1950
Year
1970
Original S(t ) I(t ) V(t )
1950
Year
1970
0
1930
105
100
1930
1950
Year
1970
Original S(t ) I(t ) V(t )
) s ( e m i t k c o c l l l
1950
Year
1970 a W
( a ) New York State ( NY )
( b ) Pennsylvania ( PA )
Global
Local
40
35
30
25
E S M R
SIRS SKIPS Funnel R Funnel
SIRS
( a ) Global fitting
SKIPS Funnel R Funnel ( b ) Local fitting
Figure 9 : Fitting accuracy for the ( a ) global sequences : { ¯xi(t)}d,n i,t and ( b ) local sequences : {xij ( t)}d,l,n i,j,t . FUNNEL consistently outperforms the previous models wrt ther RMSE between real and estimated values ( lower is better ) .
) s ( e m i t k c o c l l l a W
3000
2500
2000
10
3000 2000 1000 0
10
20
30
40
50
Number of diseases ( d ) ( a ) Diseases ( d )
20
30
40
Number of states ( l ) ( b ) States ( l )
) s ( e m i t k c o c l l l a W
3000
2000
1000
0
50
2000
4000
6000
Number of time ticks ( n ) ( c ) Duration ( n )
Figure 8 : Local level fittings for measles : as with the global fitting shown in Figure 1 , FUNNEL fits very well .
Figure 10 : FUNNELFIT scales linearly : wall clock time vs . dataset size ( d × l × n ) . Our method is linear on the data size .
( a f ) , most children ’s diseases include the reduction patterns . Figure 7 shows the year the first vaccine was licensed vs . the year detected as the starting point of the disease reduction effect . Basically , there is a lag of 2 3 years between the licensure and the detected point , which could be related to the diffusion rate of a vaccination program . Note that FUNNEL does not detect any disease reduction effect for influenza ; This is because influenza epidemics continue to occur due to high mutation rates in influenza virus that limit protective immunity . ( P3 ) Area specificity . FUNNEL can find the local dynamics of each disease , as well as the global level pattern of epidemics . For example , as described in Figure 1 ( b ) , there are many measles patients in NY and PA . Specifically , Figure 8 shows the original local level epidemic sequences of measles in ( a ) NY and ( b ) PA , and the results of our fittings . FUNNEL successfully captures yearly periodic patterns , the disease reduction effects , and , also , the local spikes of each location ( ie , notice that the strengths of the external shock effects differ state to state ) . ( P4 ) External shock events . Figure 6 shows that FUNNELFIT automatically detects some important external shock events , eg ,
• ( a ) Diphtheria and ( b ) scarlet fever ( ie , children ’s diseases ) have multiple external shocks , eg , during World War II .
• ( g ) Flu has several major pandemics in 1929 , 1941 etc . , due to immune dynamics and antigenic changes in the virus [ 20 ] . • ( h ) Epidemics of a milder form of smallpox occurred in North western states in 1937 39 due to low vaccination rates [ 5 ] .
• ( j ) A major outbreak of Cryptosporidiosis , ( ie , water borne disease ) , was detected in Utah due to contaminated public pools in 2007 [ 1 ] .
( P5 ) Mistakes . One of the strong points of FUNNELFIT is its robustness against noise . It can handle “ mistake ” points as well as missing values ( eg , Figure 6 ( i ) typhoid fever , which contains missing values in the 1940s , and a mistake value in 1953 ) .
5.2 Model quality and scalability
Next , we discuss the quality of FUNNEL in terms of fitting accuracy . We compared FUNNEL with the standard SIRS model and SKIPS [ 29 ] . To evaluate the effect of the disease reduction parameters , we also compared with FUNNEL R , ( ie , removing external shocks and mistakes ) . Figure 9 ( a ) shows the root mean square error between the original and predicted counts of the global sequences { ¯xi(t)}d,n i,t . Similarly , Figure 9 ( b ) shows the results of the local counts {xij(t)}d,l,n i,j,t , A lower value indicates a better fitting accuracy . Note that the SIRS model cannot capture seasonal dynamics , while SKIPS has the ability to capture periodic patterns . Moreover , they are not intended to detect disease reductions , or external shocks . As shown in the figures , the SIRS model and SKIPS failed to capture the complicated patterns of epidemics , while our method achieved high fitting accuracy .
We also evaluated the scalability of FUNNELFIT , and verified the complexity of our method , which we discussed in Lemma 1 , in section 4 . Figure 10 shows the computational cost of FUNNELFIT in terms of the dataset size . We varied the dataset size with respect to ( a ) diseases d , ( b ) states l , and ( c ) duration n . As shown in Figure 10 , FUNNELFIT is linear with respect to data size .
6 . DISCUSSION
Here , we describe important applications and potential directions for our method . FUNNEL at work forecasting . Since FUNNEL has a very high fitting accuracy on real epidemic data , the most practical application would be forecasting . Figure 11 shows results of our forecasting in relation to three different diseases . We trained the model parameters by using the 2/3 values for each sequence ( solid black lines in the figure ) , and then forecasted the following years ( solid red lines ) . Note that the vertical axis uses a logarithmic scale .
We compared FUNNEL with the auto regressive ( AR ) model , where we used the regression coefficients : r = 52 ( ie , one year ) , 26 ( ie , half year ) , and 8 ( ie , the same size as our base ( 6 ) + reduction ( 2 ) parameters ) . Also , since the original sequences are bursty we took their logarithm for the AR forecast .
Our method achieves high forecasting accuracy while AR failed . Specifically , for ( a ) influenza , and ( b ) cryptosporidiosis , FUNNEL captured the future trend correctly , while AR was strongly affected by multiple extreme spikes ( eg , in figure ( b ) , there is a spike in 2007 ) . Similarly , for ( c ) typhoid fever , which includes the disease reduction pattern , missing/mistake values , FUNNEL successfully forecasted the periodic patterns after the disease reduction effect . Generality epidemics on computer networks . Another promising step for FUNNEL would be its generalization to other domains such as modeling computer viruses . Computer viruses have similar characteristics to biological viruses [ 11 ] . For example , Figure 12 shows the fitting result of FUNNEL on publicly available reports proposed=8.69e+03 , AR(52,26,8)=9.62e+03 , 9.76e+03 , 9.77e+03 proposed=2.62e+01 , AR(52,26,8)=1.19e+02 , 8.49e+01 , 9.03e+01
105
) g o l ( t n u o C
100
1930
Funnel AR(52 ) AR(26 ) AR(8 )
1935
1940 Year
1945
1950
( a ) Influenza
) g o l ( t n u o C
102
100
Funnel AR(52 ) AR(26 ) 2007 AR(8 )
2008
104
102
) g o l ( t n u o C proposed=6.99e+00 , AR(52,26,8)=9.29e+00 , 9.84e+00 , 1.02e+01
Funnel AR(52 ) AR(26 ) AR(8 )
1940
1950
1960
1970
1980
Year
( c ) Typhoid fever
2010
2011
2012
100
1930
2009 Year
( b ) Cryptosporidiosis
Figure 11 : Forecasting result : we train the model parameters using 2/3 of each sequence ( ie , solid black lines ) . We then start forecasting ( at the vertical dotted line ) . Note that the vertical axis uses a logarithmic scale .
[ 2 ] R . M . Anderson and R . M . May . Infectious Diseases of Humans Dynamics and
3000
2000
Sircam t n u o C
1000
0
Badtrans
Netsky
Mytob
Klez
2001
2002
2003
2004
2005
2006 Year ( per month )
2007
2008
2009
2010
Figure 12 : FUNNEL is general : our model ( solid lines ) fits computer virus data ( in circles ) very well . It captures rising spikes and viruse reduction effects ( ie , anti virus software ) . Note that it shows the reported case count for each virus . published by IPA , 9 which consists of annual reports on computer virus infections in Japan ( eg , private companies and public schools ) covering more than ten years . The figure shows the original counts for the top five viruses ( circles ) and our fittings ( solid lines ) from 2000 to 2010 . Here are some interesting observations : ( a ) “ Badtrans ” and “ Klez ” spread in 2001 2002 by exploiting a security hole in Microsoft Outlook . It spread very quickly due to the strong infection effect , but it also decayed very quick thanks to anti virus software ( ie , the virus reduction effect ) ; ( b ) “ Netsky ” , which spreads via email attachment : there were huge infections in 2004 , and it gradually decreased over the next 10 years , but still remains . Also , there is a weekly periodicity ( ie , less infection at weekends ) ; ( c ) “ Mytob ” , which spreads through corporate networks : there are some local level ( ie , intra office ) infections . Very recently , there have been several worms ( eg , “ Koobface ” , “ Fbphotofake ” ) that spread quickly through social networking sites including Facebook and Twitter , where they have a high potential population ( # of users ) .
7 . CONCLUSIONS
Our proposed method has the following appealing advantages : 1 . It is sense making : FUNNEL captures all essential aspects , ie , yearly periodicity , discontinuities , local sensitivities . It can lead to disease clustering , find disease reduction effects ( eg , vaccines ) and external shocks , and perform forecasting . 2 . It is automatic : FUNNELFIT requires no training set and no hint regarding the number of parameters . Thanks to our coding scheme , it determines all of the above automatically .
3 . It is scalable : FUNNELFIT scales very well , being linear on the database size , ( ie , O(dln) ) .
4 . It is general : We demonstrated the generality of FUNNEL , by applying it to real epidemic datasets , including computer virus infections , as well as human diseases .
Acknowledgement . We thank Dr . Donald S . Burke , Dean of the Graduate School of Public Health , University of Pittsburgh for his support and expert opinion during this study . This work was supported by JSPS KAKENHI Grant in Aid for Scientific Research Number 24500138 , 26730060 , 26280112 , 25·7946 . This material is based upon work supported by the National Science Foundation under Grant No . CNS1314632 . Any opinions , findings , and conclusions or recommendations expressed in this material are those of the author(s ) and do not necessarily reflect the views of the National Science Foundation . 8 . REFERENCES [ 1 ] Promotion of healthy swimming after a statewide outbreak of cryptosporidiosis associated with recreational water venues–utah , 2008 2009 . MMWR Morb Mortal Wkly Rep , 61(19):348–52 , 2012 .
9
IPA IT security center : https://wwwipagojp/security/english/indexhtml
Control . Oxford University Press , 1992 .
[ 3 ] C . Böhm , C . Faloutsos , J Y Pan , and C . Plant . Ric : Parameter free noise robust clustering . TKDD , 1(3 ) , 2007 .
[ 4 ] G . E . Box , G . M . Jenkins , and G . C . Reinsel . Time Series Analysis : Forecasting and Control . Prentice Hall , Englewood Cliffs , NJ , 3rd edition , 1994 .
[ 5 ] D . CC . Smallpox in the united states : It ’s decline and geographic distribution .
Public Health Reports , 55(50):2303–2312 , 1940 .
[ 6 ] L . Chen and R . T . Ng . On the marriage of lp norms and edit distance . In VLDB , pages 792–803 , 2004 .
[ 7 ] I . N . Davidson , S . Gilpin , O . T . Carmichael , and P . B . Walker . Network discovery via constrained tensor analysis of fmri data . In KDD , pages 194–202 , 2013 .
[ 8 ] D . J . Earn , P . Rohani , B . M . Bolker , and B . T . Grenfell . A simple model for complex dynamical transitions in epidemics . Science , 287(5453):667–70 , 2000 .
[ 9 ] B . T . Grenfell , O . N . Bjornstad , and J . Kappey . Travelling waves and spatial hierarchies in measles epidemics . Nature , 414:716 , 2001 .
[ 10 ] A . Jain , E . Y . Chang , and Y F Wang . Adaptive stream resource management using kalman filters . In SIGMOD , pages 11–22 , 2004 .
[ 11 ] J . Kephart and S . White . Directed graph epidemiological models of computer viruses . In Research in Security and Privacy , 1991 . Proceedings . , 1991 IEEE Computer Society Symposium on , pages 343–359 , May 1991 .
[ 12 ] R . Kumar , M . Mahdian , and M . McGlohon . Dynamics of conversations . In
KDD , pages 553–562 , 2010 .
[ 13 ] J G Lee , J . Han , and K Y Whang . Trajectory clustering : a partition and group framework . In SIGMOD , pages 593–604 , 2007 .
[ 14 ] J . Leskovec , L . Backstrom , R . Kumar , and A . Tomkins . Microscopic evolution of social networks . In KDD , pages 462–470 , 2008 .
[ 15 ] L . Li , B . A . Prakash , and C . Faloutsos . Parsimonious linear fingerprinting for time series . PVLDB , 3(1):385–396 , 2010 .
[ 16 ] Y . Matsubara , L . Li , E . E . Papalexakis , D . Lo , Y . Sakurai , and C . Faloutsos .
F trail : Finding patterns in taxi trajectories . In PAKDD ( 1 ) , pages 86–98 , 2013 .
[ 17 ] Y . Matsubara , Y . Sakurai , and C . Faloutsos . Autoplait : Automatic mining of co evolving time sequences . In SIGMOD , 2014 .
[ 18 ] Y . Matsubara , Y . Sakurai , C . Faloutsos , T . Iwata , and M . Yoshikawa . Fast mining and forecasting of complex time stamped events . In KDD , pages 271–279 , 2012 .
[ 19 ] Y . Matsubara , Y . Sakurai , B . A . Prakash , L . Li , and C . Faloutsos . Rise and fall patterns of information diffusion : model and implications . In KDD , pages 6–14 , 2012 .
[ 20 ] F . NM , G . AP , and B . RM . Ecological and immunological determinants of influenza evolution . Nature , 422(6930):428–33 , 2003 .
[ 21 ] S . Papadimitriou and P . S . Yu . Optimal multi scale patterns in time series streams . In SIGMOD Conference , pages 647–658 , 2006 .
[ 22 ] F . PE and C . JA . Measles in england and wales–i : An analysis of factors underlying seasonal patterns . Epidemiol , 11(1):5–14 , 1982 .
[ 23 ] B . A . Prakash , A . Beutel , R . Rosenfeld , and C . Faloutsos . Winner takes all : competing viruses or ideas on fair play networks . In WWW , pages 1037–1046 , 2012 .
[ 24 ] B . A . Prakash , D . Chakrabarti , M . Faloutsos , N . Valler , and C . Faloutsos .
Threshold conditions for arbitrary cascade models on arbitrary networks . In ICDM , pages 537–546 , 2011 .
[ 25 ] T . Rakthanmanon , B . J . L . Campana , A . Mueen , G . E . A . P . A . Batista , M . B .
Westover , Q . Zhu , J . Zakaria , and E . J . Keogh . Searching and mining trillions of time series subsequences under dynamic time warping . In KDD , pages 262–270 , 2012 .
[ 26 ] Y . Sakurai , S . Papadimitriou , and C . Faloutsos . Braid : Stream mining through group lag correlations . In SIGMOD , pages 599–610 , 2005 .
[ 27 ] D . SF . Seasonal variation in host susceptibility and cycles of certain infectious diseases . Emerg Infect Dis . , 7(3):369–74 , 2001 .
[ 28 ] M . SM , E . RJ , M . A , and M . P . Seasonality in six enterically transmitted diseases and ambient temperature . Am J Trop Med Hyg . , 2014 .
[ 29 ] L . Stone , R . Olinky , and A . Huppert . Seasonal dynamics of recurrent epidemics .
Nature , 446:533–536 , March 2007 .
[ 30 ] J . Sun , D . Tao , and C . Faloutsos . Beyond streams and graphs : dynamic tensor analysis . In KDD , pages 374–383 , 2006 .
[ 31 ] Y . Tao , C . Faloutsos , D . Papadias , and B . Liu . Prediction and indexing of moving objects with unknown motion patterns . In SIGMOD , pages 611–622 , 2004 .
[ 32 ] W . G . van Panhuis , J . Grefenstette , S . Y . Jung , N . S . Chok , A . Cross , H . Eng ,
B . Y . Lee , V . Zadorozhny , S . Brown , D . Cummings , and D . S . Burke . Contagious diseases in the united states from 1888 to the present . NEJM , 369(22):2152–2158 , 2013 .
[ 33 ] M . Vlachos , D . Gunopulos , and G . Kollios . Discovering similar multidimensional trajectories . In ICDE , pages 673–684 , 2002 .
