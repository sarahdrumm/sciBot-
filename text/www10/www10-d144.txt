Patch Based Skin Color Detection and Its Application to
Pornography Image Filtering Haiqiang Zuo†,‡ Weiming Hu† Ou Wu†
†National Laboratory of Pattern Recognition , Institute of Automation , CAS , Beijing , China
‡China University of Petroleum , Qingdao , China
{ hqzuo , wmhu , wuou }@nlpriaaccn industry for
ABSTRACT Along with the explosive growth of the World Wide Web , an immense the production and consumption of pornography has grown . Though the censorship and legal restraints on pornography are discriminating in different historical , cultural and national contexts , selling pornography to minors is not allowed in most cases . Detecting human skin tone is of utmost importance in pornography image filtering algorithms . In this paper , we propose two patch based skin color detection algorithms : regular patch and irregular patch skin color detection algorithms . On the basis of skin detection , we extract 31 dimensional features from the input image , and these features are fed into a random forest classifier . Our algorithm has been incorporated into an adult content filtering infrastructure , and is now in active use for preventing minors from accessing pornographic images via mobile phones . Categories and Subject Descriptors H33 [ Information Storage and Retrieval ] : Information Search and Retrieval –Information filtering . General Terms : Algorithms , Security . 1 . INTRODUCTION Over the past few decades , the explosive growth of the World Wide Web is reshaping the nature and environment of pornography at an accelerated pace . An immense industry for the production and consumption of pornography has grown , and pornography has become widely popular and generally distributed . The internet offers nearly free access to pornography uninhibited by previous barriers of time and space . Though the censorship and legal restraints on pornography are discriminating in different historical , cultural and national contexts , selling pornography to minors is not allowed in most cases . Detecting human skin tone is of utmost importance in most of pornography image filtering algorithms , and most of existing skin tone detecting algorithms are pixel based methods [ 1 ] , classifying each pixel as skin or non skin individually . However some attributes of human skin tone , such as textures , are only valid in a region . In this paper , we propose a patch based skin color detection algorithm that verifies whether all the pixels in a small patch correspond to human skin tone at one time . 2 . PATCH BASED SKIN COLOR DETECTION We first convert the original image from RGB color space to orthogonal YCbCr color space . The YCbCr space is one of the most popular choices for skin tone detection and has been used by many researchers such as Hsu et al[2 ] Y is the luminance ( or intensity ) component and Cb and Cr are the blue difference and red difference chrominance components . The image is split into small patches , and
Copyright is held by the author/owner(s ) . WWW 2010 , April 26–30 , 2010 , Raleigh , North Carolina , USA . ACM 978 1 60558 799 8/10/04 .
( cid:151 ) according to different patch generation methods , we develop two kinds of skin color detection algorithms . ( cid:151 ) Regular Patch Skin Color Detection . The patches are nonoverlapping sliding rectangle windows ( Figure 1 the red rectangles over each image component ) . Irregular Patch Skin Color Detection . The patches are irregular regions ( or superpixels ) generated by a common image segmentation algorithm . The last second row in Figure 2 demonstrates the segmentation results of Felzenszwalb algorithm [ 3 ] .
We extract 19 dimensional skin tone features on each patch . The first set of 15 features are skin tone texture features , and we use a covariance descriptor [ 4 ] to model skin texture . We extract image intensity and norm of first and second order derivatives of intensity in both x and y directions . Each pixel is mapped to a 5 dimensional feature space
F x y ( , )
⎡ = ⎢ ⎣
I x y ( , )
I x y ( , ) ∂ x ∂
I x y ( , ) ∂ y ∂
2
∂
I x y ( , ) x 2 ∂
2
∂
I x y ( , ) y 2 ∂
( 1 )
,
T ⎤ ⎥ ⎦ and each patch can be represented as a 5×5 dimensional symmetric covariance matrix :
C R
=
S
S
1 − ∑ 1
1 = i
( z i
−
) . T μ μ
)(
− z i
( 2 )
The nonsingular covariance matrices can be formulated as a connected Riemannian manifold , and tangent space projection techniques are used to map the covariance features into a Rm vector space . The tangent space is a m=15 dimensional vector space . Hence normal machine learning techniques can be used with these features . The last 4 features are the mean and standard deviation of patches in the Cr and Cb components respectively . Figure 1 demonstrates the whole skin tone feature extraction processes .
Figure 1 . Patch based skin tone feature extraction process .
For the regular patch skin color detection algorithm , integral images are employed to accelerate the feature extraction procedure . Initially , the patch size is set to 32×32 , and the patch will be split into smaller ones as to 4×4 if the sum of standard deviation of patches in the Cr and Cb components exceeds a predefined threshold .
WWW 2010 • PosterApril 26 30 • Raleigh • NC • USA1227
Figure 2 . Skin tone detection results : ( top row to bottom ) original image , result of Hsu [ 2 ] , result of GMM [ 5 ] , result of proposed regular patch algorithm , Felzenszwalb image segmentation[3 ] , result of proposed irregular patch algorithm . We collect 17,812 skin patches and 31,623 non skin patches , and the features extracting from these patches are used to train a random forests [ 6 ] classifier . Figure 2 the last third row and the last row demonstrate the results of our regular and irregular patch skin color detection algorithms respectively . The former algorithm is faster , but the obtained skin region boundaries are jagged . The latter algorithm can obtain more satisfactory results . 3 . PORNOGRAPHY IMAGE FILTERING On the basis of skin detection , we extract 31 dimensional features from the input image . The fist 5 features are global image features : ( cid:151 ) The image aspect ratio ; ( cid:151 ) The image entropy ; ( cid:151 ) The proportion of skin region ; ( cid:151 ) The skin region spatial moments ( 10 dimension ) ; ( cid:151 ) The number of skin region . The following 4 features are related to human body part detection , and haar like features [ 7 ] are employed . Figure 3 demonstrates the detection results . ( cid:151 ) The number of detected faces ; ( cid:151 ) The number of detected breasts ; ( cid:151 ) The number of detected vulvas ; ( cid:151 ) The ratio of skin area in the detected faces and that in the whole image . image ;
( cid:151 ) The ratio of the fit ellipse axes ; ( cid:151 ) The tilt angle of the fit ellipse ; ( cid:151 ) The Hu invariant moments [ 9 ] of the LSR ( 7 dimension ) ; ( cid:151 ) The roundness [ 10 ] of LSR ; ( cid:151 ) The irregularity [ 10 ] of LSR . Once the features have been computed for an image , they are fed into a random forest [ 6 ] classifier . Our training set consists of 13,649 images ; and among them , 3,784 were pornography and 9,865 were not . The test set consists of 26,151 images ; and 11,809 were pornography and 14,342 were not . At the test set , our algorithm gets a recall 98.8 % and precision 965 % As there does not exist a public consistent test set , and image quality , resolution , brightness etc . greatly affect experimental results , so comparing with others is of little significance . 4 . CONCLUSIONS We have proposed two patch based skin color detection algorithms : regular patch and irregular patch skin color detection algorithms . On the basis of skin detection , we have extracted 31dimensional features from the input image , and these features are fed into a random forest classifier . Our algorithm has been incorporated into an adult content filtering infrastructure , and is now in active use for preventing minors from accessing pornographic images via mobile phones . 5 . ACKNOWLEDGMENTS This work is partly supported by NSFC ( Grant No . 60935002 ) . 6 . REFERENCES [ 1 ] V . Vezhnevets , V . Sazonov , A . Andreeva . A Survey on Pixel
Based Skin Color Detection Techniques . Graphicon , 2003 . [ 2 ] R . Hsu , M . Abdel Mottaleb , A . K . Jain . Face Detection in
Figure 3 . Human body parts detection .
The last 7 features are extracted from the largest skin region ( LSR , as shown at the right side of Figure 3 , indicated by the aqua line ) and its fit ellipse [ 8 ] ( as shown at the right side of Figure 3 , indicated by the fuchsia line ) of the input image . ( cid:151 ) The ratio of LSR area and the skin area in the whole image ; ( cid:151 ) The distance from the center of fit ellipse to the center of input
Color Images . PAMI , 2002 .
[ 3 ] P . Felzenszwalb and D . Huttenlocher . Efficient graph based image segmentation . IJCV , 2004 .
[ 4 ] O . Tuzel , F . Porikli , and P . Meer . Region Covariance : A Fast
Descriptor for Detection and Classification . ECCV , 2006 . [ 5 ] M . J . Jones and J . M . Rehg . Statistical color models with applicationto skin detection . CVPR , 1999 .
[ 6 ] L . Breiman . Random Forests . Machine Learning , 2001 . [ 7 ] P . Viola and M . J . Jones . Rapid Object Detection Using a
Boosted Cascade of Simple Features . CVPR , 2001 .
[ 8 ] H . Zheng , M . Daoudi and B . Jedynak . Blocking Adult Images
Based on Statistical Skin Detection . ELCVIA , 2004 .
[ 9 ] M . K . Hu . Visual Pattern Recognition by Moment Invariants .
IRE Trans . Info . Theory , 1962 .
[ 10 ] C . R . Aragon , D . B . Aragon . A fast contour descriptor algorithm for supernova image classification . SPIE , 2007 .
WWW 2010 • PosterApril 26 30 • Raleigh • NC • USA1228
