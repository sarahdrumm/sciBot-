Enhanced Max Margin Learning on Multimodal Data Mining in a Multimedia Database
Zhen Guo , Zhongfei ( Mark ) Zhang
Computer Science Department
SUNY Binghamton
Binghamton , NY , 13902
Eric P . Xing , Christos Faloutsos
School of Computer Science Carnegie Mellon University
Pittsburgh , PA , 15213
{zguo,zhongfei}@csbinghamtonedu
{epxing,christos}@cscmuedu
ABSTRACT The problem of multimodal data mining in a multimedia database can be addressed as a structured prediction problem where we learn the mapping from an input to the structured and interdependent output variables . In this paper , built upon the existing literature on the max margin based learning , we develop a new max margin learning approach called Enhanced Max Margin Learning ( EMML ) framework . In addition , we apply EMML framework to developing an effective and efficient solution to the multimodal data mining problem in a multimedia database . The main contributions include : ( 1 ) we have developed a new max margin learning approach — the enhanced max margin learning framework that is much more efficient in learning with a much faster convergence rate , which is verified in empirical evaluations ; ( 2 ) we have applied this EMML approach to developing an effective and efficient solution to the multimodal data mining problem that is highly scalable in the sense that the query response time is independent of the database scale , allowing facilitating a multimodal data mining querying to a very large scale multimedia database , and excelling many existing multimodal data mining methods in the literature that do not scale up at all ; this advantage is also supported through the complexity analysis as well as empirical evaluations against a state of the art multimodal data mining method from the literature . While EMML is a general framework , for the evaluation purpose , we apply it to the Berkeley Drosophila embryo image database , and report the performance comparison with a state of the art multimodal data mining method .
Categories and Subject Descriptors H28 [ Database Management ] : Database Applications— Data mining,Image databases ; H33 [ Information Storage and Retrieval ] : Information Search and Retrieval— Retrieval models ; I51 [ Pattern Recognition ] : Models— Structural ; J.3 [ Computer Applications ] : Life and Medical Sciences—Biology and genetics
General Terms Algorithms , experimentation
Keywords Multimodal data mining , image annotation , image retrieval , max margin
1 .
INTRODUCTION
Multimodal data mining in a multimedia database is a challenging topic in data mining research . Multimedia data may consist of data in different modalities , such as digital images , audio , video , and text data . In this context , a multimedia database refers to a data collection in which there are multiple modalities of data such as text and imagery . In this database system , the data in different modalities are related to each other . For example , the text data are related to images as their annotation data . By multimodal data mining in a multimedia database it is meant that the knowledge discovery to the multimedia database is initiated by a query that may also consist of multiple modalities of data such as text and imagery . In this paper , we focus on a multimedia database as an image database in which each image has a few textual words given as annotation . We then address the problem of multimodal data mining in such an image database as the problem of retrieving similar data and/or inferencing new patterns to a multimodal query from the database .
Specifically , in the context of this paper , multimodal data mining refers to two aspects of activities . The first is the multimodal retrieval . This is the scenario where a multimodal query consisting of either textual words alone , or imagery alone , or in any combination is entered and an expected retrieved data modality is specified that can also be text alone , or imagery alone , or in any combination ; the retrieved data based on a pre defined similarity criterion are returned back to the user . The second is the multimodal inferencing . While the retrieval based multimodal data mining has its standard definition in terms of the semantic similarity between the query and the retrieved data from the database , the inferencing based mining depends on the specific applications . In this paper , we focus on the application of the fruit fly image database mining . Consequently , the inferencing based multimodal data mining may include many different scenarios . A typical scenario is the across stage multimodal inferencing . There are many interesting questions a biologist may want to ask in the fruit fly research given such a multimodal mining capability . For example , given an embryo image in stage 5 , what is the corresponding image in stage 7 for an image to image three stage inferencing ? What is the corresponding annotation for this image in stage 7 for an image to word three stage inferencing ? The multimodal mining technique we have developed in this paper also addresses this type of across stage inferencing capability , in addition to the multimodal retrieval capability .
In the image retrieval research area , one of the notorious bottlenecks is the semantic gap [ 18 ] . Recently , it is reported that this bottleneck may be reduced by the multimodal data mining approaches [ 3 , 11 ] which take advantage of the fact that in many applications image data typically co exist with other modalities of information such as text . The synergy between different modalities may be exploited to capture the high level conceptual relationships .
To exploit the synergy among the multimodal data , the relationships among these different modalities need to be learned . For an image database , we need to learn the relationship between images and text . The learned relationship between images and text can then be further used in multimodal data mining . Without loss of generality , we start with a special case of the multimodal data mining problem — image annotation , where the input is an image query and the expected output is the annotation words . We show later that this approach is also valid to the general multimodal data mining problem . The image annotation problem can be formulated as a structured prediction problem where the input ( image ) x and the output ( annotation ) y are structures . An image can be partitioned into blocks which form a structure . The word space can be denoted by a vector where each entry represents a word . Under this setting , the learning task is therefore formulated as finding a function f : X × Y → R such that
ˆy = arg max y∈Y f ( x , y )
( 1 ) is the desired output for any input x .
In this paper , built upon the existing literature on the max margin learning , we propose a new max margin learning approach on the structured output space to learn the above function . Like the existing max margin learning methods , the image annotation problem may be formulated as a quadratic programming ( QP ) problem . The relationship between images and text is discovered once this QP problem is solved . Unlike the existing max margin learning methods , the new max margin learning method is much more efficient with a much faster convergence rate . Consequently , we call this new max margin learning approach as Enhanced Max Margin Learning ( EMML ) . We further apply EMML to solving the multimodal data mining problem effectively and efficiently .
Note that the proposed approach is general that can be applied to any structured prediction problems . For the evaluation purpose , we apply this approach to the Berkeley Drosophila embryo image database . Extensive empirical evaluations against a state of the art method on this database are reported . multimodal approaches .
The learning with structured output variables covers many natural learning tasks including named entity recognition , natural language parsing , and label sequence learning . There have been many studies on the structured model which include conditional random fields [ 14 ] , maximum entropy model [ 15 ] , graph model [ 8 ] , semi supervised learning [ 6 ] and max margin approaches [ 13 , 21 , 20 , 2 ] . The challenge of learning with structured output variables is that the number of the structures is exponential in terms of the size of the structure output space . Thus , the problem is intractable if we treat each structure as a separate class . Consequently , the multiclass approach is not well fitted into the learning with structured output variables .
As an effective approach to this problem , the max margin principle has received substantial attention since it was used in the support vector machine ( SVM ) [ 22 ] . In addition , the perceptron algorithm is also used to explore the max margin classification [ 12 ] . Taskar et al . [ 19 ] reduce the number of the constraints by considering the dual of the loss augmented problem . However , the number of the constraints in their approach is still large for a large structured output space and a large training set .
For learning with structured output variables , Tsochantaridis et al . [ 21 ] propose a cutting plane algorithm which finds a small set of active constraints . One issue of this algorithm is that it needs to compute the most violated constraint which would involve another optimization problem in the output space . In EMML , instead of selecting the most violated constraint , we arbitrarily select a constraint which violates the optimality condition of the optimization problem . Thus , the selection of the constraints does not involve any optimization problem . Osuna et al . [ 16 ] propose the decomposition algorithm for the support vector machine . In EMML , we generalize their idea to the scenario of learning with structured output variables .
3 . HIGHLIGHTS OF THIS WORK
This work is based on the existing literature on max margin learning , and aims at solving for the problem of multimodal data mining in a multimedia database defined in this paper . In comparison with the existing literature , the main contributions of this work include : ( 1 ) we have developed a new max margin learning approach — the enhanced max margin learning framework that is much more efficient in learning with a much faster convergence rate , which is verified in empirical evaluations ; ( 2 ) we have applied this EMML approach to developing an effective and efficient solution to the multimodal data mining problem that is highly scalable in the sense that the query response time is independent of the database scale , allowing facilitating a multimodal data mining querying to a very large scale multimedia database , and excelling many existing multimodal data mining methods in the literature that do not scale up at all ; this advantage is also supported through the complexity analysis as well as empirical evaluations against a state of the art multimodal data mining method from the literature .
2 . RELATED WORK
Multimodal approaches have recently received the substantial attention since Barnard and Duygulu et al . started their pioneering work on image annotation [ 3 , 10 ] . Recently there have been many studies [ 4 , 17 , 11 , 7 , 9 , 23 ] on the
4 . LEARNING IN THE STRUCTURED OUT
PUT SPACE
Assume that the image database consists of a set of ini=1 , where each instance consists of stances S = {(Ii , Wi)}L can be expressed as a linear combination of each component in the joint feature representation : f ( x , ¯y ) = hα , Φ(x , ¯y)i . Then the learning task is to find the optimal weight vector α such that the prediction error is minimized for all the training instances . That is arg max ¯y∈Y(i ) f ( xi , ¯y ) ≈ yi , i = 1 , · · · , n where Yi = {¯y| PW j=1 yij } . We use Φi(¯y ) to denote Φ(xi , ¯y ) . To make the prediction to be the true output yi , we must follow j=1 ¯yj = PW
⊤Φi(yi ) ≥ α
⊤Φi(¯y ) ,
α
∀¯y ∈ Yi\{yi} where Yi\{yi} denotes the removal of the element yi from the set Yi . In order to accommodate the prediction error on the training examples , we introduce the slack variable ξi . The above constraint then becomes
⊤Φi(yi ) ≥ α
α
⊤Φi(¯y ) − ξi ,
ξi ≥ 0 ∀¯y ∈ Yi\{yi}
We measure the prediction error on the training instances by the loss function which is the distance between the true output yi and the prediction ¯y . The loss function measures the goodness of the learning model . The standard zero one classification loss is not suitable for the structured output space . We define the loss function l ( ¯y , yi ) as the number of the different entries in these two vectors . We include the loss function in the constraints as is proposed by Taskar et al . [ 19 ]
⊤Φi(yi ) ≥ α
⊤Φi(¯y ) + l ( ¯y , yi ) − ξi
α
1 kαk α
⊤[Φi(yi)−Φi(¯y ) ] as the margin of yi over We interpret another ¯y ∈ Y ( i ) . We then rewrite the above constraint as kαk [ l ( ¯y , yi ) − ξi ] . Thus , minimizkαk α ing kαk maximizes such margin .
⊤[Φi(yi ) − Φi(¯y ) ] ≥ 1
1
The goal now is to solve the optimization problem min st
2 kαk
+ C
1 2 n
X i=1
ξr i
⊤Φi(yi ) ≥ α α ∀¯y ∈ Yi\{yi} ,
⊤Φi(¯y ) + l ( ¯y , yi ) − ξi
ξi ≥ 0 , i = 1 , · · · , n
( 2 ) where r = 1 , 2 corresponds to the linear or quadratic slack variable penalty . In this paper , we use the linear slack variable penalty . For r = 2 , we obtain similar results . C > 0 is a constant that controls the tradeoff between the training error minimization and the margin maximization .
Note that in the above formulation , we do not introduce the relationships between different words in the word space . However , the relationships between different words are implicitly included in the VRep word pairs because the related words is more likely to occur together . Thus , Eq ( 2 ) is in fact a structured optimization problem . 4.1 EMML Framework
One can solve the optimization problem Eq ( 2 ) in the primal space — the space of the parameters α . In fact this problem is intractable when the structured output space is large because the number of the constraints is exponential in terms of the size of the output space . As in the traditional support vector machine , the solution can be obtained by solving this quadratic optimization problem in the dual space — the space of the Lagrange multipliers . Vapnik [ 22 ]
Figure 1 : An illustration of the image partitioning and the structured output word space an image object Ii and the corresponding annotation word set Wi . First we partition an image into a set of blocks . Thus , an image can be represented by a set of sub images . The feature vector in the feature space for each block can be computed from the selected feature representation . Consequently , an image is represented as a set of feature vectors in the feature space . A clustering algorithm is then applied to the whole feature space to group similar feature vectors together . The centroid of a cluster represents a visual representative ( we refer it to VRep in this paper ) in the image space . In Figure 1 , there are two VReps , water and duck in the water . The corresponding annotation word set can be easily obtained for each VRep . Consequently , the image database becomes the VRep word pairs S = {(xi , yi)}n i=1 , where n is the number of the clusters , xi is a VRep object and yi is the word annotation set corresponding to this VRep object . Another simple method to obtain the VRepword pairs is that we randomly select some images from the image database and each image is viewed as a VRep .
Suppose that there are W distinct annotation words . An arbitrary subset of annotation words is represented by the binary vector ¯y whose length is W ; the j th component ¯yj = 1 if the j th word occurs in this subset , and 0 otherwise . All possible binary vectors form the word space Y . We use wj to denote the j th word in the whole word set . We use x to denote an arbitrary vector in the feature space . Figure 1 shows an illustrative example in which the original image is annotated by duck and water which are represented by a binary vector . There are two VReps after the clustering and each has a different annotation . In the word space , a word may be related to other words . For example , duck and water are related to each other because water is more likely to occur when duck is one of the annotation words . Consequently , the annotation word space is a structured output space where the elements are interdependent .
The relationship between the input example VRep x and an arbitrary output ¯y is represented as the joint feature mapping Φ(x , ¯y ) , Φ : X × Y → Rd where d is the dimension of the joint feature space . It can be expressed as a linear combination of the joint feature mapping between x and all the unit vectors . That is
Φ(x , ¯y ) =
W
X j=1
¯yjΦ(x , ej ) where ej is the j th unit vector . The score between x and ¯y and Boyd et al . [ 5 ] have an excellent review for the related optimization problem .
The dual problem formulation has an important advantage over the primal problem : it only depends on the inner products in the joint feature representation defined by Φ , allowing the use of a kernel function . We introduce the Lagrange multiplier µi,¯y for each constraint to form the Lagrangian . We define Φi,yi,¯y = Φi(yi ) − Φi(¯y ) and the kernel function K ( (xi , ¯y ) , ( xj , ˜y ) ) = hΦi,yi ,¯y , Φj,yj ,˜yi . The derivatives of the Lagrangian over α and ξi should be equal to zero . Substituting these conditions into the Lagrangian , we obtain the following Lagrange dual problem min
1 2 X i,j
¯y6=yi ˜y6=yj
µi,¯yµj,˜yK ( (xi , ¯y ) , ( xj , ˜y))−X
µi,¯yl ( ¯y , yi ) ( 3 ) i
¯y6=yi st X ¯y6=yi
µi,¯y ≤ C µi,¯y ≥ 0 i = 1 , · · · , n
After this dual problem is solved , we have α = Pi,¯y µi,¯yΦi,yi,¯y .
For each training example , there are a number of constraints related to it . We use the subscript i to represent the part related to the i th example in the matrix . For example , let µi be the vector with entries µi,¯y . We stack the µi to⊤]⊤ . gether to form the vector µ . That is µ = [ µ1 Similarly , let Si be the vector with entries l ( ¯y , yi ) . We stack Si together to form the vector S . That is S = [ S⊤ n ]⊤ . The lengths of µ and S are the same . We define Ai as the vector which has the same length as that of µ , where Ai,¯y = 1 and Aj,¯y = 0 for j 6= i . Let A = [ A1 · · · An]⊤ . Let matrix D represent the kernel matrix where each entry is K ( (xi , ¯y ) , ( xj , ˜y) ) . Let C be the vector where each entry is constant C .
1 · · · S⊤
⊤ · · · µn
With the above notations we rewrite the Lagrange dual problem as follows able set µB when keeping µN =0 as follows min st
µ
⊤S
⊤Dµ − µ
1 2 Aµ C µB 0 , µN = 0
( 5 )
It is clearly true that we can move those µi,¯y = 0 , µi,¯y ∈ µB to set µN without changing the objective function . Furthermore , we can move those µi,¯y ∈ µN satisfying certain conditions to set µB to form a new optimization subproblem which yields a strict decrease in the objective function in Eq ( 4 ) when the new subproblem is optimized . This property is guaranteed by the following theorem .
Theorem 1 . Given an optimal solution of the subproblem defined on µB in Eq ( 5 ) , if the following conditions hold true :
∃i , P¯y
µi,¯y < C
∃µi,¯y ∈ µN , α
⊤ Φi,yi,¯y − l ( ¯y , yi ) < 0
( 6 ) the operation of moving the Lagrange multiplier µi,¯y satisfying Eq ( 6 ) from set µN to set µB generates a new optimization subproblem that yields a strict decrease in the objective function in Eq ( 4 ) when the new subproblem in Eq ( 5 ) is optimized .
Proof . Suppose that the current optimal solution is µ . Let δ be a small positive number . Let ¯µ = µ + δer , where er is the r th unit vector and r = ( i , ¯y ) denotes the Lagrange multiplier satisfying condition Eq ( 6 ) . Thus , the objective function becomes
W( ¯µ ) =
=
1 2 1 2 −µ
⊤S − δe ⊤ r S
( µ + δer)⊤D(µ + δer ) − ( µ + δer)⊤S
( µ
⊤Dµ + δe ⊤ r Dµ + δµ
⊤Der + δ2e ⊤ r Der ) min st
⊤Dµ − µ
µ
1 2 Aµ C µ 0
⊤S
( 4 )
1 2
= W(µ ) +
−δe ⊤ r S
( δe ⊤ r Dµ + δµ
⊤Der + δ2e ⊤ r Der )
= W(µ ) + δe ⊤ r Dµ − δe ⊤ r S +
1 2
δ2e ⊤ r Der where and represent the vector comparison defined as entry wise less than or equal to and greater than or equal to , respectively .
Eq ( 4 ) has the same number of the constraints as Eq ( 2 ) . However , in Eq ( 4 ) most of the constraints are lower bound constraints ( µ 0 ) which define the feasible region . Other than these lower bound constraints , the rest constraints determine the complexity of the optimization problem . Therefore , the number of constraints is considered to be reduced in Eq ( 4 ) . However , the challenge still exists to solve it efficiently since the number of the dual variables is still huge . Osuna et al . [ 16 ] propose a decomposition algorithm for the support vector machine learning over large data sets . We generalize this idea to learning with the structured output space . We decompose the constraints of the optimization problem Eq ( 2 ) into two sets : the working set B and the nonactive set N . The Lagrange multipliers are also correspondingly partitioned into two parts µB and µN . We are interested in the subproblem defined only for the dual vari
= W(µ ) + δ(α
⊤ Φi,yi,¯y − l ( ¯y , yi ) ) +
1 2
δ2kΦi,yi,¯yk2
⊤ Φi,yi,¯y − l ( ¯y , yi ) < 0 , for small enough δ , we Since α have W( ¯µ ) < W(µ ) . For small enough δ , the constraints A ¯µ C is also valid . Therefore , when the new optimization subproblem in Eq ( 5 ) is optimized , there must be an optimal solution no worse than ¯µ .
In fact , the optimal solution is obtained when there is no Lagrange multiplier satisfying the condition Eq ( 6 ) . This is guaranteed by the following theorem .
Theorem 2 . The optimal solution of the optimization prob lem in Eq ( 4 ) is achieved if and only if the condition Eq ( 6 ) does not hold true .
Proof . If the optimal solution ˆµ is achieved , the condition Eq ( 6 ) must not hold true . Otherwise , ˆµ is not optimal according to the Theorem 1 . To prove in the reverse direction , we consider the Karush Kuhn Tucker ( KKT ) conditions [ 5 ] of the optimization problem Eq ( 4 ) .
Dµ − S + A⊤
γ − π = 0
⊤(C − Aµ ) = 0 ⊤
µ = 0
γ
π
γ 0 π 0
For the optimization problem Eq ( 4 ) , the KKT conditions provide necessary and sufficient conditions for optimality . One can check that the condition Eq ( 6 ) violates the KKT conditions . On the other hand , one can check that the KKT conditions are satisfied when the condition Eq ( 6 ) does not hold true . Therefore , the optimal solution is achieved when the condition Eq ( 6 ) does not hold true .
The above theorems suggest the Enhanced Max Margin Learning ( EMML ) algorithm listed in Algorithm 1 . The correctness ( convergence ) of EMML algorithm is provided by Theorem 3 .
Algorithm 1 EMML Algorithm
Input : n labeled examples , dual variable set µ . Output : Optimized µ
1 : procedure 2 : 3 :
Arbitrarily decompose µ into two sets : µB and µN . Solve the subproblem in Eq ( 5 ) defined by the vari ables in µB .
4 : While there exists µi,¯y ∈ µB such that µi,¯y = 0 , move it to set µN .
5 : While there exists µi,¯y ∈ µN satisfying condition Eq ( 6 ) , move it to set µB . If no such µi,¯y ∈ µN exists , the iteration exits .
6 : Goto Step 3 . 7 : end procedure
Theorem 3 . EMML algorithm converges to the global op timal solution in a finite number of iterations .
Proof . This is the direct result from Theorems 1 and 2 . Step 3 in Algorithm 1 strictly decreases the objective function of Eq ( 4 ) at each iteration and thus the algorithm does not cycle . Since the objective function of Eq ( 4 ) is convex and quadratic , and the feasible solution region is bounded , the objective function is bounded . Therefore , the algorithm must converge to the global optimal solution in a finite number of iterations .
Note that in Step 5 , we only need find one dual variable satisfying Eq ( 6 ) . We need examine all the dual variables in the set µN only when no dual variable satisfies Eq ( 6 ) . It is fast to examine the dual variables in the set µN even if the number of the dual variables is large . 4.2 Comparison with other methods
In the max margin optimization problem Eq ( 2 ) , only some of the constraints determine the optimal solution . We call these constraints active constraints . Other constraints are automatically met as long as these active constraints are valid . EMML algorithm uses this fact to solve the optimization problem by substantially reducing the number of the dual variables in Eq ( 3 ) .
In the recent literature , there are also other methods attempting to reduce the number of the constraints . Taskar et al . [ 19 ] reduce the number of the constraints by considering the dual of the loss augmented problem . However , the number of the constraints in their approach is still large for a large structured output space and a large training set . They do not use the fact that only some of the constraints are active in the optimization problem . Tsochantaridis et al . [ 21 ] also propose a cutting plane algorithm which finds a small set of active constraints . One issue of this algorithm is that it needs to compute the most violated constraint which would involve another optimization problem in the output space . In EMML , instead of selecting the most violated constraint , we arbitrarily select a constraint which violates the optimality condition of the optimization problem . Thus , the selection of the constraint does not involve any optimization problem . Therefore , EMML is much more efficient in learning with a much faster convergence rate .
5 . MULTIMODAL DATA MINING
The solution to the Lagrange dual problem makes it possible to capture the semantic relationships among different data modalities . We show that the developed EMML framework can be used to solve for the general multimodal data mining problem in all the scenarios . Specifically , given a training data set , we immediately obtain the direct relationship between the VRep space and the word space using the EMML framework in Algorithm 1 . Given this obtained direct relationship , we show below that all the multimodal data mining scenarios concerned in this paper can be facilitated . 5.1 Image Annotation
Image annotation refers to generating annotation words for a given image . First we partition the test image into blocks and compute the feature vector in the feature space for each block . We then compute the similarity between feature vectors and the VReps in terms of the distance . We return the top n most relevant VReps . For each VRep , we compute the score between this VRep and each word as the function f in Eq ( 1 ) . Thus , for each of the top n most relevant VReps , we have the ranking list of words in terms of the score . We then merge these n ranking lists and sort them to obtain the overall ranking list of the whole word space . Finally , we return the top m words as the annotation result .
In this approach , the score between the VReps and the words can be computed in advance . Thus , the computation complexity of image annotation is only related to the number of the VReps . Under the assumption that all the images in the image database follow the same distribution , the number of the VReps is independent of the database scale . Therefore , the computation complexity in this approach is O(1 ) which is independent of the database scale . 5.2 Word Query
Word query refers to generating corresponding images in response to a query word . For a given word input , we compute the score between each VRep and the word as the function f in Eq ( 1 ) . Thus , we return the top n most relevant VReps . Since for each VRep , we compute the similarity between this VRep and each image in the image database in terms of the distance , for each of those top n most rele
( a )
( b )
Figure 2 : An example of 3 stage image to image inferencing . vant VReps , we have the ranking list of images in terms of the distance . Then we merge these n ranking lists and sort them to obtain the overall ranking list in the image space . Finally , we return the top m images as the query result .
For each VRep , the similarity between this VRep and each image in the image database can be computed in advance . Similar to the analysis in Sec 5.1 , the computation complexity is only related to the number of the VReps , which is O(1 ) .
5.3 Image Retrieval
Image retrieval refers to generating semantically similar images to a query image . Given a query image , we annotate it using the procedure in Sec 51 In the image database , for each annotation word j there are a subset of images Sj in which this annotation word appears . We then have the union set S = ∪j Sj for all the annotation words of the query image .
On the other hand , for each annotation word j of the query image , the word query procedure in Sec 5.2 is used to obtain the related sorted image subset Tj from the image database . We then merge these subsets Tj to form the sorted image set T in terms of their scores . The final image retrieval result is R = S ∩ T .
In this approach , the synergy between the image space and the word space is exploited to reduce the semantic gap based on the developed learning approach . Since the complexity of the retrieval methods in Secs . 5.1 and 5.2 are both O(1 ) , and since these retrievals are only returned for the top few items , respectively , finding the intersection or the union is O(1 ) . Consequently , the overall complexity is also O(1 ) .
5.4 Multimodal Image Retrieval
The general scenario of multimodal image retrieval is a query as a combination of a series of images and a series of words . Clearly , this retrieval is simply a linear combination of the retrievals in Secs . 5.2 and 5.3 by merging the retrievals together based on their corresponding scores . Since each individual retrieval is O(1 ) , the overall retrieval is also O(1 ) .
5.5 Across Stage Inferencing
For a fruit fly embryo image database such as the Berkeley Drosophila embryo image database which is used for our experimental evaluations , we have embryo images classified in advance into different stages of the embryo development with separate sets of textual words as annotation to those images in each of these stages . In general , images in different stages may or may not have the direct semantic correspondence ( eg , they all correspond to the same gene ) , not even speaking that images in different stages may necessarily exhibit any visual similarity . Figure 2 shows an example of a pair of identified embryo images at stages 9 10 ( Figure 2(a ) ) and stages 13 16 ( Figure 2(b) ) , respectively , in which they
Figure 3 : An illustrative diagram for image toimage across two stages inferencing both correspond to the same gene as a result of the imageto image inferencing between the two stages1 . However , it is clear that they exhibit a very large visual dissimilarity .
Consequently , it is not appropriate to use any pure visual feature based similarity retrieval method to identify such image to image correspondence across stages . Furthermore , we also expect to have the word to image and image to word inferencing capabilities across different stages , in addition to the image to image inferencing .
Given this consideration , this is exactly where the proposed approach for multimodal data mining can be applied to complement the existing pure retrieval based methods to identify such correspondence . Typically in such a fruit fly embryo image database , there are textual words for annotation to the images in each stage . These annotation words in one stage may or may not have the direct semantic correspondence to the images in another stage . However , since the data in all the stages are from the same fruit fly embryo image database , the textual annotation words between two different stages share a semantic relationship which can be obtained by a domain ontology .
In order to apply our approach to this across stage inferencing problem , we treat each stage as a separate multimedia database , and map the across stage inferencing problem to a retrieval based multimodal data mining problem by applying the approach to the two stages such that we take the multimodal query as the data from one stage and pose the query to the data in the other stage for the retrieval based multimodal data mining . Figure 3 illustrates the diagram of the two stages ( state i and state j where i 6= j ) image toimage inferencing .
Clearly , in comparison with the retrieval based multimodal data mining analyzed in the previous sections , the only additional complexity here in across stage inferencing
1The Berkeley Drosophila embryo image database is given in such a way that images from several real stages are mixed together to be considered as one “ stage ” . Thus , stages 9 10 are considered as one stage , and so are stages 13 16 . is the inferencing part using the domain ontology in the word space . Typically this ontology is small in scale . In fact , in our evaluations for the Berkeley Drosophila embryo image database , this ontology is handcrafted and is implemented as a look up table for word matching through an efficient hashing function . Thus , this part of the computation may be ignored . Consequently , the complexity of the across stage inferencing based multimodal data mining is the same as that of the retrieval based multimodal data mining which is independent of database scale .
6 . EMPIRICAL EVALUATIONS
While EMML is a general learning framework , and it can also be applied to solve for a general multimodal data mining problem in any application domains , for the evaluation purpose , we apply it to the Berkeley Drosophila embryo image database [ 1 ] for the multimodal data mining task defined in this paper . We evaluate this approach ’s performance using this database for both the retrieval based and the across stage inferencing based multimodal data mining scenarios . We compare this approach with a state of the art multimodal data mining method MBRM [ 11 ] for the mining performance .
In this image database , there are in total 16 stages of the embryo images archived in six different folders with each folder containing two to four real stages of the images ; there are in total 36,628 images and 227 words in all the six folders ; not all the images have annotation words . For the retrieval based multimodal data mining evaluations , we use the fifth folder as the multimedia database , which corresponds to stages 11 and 12 . There are about 5,500 images that have annotation words and there are 64 annotation words in this folder . We split the whole folder ’s images into two parts ( one third and two thirds ) , with the two thirds used in the training and the one third used in the evaluation testing . For the across stage inferencing based multimodal data mining evaluations , we use the fourth and the fifth folders for the two stages inferencing evaluations , and use the third , the fourth and the fifth folders for the three stages inferencing evaluations . Consequently , each folder here is considered as a “ stage ” in the across stage inferencing based multimodal data mining evaluations . In each of the inferencing scenarios , we use the same split as we do in the retrieval based multimodal data mining evaluations for training and testing .
In order to facilitate the across stage inferencing capabilities , we handcraft the ontology of the words involved in the evaluations . This is simply implemented as a simple look up table indexed by an efficient hashing function . For example , cardiac mesoderm primordium in the fourth folder is considered as the same as circulatory system in the fifth folder . With this simple ontology and word matching , the proposed approach may be well applied to this across stage inferencing problem for the multimodal data mining .
The EMML algorithm is applied to obtain the model parameters . In the figures below , the horizonal axis denotes the number of the top retrieval results . We investigate the performance from top 2 to top 50 retrieval results . Figure 4 reports the precisions and recalls averaged over 1648 queries for image annotation in comparison with MBRM model where the solid lines are for precisions and the dashed lines are for recalls . Similarly , Figure 5 reports the precisions and recalls averaged over 64 queries for word query in com
Table 1 : Comparison of scalability
Database Size
EMML MBRM
50 1 1
100
1 2.2
150
1 3.3
EMML MBRM
0.24
0.22
0.20
0.18
0.16
0.14
0.12
0.10
0.08
0.06
1.0
0.8
0.6
0.4
0.2
0.0
) n ( l l a c e R e g a r e v A n o i t t a o n n A e g a m
I i i
) n ( n o s c e r P e g a r e v A n o i t t a o n n A e g a m
I
0
10
20
30
40
50
Top(n )
Figure 4 : Precisions and Recalls of image annotation between EMML and MBRM ( the solid lines are for precisions and the dashed lines are for recalls ) parison with MBRM model . Figure 6 reports the precisions and recalls averaged over 1648 queries for image retrieval in comparison with MBRM model .
For the 2 stage inferencing , Figure 7 reports the precisions and recalls averaged over 1648 queries for image to word inferencing in comparison with MBRM model , and Figure 8 reports the precisions and recalls averaged over 64 queries for word to image inferencing in comparison with MBRM model . Figure 9 reports the precisions and recalls averaged over 1648 queries for image to image inferencing in comparison with MBRM model . Finally , for the 3 stage inferencing , Figure 10 reports precisions and recalls averaged over 1100 queries for image to image inferencing in comparison with MBRM model .
In summary , there is no single winner for all the cases . Overall , EMML outperforms MBRM substantially in the scenarios of word query and image retrieval , and slightly in the scenario of 2 stage word to image inferencing and 3 stage image to image inferencing . On the other hand , MBRM has a slight better performance than EMML in the scenario of 2 stage image to word inferencing . For all other scenarios the two methods have a comparable performance . In order to demonstrate the strong scalability of EMML approach to multimodal data mining , we take image annotation as a case study and compare the scalability between EMML and MBRM . We randomly select three subsets of the embryo image database in different scales ( 50 , 100 , 150 images , respectively ) , and apply both methods to the subsets to measure the query response time . The query response time is obtained by taking the average response time over 1648 queries . Since EMML is implemented in MATLAB environment and MBRM is implemented in C in Linux environment , to ensure a fair comparison , we report the scalability as the relative ratio of a response time to the baseline response time for the respective methods . Here the baseline response time is the response time to the smallest scale subset ( ie , 50 images ) . Table 1 documents the scalability comparison . Clearly , MBRM exhibits a linear scalability wrt the database size while that of EMML is constant . This is consistent with the scalability analysis in Sec 5 .
In order to verify the fast learning advantage of EMML in comparison with the existing max margin based learning literature , we have implemented one of the most recently proposed max margin learning methods by Taskar et al . [ 19 ] . For the reference purpose , in this paper we call this method as TCKG . We have applied both EMML and TCKG to a small data set randomly selected from the whole Berkeley embryo database , consisting of 110 images along with their annotation words . The reason we use this small data set for the comparison is that we have found that in MATLAB platform TCKG immediately runs out of memory when the data set is larger , due to the large number of the constraints , which is typical for the existing max margin learning methods . Under the environment of 2.2GHz CPU and 1GB memory , TCKG takes about 14 hours to complete the learning for such a small data set while EMML only takes about 10 minutes . We have examined the number of the constraints reduced in both methods during their executions for this data set . EMML has reduced the number of the constraints in a factor of 70 times more than that reduced by TCKG . This explains why EMML is about 70 times faster than TCKG in learning for this data set .
7 . CONCLUSION
We have developed a new max margin learning framework — the enhanced max margin learning ( EMML ) , and applied it to developing an effective and efficient multimodal data mining solution . EMML attempts to find a small set of active constraints , and thus is more efficient in learning than the existing max margin learning literature . Consequently , it has a much faster convergence rate which is verified in empirical evaluations . The multimodal data mining solution based on EMML is highly scalable in the sense that the query response time is independent of the database scale . This advantage is also supported through the complexity analysis as well as empirical evaluations . While EMML is a general learning framework and can be used for general multimodal data mining , for the evaluation purpose , we have applied it to the Berkeley Drosophila embryo image database and have reported the evaluations against a state of the art multimodal data mining method .
8 . ACKNOWLEDGEMENT
This work is supported in part by NSF ( IIS 0535162 , EF0331657 ) , AFRL ( FA8750 05 2 0284 ) , AFOSR ( FA9550 061 0327 ) , and a CAREER Award to EPX by the National Science Foundation under Grant No . DBI 054659 .
9 . REFERENCES [ 1 ] http://wwwfruitflyorg/ [ 2 ] Y . Altun , I . Tsochantaridis , and T . Hofmann . Hidden markov support vector machines . In Proc . ICML , Washington DC , 2003 .
[ 3 ] K . Barnard , P . Duygulu , D . Forsyth , N . de Freitas , D . M . Blei , and M . I . Jordan . Matching words and pictures . Journal of Maching Learning Research , 3:1107–1135 , 2003 .
EMML MBRM
0.10
0.09
0.08
0.07
0.06
0.05
0.04
0.03
0.02
0.035
0.030
0.025
0.020
0.015
0.010
0.005
0.000
) n ( l l a c e R e g a r e v A y r e u Q d r o W e g n S i l i i
) n ( n o s c e r P e g a r e v A y r e u Q d r o W e g n S l i
0
10
20
30
40
50
Top(n )
Figure 5 : Precisions and Recalls of word query between EMML and MBRM
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
EMML MBRM
0.035
0.030
) n ( l l a c e R e g a r e v A l a v e i r t e R e g a m
I
0.025
0.020
0.015
0.010
0.005
0.000 i i
) n ( n o s c e r P e g a r e v A l a v e i r t e R e g a m
I
0
10
20
30
40
50
Top(n )
Figure 6 : Precisions and Recalls of image retrieval between EMML and MBRM i i
) n ( n o s c e r P e g a r e v A n o i t t a o n n A e g a m
I
EMML 2 stage inferencing MBRM 2 stage inferencing
0.32
0.28
0.24
0.20
0.16
0.12
1.0
0.8
0.6
0.4
0.2
0.0
) n ( l l a c e R e g a r e v A n o i t t a o n n A e g a m
I
0
10
20
30
40
50
Top(n )
Figure 7 : Precisions and Recalls of 2 stage image to word inferencing between EMML and MBRM i
) n ( n o s c e r P e g a r e v A y r e u Q d r o W e g n S i i l
0.18
0.16
0.14
0.12
0.10
0.08
0.06
0.04
EMML 2 stage inferencing MBRM 2 stage inferencing
0.030
0.025
) n ( l l a c e R e g a r e v A y r e u Q d r o W e g n S i l
0.020
0.015
0.010
0.005
0.000
0
10
20
30
40
50
Top(n )
Figure 8 : Precisions and Recalls of 2 stage word to image inferencing between EMML and MBRM
EMML 2 stage inferencing MBRM 2 stage inferencing
0.45
0.40
0.35
0.30
0.25
0.20
0.15
0.10
0.040
0.035
0.030
0.025
0.020
0.015
0.010
0.005
0.000
) n ( l l a c e R e g a r e v A l a v e i r t e R e g a m
I i i
) n ( n o s c e r P e g a r e v A l a v e i r t e R e g a m
I
0
10
20
30
40
50
Top(n )
Figure 9 : Precisions and Recalls of 2 stage image to image inferencing between EMML and MBRM i i
) n ( n o s c e r P e g a r e v A l a v e i r t e R e g a m
I
0.50
0.48
0.46
0.44
0.42
0.40
0.38
0.36
0.34
0.32
0.30
EMML 3 stage inferencing MBRM 3 stage inferencing
0.04
0.03
0.02
0.01
0.00
) n ( l l a c e R e g a r e v A l a v e i r t e R e g a m
I
0
10
20
30
40
50
Top(n )
Figure 10 : Precisions and Recalls of 3 stage image to image inferencing between EMML and MBRM
[ 4 ] D . Blei and M . Jordan . Modeling annotated data . In
Proceedings of the 26th annual International ACM SIGIR Conference on Research and Development in Information Retrieval , pages 127–134 , 2003 .
[ 5 ] S . Boyd and L . Vandenberghe . Convex Optimization .
Cambridge University Press , 2004 .
[ 6 ] U . Brefeld and T . Scheffer . Semi supervised learning for structured output variables . In Proc . ICML , Pittsburgh , PA , 2006 .
[ 7 ] E . Chang , K . Goh , G . Sychay , and G . Wu . Cbsa : content based soft annotation for multimodal image retrieval using bayes point machines . IEEE Trans . on Circuits and Systems for Video Technology , 13:26–38 , Jan 2003 .
[ 8 ] W . Chu , Z . Ghahramani , and D . L . Wild . A graphical model for protein secondary structure prediction . In Proc . ICML , Banff , Canada , 2004 .
[ 9 ] R . Datta , W . Ge , J . Li , and J . Z . Wang . Toward bridging the annotation retrieval gap in image search by a generative modeling approach . In Proc . ACM Multimedia , Santa Barbara , CA , 2006 .
[ 10 ] P . Duygulu , K . Barnard , N . de Freitas , and
D . Forsyth . Object recognition as machine translation : Learning a lexicon for a fixed image vocabulary . In Seventh European Conference on Computer Vision , volume IV , pages 97–112 , 2002 .
[ 11 ] S . L . Feng , R . Manmatha , and V . Lavrenko . Multiple bernoulli relevance models for image and video annotation . In International Conference on Computer Vision and Pattern Recognition , Washington DC , 2004 .
[ 12 ] Y . Freund and R . E . Schapire . Large margin classification using the perceptron algorithm . In Maching Learning , volume 37 , 1999 .
[ 13 ] H . D . III and D . Marcu . Learning as search optimization : Approximate large margin methods for structured prediction . In Proc . ICML , Bonn , Germany , 2005 .
[ 14 ] J . Lafferty , A . McCallum , and F . Pereira . Conditional random fields : Probabilistic models for segmenting and labeling sequence data . In Proc . ICML , 2001 .
[ 15 ] A . McCallum , D . Freitag , and F . Pereira . Maximum entropy markov models for information extraction and segmentation . In Proc . ICML , 2000 .
[ 16 ] E . Osuna , R . Freund , and F . Girosi . An improved training algorithm for support vector machines . In Proc . of IEEE NNSP’97 , Amelia Island , FL , Sept . 1997 .
[ 17 ] J Y Pan , H J Yang , C . Faloutsos , and P . Duygulu .
Automatic multimedia cross modal correlation discovery . In Proceedings of the 10th ACM SIGKDD Conference , Seattle , WA , 2004 .
[ 18 ] A . W . M . Smeulders , M . Worring , S . Santini ,
A . Gupta , and R . Jain . Content based image retrieval at the end of the early years . IEEE Trans . on Pattern Analysis and Machine Intelligence , 22:1349–1380 , 2000 .
[ 19 ] B . Taskar , V . Chatalbashev , D . Koller , and
C . Guestrin . Learning structured prediction models : A large margin approach . In Proc . ICML , Bonn , Germany , 2005 .
[ 20 ] B . Taskar , C . Guestrin , and D . Koller . Max margin markov networks . In Neural Information Processing Systems Conference , Vancouver , Canada , 2003 .
[ 21 ] I . Tsochantaridis , T . Hofmann , T . Joachims , and
Y . Altun . Support vector machine learning for interdependent and structured output spaces . In Proc . ICML , Banff , Canada , 2004 .
[ 22 ] V . N . Vapnik . The nature of statistical learning theory .
Springer , 1995 .
[ 23 ] Y . Wu , E . Y . Chang , and B . L . Tseng . Multimodal metadata fusion using causal strength . In Proc . ACM Multimedia , pages 872–881 , Hilton , Singapore , 2005 .
